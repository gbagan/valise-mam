var PS={};!function(e){"use strict";e["Control.Alt"]=e["Control.Alt"]||{};e["Control.Alt"].Alt=function(e,t){this.Functor0=e,this.alt=t}}(PS),(e=>{"use strict";(PS["Control.Apply"]=PS["Control.Apply"]||{}).arrayApply=e=>t=>{for(var n=e.length,a=t.length,o=new Array(n*a),r=0,i=0;i<n;i++)for(var l=e[i],s=0;s<a;s++)o[r++]=l(t[s]);return o}})(),function(e){"use strict";e["Control.Semigroupoid"]=e["Control.Semigroupoid"]||{};var t=e["Control.Semigroupoid"],n=new function(e){this.compose=e}(e=>t=>n=>e(t(n)));t.compose=e=>e.compose,t.semigroupoidFn=n}(PS),function(e){"use strict";e["Control.Category"]=e["Control.Category"]||{};var t=e["Control.Category"],n=e["Control.Semigroupoid"],a=new function(e,t){this.Semigroupoid0=e,this.identity=t}(()=>n.semigroupoidFn,e=>e);t.identity=e=>e.identity,t.categoryFn=a}(PS),(e=>{"use strict";e["Data.Function"]=e["Data.Function"]||{};var t=e["Data.Function"];t.flip=e=>t=>n=>e(n)(t),t.const=e=>t=>e,t.apply=e=>t=>e(t)})(PS),(e=>{"use strict";(PS["Data.Functor"]=PS["Data.Functor"]||{}).arrayMap=e=>t=>{for(var n=t.length,a=new Array(n),o=0;o<n;o++)a[o]=e(t[o]);return a}})(),(e=>{"use strict";(PS["Data.Unit"]=PS["Data.Unit"]||{}).unit={}})(),(e=>{"use strict";e["Data.Unit"]=e["Data.Unit"]||{};var t=e["Data.Unit"],n=e["Data.Unit"];t.unit=n.unit})(PS),function(e){"use strict";e["Data.Functor"]=e["Data.Functor"]||{};var t=e["Data.Functor"],n=e["Data.Functor"],a=e["Control.Semigroupoid"],o=e["Data.Function"],r=e["Data.Unit"],i=function(e){this.map=e},l=e=>e.map,s=new i(a.compose(a.semigroupoidFn)),u=new i(n.arrayMap);t.Functor=i,t.map=l,t.mapFlipped=e=>t=>n=>l(e)(n)(t),t.void=e=>l(e)(o.const(r.unit)),t.functorFn=s,t.functorArray=u}(PS),function(e){"use strict";e["Control.Apply"]=e["Control.Apply"]||{};var t=e["Control.Apply"],n=e["Control.Apply"],a=e["Control.Category"],o=e["Data.Function"],r=e["Data.Functor"],i=function(e,t){this.Functor0=e,this.apply=t},l=new i(()=>r.functorArray,n.arrayApply),s=e=>e.apply;t.Apply=i,t.apply=s,t.applySecond=e=>t=>n=>s(e)(r.map(e.Functor0())(o.const(a.identity(a.categoryFn)))(t))(n),t.applyArray=l}(PS),function(e){"use strict";e["Control.Applicative"]=e["Control.Applicative"]||{};var t=e["Control.Applicative"],n=e["Control.Apply"],a=e["Data.Unit"],o=e=>e.pure;t.Applicative=function(e,t){this.Apply0=e,this.pure=t},t.pure=o,t.liftA1=e=>t=>a=>n.apply(e.Apply0())(o(e)(t))(a),t.unless=e=>t=>n=>{if(!t)return n;if(t)return o(e)(a.unit);throw new Error("Failed pattern match at Control.Applicative (line 62, column 1 - line 62, column 65): "+[t.constructor.name,n.constructor.name])},t.when=e=>t=>n=>{if(t)return n;if(!t)return o(e)(a.unit);throw new Error("Failed pattern match at Control.Applicative (line 57, column 1 - line 57, column 63): "+[t.constructor.name,n.constructor.name])}}(PS),(e=>{"use strict";(PS["Control.Bind"]=PS["Control.Bind"]||{}).arrayBind=e=>t=>{for(var n=[],a=0,o=e.length;a<o;a++)Array.prototype.push.apply(n,t(e[a]));return n}})(),function(e){"use strict";e["Control.Bind"]=e["Control.Bind"]||{};var t=e["Control.Bind"],n=e["Control.Bind"],a=e["Control.Apply"],o=e["Control.Category"],r=e["Data.Function"],i=function(e,t){this.Apply0=e,this.bind=t},l=new i(()=>a.applyArray,n.arrayBind),s=e=>e.bind,u=new function(e){this.discard=e}(e=>s(e));t.Bind=i,t.bind=s,t.bindFlipped=e=>r.flip(s(e)),t.discard=e=>e.discard,t.join=e=>t=>s(e)(t)(o.identity(o.categoryFn)),t.composeKleisli=e=>t=>n=>a=>s(e)(t(a))(n),t.bindArray=l,t.discardUnit=u}(PS),function(e){"use strict";e["Control.Monad"]=e["Control.Monad"]||{};var t=e["Control.Monad"],n=e["Control.Applicative"],a=e["Control.Bind"];t.Monad=function(e,t){this.Applicative0=e,this.Bind1=t},t.ap=e=>t=>o=>a.bind(e.Bind1())(t)(t=>a.bind(e.Bind1())(o)(a=>n.pure(e.Applicative0())(t(a)))),t.unlessM=e=>t=>o=>a.bind(e.Bind1())(t)(t=>n.unless(e.Applicative0())(t)(o))}(PS),function(e){"use strict";e["Control.Monad.Error.Class"]=e["Control.Monad.Error.Class"]||{};var t=e["Control.Monad.Error.Class"];t.throwError=e=>e.throwError,t.MonadThrow=function(e,t){this.Monad0=e,this.throwError=t}}(PS),function(e){"use strict";e["Data.Either"]=e["Data.Either"]||{};var t=e["Data.Either"],n=e["Data.Functor"],a=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),o=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),r=new n.Functor(e=>t=>{if(t instanceof a)return new a(t.value0);if(t instanceof o)return new o(e(t.value0));throw new Error("Failed pattern match at Data.Either (line 38, column 1 - line 38, column 52): "+[t.constructor.name])});t.Left=a,t.Right=o,t.either=e=>t=>n=>{if(n instanceof a)return e(n.value0);if(n instanceof o)return t(n.value0);throw new Error("Failed pattern match at Data.Either (line 238, column 1 - line 238, column 64): "+[e.constructor.name,t.constructor.name,n.constructor.name])},t.functorEither=r}(PS),(e=>{"use strict";e["Control.Monad.Except.Trans"]=e["Control.Monad.Except.Trans"]||{};var t=e["Control.Monad.Except.Trans"],n=e["Control.Applicative"],a=e["Control.Apply"],o=e["Control.Bind"],r=e["Control.Monad"],i=e["Control.Monad.Error.Class"],l=e["Data.Either"],s=e["Data.Functor"],u=e=>e,c=e=>new s.Functor(t=>(e=>t=>e(t))(s.map(e)(s.map(l.functorEither)(t)))),d=e=>new r.Monad(()=>m(e),()=>v(e)),v=e=>new o.Bind(()=>p(e),t=>a=>{return o.bind(e.Bind1())(t)(l.either((r=n.pure(e.Applicative0()),e=>r(l.Left.create(e))))(e=>{return a(e)}));var r}),p=e=>new a.Apply(()=>c(e.Bind1().Apply0().Functor0()),r.ap(d(e))),m=e=>{return new n.Applicative(()=>p(e),(t=n.pure(e.Applicative0()),e=>u(t(l.Right.create(e)))));var t};t.runExceptT=e=>e,t.functorExceptT=c,t.applicativeExceptT=m,t.bindExceptT=v,t.monadThrowExceptT=e=>{return new i.MonadThrow(()=>d(e),(t=n.pure(e.Applicative0()),e=>u(t(l.Left.create(e)))));var t}})(PS),(e=>{"use strict";e.boolConj=e=>t=>e&&t,e.boolDisj=e=>t=>e||t,e.boolNot=e=>!e})(PS["Data.HeytingAlgebra"]=PS["Data.HeytingAlgebra"]||{}),function(e){"use strict";e["Data.HeytingAlgebra"]=e["Data.HeytingAlgebra"]||{};var t=e["Data.HeytingAlgebra"],n=e["Data.HeytingAlgebra"],a=function(e,t,n,a,o,r){this.conj=e,this.disj=t,this.ff=n,this.implies=a,this.not=o,this.tt=r},o=e=>e.tt,r=e=>e.not,i=e=>e.ff,l=e=>e.disj,s=new a(n.boolConj,n.boolDisj,!1,e=>t=>l(s)(r(s)(e))(t),n.boolNot,!0),u=e=>e.conj;t.tt=o,t.ff=i,t.conj=u,t.disj=l,t.not=r,t.heytingAlgebraBoolean=s,t.heytingAlgebraFunction=e=>new a(t=>n=>a=>u(e)(t(a))(n(a)),t=>n=>a=>l(e)(t(a))(n(a)),t=>i(e),t=>n=>a=>(e=>e.implies)(e)(t(a))(n(a)),t=>n=>r(e)(t(n)),t=>o(e))}(PS),(e=>{"use strict";(PS["Data.Semigroup"]=PS["Data.Semigroup"]||{}).concatArray=e=>t=>0===e.length?t:0===t.length?e:e.concat(t)})(),function(e){"use strict";e["Data.Semigroup"]=e["Data.Semigroup"]||{};var t=e["Data.Semigroup"],n=e["Data.Semigroup"],a=function(e){this.append=e},o=new a(n.concatArray),r=e=>e.append;t.Semigroup=a,t.append=r,t.semigroupFn=e=>new a(t=>n=>a=>r(e)(t(a))(n(a))),t.semigroupArray=o}(PS),function(e){"use strict";e["Data.Monoid"]=e["Data.Monoid"]||{};var t=e["Data.Monoid"],n=e["Data.Semigroup"],a=function(e,t){this.Semigroup0=e,this.mempty=t},o=new a(()=>n.semigroupArray,[]),r=e=>e.mempty;t.Monoid=a,t.mempty=r,t.monoidFn=e=>new a(()=>n.semigroupFn(e.Semigroup0()),t=>r(e)),t.monoidArray=o}(PS),(e=>{"use strict";e["Data.Monoid.Conj"]=e["Data.Monoid.Conj"]||{};var t=e["Data.Monoid.Conj"],n=e["Data.HeytingAlgebra"],a=e["Data.Monoid"],o=e["Data.Semigroup"];t.Conj=e=>e,t.monoidConj=e=>new a.Monoid(()=>(e=>new o.Semigroup(t=>a=>n.conj(e)(t)(a)))(e),n.tt(e))})(PS),(e=>{"use strict";e["Data.Monoid.Disj"]=e["Data.Monoid.Disj"]||{};var t=e["Data.Monoid.Disj"],n=e["Data.HeytingAlgebra"],a=e["Data.Monoid"],o=e["Data.Semigroup"];t.Disj=e=>e,t.monoidDisj=e=>new a.Monoid(()=>(e=>new o.Semigroup(t=>a=>n.disj(e)(t)(a)))(e),n.ff(e))})(PS),function(e){"use strict";e["Data.Newtype"]=e["Data.Newtype"]||{};var t=e["Data.Newtype"],n=e["Data.Functor"],a=e["Data.Monoid.Conj"],o=e["Data.Monoid.Disj"],r=function(e,t){this.unwrap=e,this.wrap=t},i=e=>e.unwrap,l=new r(e=>e,o.Disj),s=new r(e=>e,a.Conj);t.unwrap=i,t.Newtype=r,t.alaF=e=>t=>a=>o=>r=>r=>{var l=n.map(t)(i(o)),s=n.map(e)((e=>e.wrap)(a));return e=>l(r(s(e)))},t.newtypeConj=s,t.newtypeDisj=l}(PS),(e=>{"use strict";e["Data.Identity"]=e["Data.Identity"]||{};var t=e["Data.Identity"],n=e["Control.Applicative"],a=e["Control.Apply"],o=e["Control.Bind"],r=e["Control.Monad"],i=e["Data.Functor"],l=e=>e,s=new e["Data.Newtype"].Newtype(e=>e,l),u=new i.Functor(e=>t=>e(t)),c=new a.Apply(()=>u,e=>t=>e(t)),d=new o.Bind(()=>c,e=>t=>t(e)),v=new n.Applicative(()=>c,l),p=new r.Monad(()=>v,()=>d);t.Identity=l,t.newtypeIdentity=s,t.functorIdentity=u,t.applicativeIdentity=v,t.monadIdentity=p})(PS),(e=>{"use strict";e["Control.Monad.Except"]=e["Control.Monad.Except"]||{};var t,n=e["Control.Monad.Except"],a=e["Control.Monad.Except.Trans"],o=e["Data.Identity"],r=e["Data.Newtype"],i=(t=r.unwrap(o.newtypeIdentity),e=>t(a.runExceptT(e)));n.runExcept=i})(PS),function(e){"use strict";e["Control.Plus"]=e["Control.Plus"]||{};var t=e["Control.Plus"];t.Plus=function(e,t){this.Alt0=e,this.empty=t},t.empty=e=>e.empty}(PS),(e=>{"use strict";e.foldrArray=e=>t=>n=>{for(var a=t,o=n.length-1;o>=0;o--)a=e(n[o])(a);return a},e.foldlArray=e=>t=>n=>{for(var a=t,o=n.length,r=0;r<o;r++)a=e(a)(n[r]);return a}})(PS["Data.Foldable"]=PS["Data.Foldable"]||{}),(e=>{"use strict";var t=e=>t=>e===t;e.eqBooleanImpl=t,e.eqIntImpl=t,e.eqNumberImpl=t,e.eqCharImpl=t,e.eqStringImpl=t})(PS["Data.Eq"]=PS["Data.Eq"]||{}),function(e){"use strict";e["Data.Eq"]=e["Data.Eq"]||{};var t=e["Data.Eq"],n=e["Data.Eq"],a=function(e){this.eq=e},o=new a(n.eqStringImpl),r=new a(n.eqNumberImpl),i=new a(n.eqIntImpl),l=new a(n.eqCharImpl),s=new a(n.eqBooleanImpl),u=e=>e.eq;t.Eq=a,t.eq=u,t.notEq=e=>t=>n=>u(s)(u(e)(t)(n))(!1),t.eqBoolean=s,t.eqInt=i,t.eqNumber=r,t.eqChar=l,t.eqString=o}(PS),(e=>{"use strict";var t=e=>t=>n=>a=>o=>a<o?e:a===o?t:n;e.ordIntImpl=t,e.ordNumberImpl=t,e.ordStringImpl=t,e.ordCharImpl=t})(PS["Data.Ord"]=PS["Data.Ord"]||{}),(e=>{"use strict";e["Data.Ordering"]=e["Data.Ordering"]||{};var t=e["Data.Ordering"],n=e["Data.Eq"],a=(()=>{function e(){}return e.value=new e,e})(),o=(()=>{function e(){}return e.value=new e,e})(),r=(()=>{function e(){}return e.value=new e,e})(),i=new n.Eq(e=>t=>e instanceof a&&t instanceof a||(e instanceof o&&t instanceof o||e instanceof r&&t instanceof r));t.LT=a,t.GT=o,t.EQ=r,t.eqOrdering=i})(PS),function(e){"use strict";e["Data.Ord"]=e["Data.Ord"]||{};var t=e["Data.Ord"],n=e["Data.Ord"],a=e["Data.Eq"],o=e["Data.Ordering"],r=function(e,t){this.Eq0=e,this.compare=t},i=new r(()=>a.eqString,n.ordStringImpl(o.LT.value)(o.EQ.value)(o.GT.value)),l=new r(()=>a.eqNumber,n.ordNumberImpl(o.LT.value)(o.EQ.value)(o.GT.value)),s=new r(()=>a.eqInt,n.ordIntImpl(o.LT.value)(o.EQ.value)(o.GT.value)),u=new r(()=>a.eqChar,n.ordCharImpl(o.LT.value)(o.EQ.value)(o.GT.value)),c=e=>e.compare;t.Ord=r,t.compare=c,t.lessThan=e=>t=>n=>{return c(e)(t)(n)instanceof o.LT},t.greaterThan=e=>t=>n=>{return c(e)(t)(n)instanceof o.GT},t.comparing=e=>t=>n=>a=>c(e)(t(n))(t(a)),t.min=e=>t=>n=>{var a=c(e)(t)(n);if(a instanceof o.LT)return t;if(a instanceof o.EQ)return t;if(a instanceof o.GT)return n;throw new Error("Failed pattern match at Data.Ord (line 158, column 3 - line 161, column 12): "+[a.constructor.name])},t.max=e=>t=>n=>{var a=c(e)(t)(n);if(a instanceof o.LT)return n;if(a instanceof o.EQ)return t;if(a instanceof o.GT)return t;throw new Error("Failed pattern match at Data.Ord (line 167, column 3 - line 170, column 12): "+[a.constructor.name])},t.ordInt=s,t.ordNumber=l,t.ordString=i,t.ordChar=u}(PS),function(e){"use strict";e["Data.Maybe"]=e["Data.Maybe"]||{};var t=e["Data.Maybe"],n=e["Control.Applicative"],a=e["Control.Apply"],o=e["Control.Bind"],r=e["Control.Category"],i=e["Data.Eq"],l=e["Data.Function"],s=e["Data.Functor"],u=e["Data.Ord"],c=e["Data.Ordering"],d=(()=>{function e(){}return e.value=new e,e})(),v=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),p=e=>t=>n=>{if(n instanceof d)return e;if(n instanceof v)return t(n.value0);throw new Error("Failed pattern match at Data.Maybe (line 217, column 1 - line 217, column 51): "+[e.constructor.name,t.constructor.name,n.constructor.name])},m=p(!0)(l.const(!1)),h=p(!1)(l.const(!0)),w=new s.Functor(e=>t=>t instanceof v?new v(e(t.value0)):d.value),g=e=>new i.Eq(t=>n=>t instanceof d&&n instanceof d||t instanceof v&&n instanceof v&&i.eq(e)(t.value0)(n.value0)),f=new a.Apply(()=>w,e=>t=>{if(e instanceof v)return s.map(w)(e.value0)(t);if(e instanceof d)return d.value;throw new Error("Failed pattern match at Data.Maybe (line 67, column 1 - line 69, column 30): "+[e.constructor.name,t.constructor.name])}),b=new o.Bind(()=>f,e=>t=>{if(e instanceof v)return t(e.value0);if(e instanceof d)return d.value;throw new Error("Failed pattern match at Data.Maybe (line 125, column 1 - line 127, column 28): "+[e.constructor.name,t.constructor.name])}),y=new n.Applicative(()=>f,v.create);t.Nothing=d,t.Just=v,t.maybe=p,t.fromMaybe=e=>p(e)(r.identity(r.categoryFn)),t.isJust=h,t.isNothing=m,t.fromJust=e=>e=>{if(e instanceof v)return e.value0;throw new Error("Failed pattern match at Data.Maybe (line 268, column 1 - line 268, column 46): "+[e.constructor.name])},t.functorMaybe=w,t.applyMaybe=f,t.applicativeMaybe=y,t.bindMaybe=b,t.eqMaybe=g,t.ordMaybe=e=>new u.Ord(()=>g(e.Eq0()),t=>n=>{if(t instanceof d&&n instanceof d)return c.EQ.value;if(t instanceof d)return c.LT.value;if(n instanceof d)return c.GT.value;if(t instanceof v&&n instanceof v)return u.compare(e)(t.value0)(n.value0);throw new Error("Failed pattern match at Data.Maybe (line 194, column 1 - line 194, column 51): "+[t.constructor.name,n.constructor.name])})}(PS),function(e){"use strict";e["Data.Foldable"]=e["Data.Foldable"]||{};var t=e["Data.Foldable"],n=e["Data.Foldable"],a=e["Control.Applicative"],o=e["Control.Apply"],r=e["Control.Category"],i=e["Data.Eq"],l=e["Data.Function"],s=e["Data.Functor"],u=e["Data.HeytingAlgebra"],c=e["Data.Maybe"],d=e["Data.Monoid"],v=e["Data.Monoid.Conj"],p=e["Data.Monoid.Disj"],m=e["Data.Newtype"],h=e["Data.Semigroup"],w=e["Data.Unit"],g=function(e,t,n){this.foldMap=e,this.foldl=t,this.foldr=n},f=e=>e.foldr,b=e=>t=>n=>{return f(t)((r=o.applySecond(e.Apply0()),e=>r(n(e))))(a.pure(e)(w.unit));var r},y=e=>e.foldl,D=new g(e=>(e=>t=>n=>f(e)(e=>a=>h.append(t.Semigroup0())(n(e))(a))(d.mempty(t)))(D)(e),n.foldlArray,n.foldrArray),S=e=>e.foldMap,F=e=>t=>m.alaF(s.functorFn)(s.functorFn)(m.newtypeConj)(m.newtypeConj)(v.Conj)(S(e)(v.monoidConj(t)));t.Foldable=g,t.foldr=f,t.foldl=y,t.traverse_=b,t.for_=e=>t=>l.flip(b(e)(t)),t.and=e=>t=>F(e)(t)(r.identity(r.categoryFn)),t.all=F,t.elem=e=>t=>{var n=(e=>t=>m.alaF(s.functorFn)(s.functorFn)(m.newtypeDisj)(m.newtypeDisj)(p.Disj)(S(e)(p.monoidDisj(t))))(e)(u.heytingAlgebraBoolean),a=i.eq(t);return e=>n(a(e))},t.find=e=>t=>{return y(e)(e=>n=>e instanceof c.Nothing&&t(n)?new c.Just(n):e)(c.Nothing.value)},t.foldableArray=D}(PS),function(e){"use strict";e["Data.List.Types"]=e["Data.List.Types"]||{};var t=e["Data.List.Types"],n=e["Control.Alt"],a=e["Control.Applicative"],o=e["Control.Apply"],r=e["Control.Plus"],i=e["Data.Foldable"],l=e["Data.Function"],s=e["Data.Functor"],u=e["Data.Monoid"],c=e["Data.Semigroup"],d=(()=>{function e(){}return e.value=new e,e})(),v=function(){function e(e,t){this.value0=e,this.value1=t}return e.create=t=>n=>new e(t,n),e}(),p=new s.Functor(e=>{return(t=>n=>{var a,o=t,r=!1;function i(t,a){if(a instanceof v&&a.value1 instanceof v&&a.value1.value1 instanceof v)return o=new v(a,t),void(n=a.value1.value1.value1);return r=!0,(t=>n=>{var a,o,r,i=t,l=!1;for(;!l;)r=n,a=(o=i)instanceof v&&o.value0 instanceof v&&o.value0.value1 instanceof v&&o.value0.value1.value1 instanceof v?(i=o.value1,void(n=new v(e(o.value0.value0),new v(e(o.value0.value1.value0),new v(e(o.value0.value1.value1.value0),r))))):(l=!0,r);return a})(t)((t=>t instanceof v&&t.value1 instanceof v&&t.value1.value1 instanceof d?new v(e(t.value0),new v(e(t.value1.value0),d.value)):t instanceof v&&t.value1 instanceof d?new v(e(t.value0),d.value):d.value)(a))}for(;!r;)a=i(o,n);return a})(d.value)}),m=new i.Foldable(e=>t=>i.foldl(m)(n=>{var a=c.append(e.Semigroup0())(n);return e=>a(t(e))})(u.mempty(e)),e=>{return t=>n=>{var a,o=t,r=!1;function i(t,a){if(a instanceof d)return r=!0,t;if(a instanceof v)return o=e(t)(a.value0),void(n=a.value1);throw new Error("Failed pattern match at Data.List.Types (line 109, column 12 - line 111, column 30): "+[a.constructor.name])}for(;!r;)a=i(o,n);return a}},e=>t=>{var n=i.foldl(m)(l.flip(v.create))(d.value),a=i.foldl(m)(l.flip(e))(t);return e=>a(n(e))}),h=new c.Semigroup(e=>t=>i.foldr(m)(v.create)(t)(e)),w=new o.Apply(()=>p,e=>t=>{if(e instanceof d)return d.value;if(e instanceof v)return c.append(h)(s.map(p)(e.value0)(t))(o.apply(w)(e.value1)(t));throw new Error("Failed pattern match at Data.List.Types (line 155, column 1 - line 157, column 48): "+[e.constructor.name,t.constructor.name])}),g=new a.Applicative(()=>w,e=>new v(e,d.value)),f=new n.Alt(()=>p,c.append(h)),b=new r.Plus(()=>f,d.value);t.Nil=d,t.Cons=v,t.NonEmptyList=e=>e,t.semigroupList=h,t.foldableList=m,t.applicativeList=g,t.plusList=b}(PS),(e=>{"use strict";e["Data.List"]=e["Data.List"]||{};var t=e["Data.List"],n=e["Data.List.Types"],a=e["Data.Maybe"],o=(e=>t=>{var a,o=e,r=!1;function i(e,a){if(a instanceof n.Nil)return r=!0,e;if(a instanceof n.Cons)return o=new n.Cons(a.value0,e),void(t=a.value1);throw new Error("Failed pattern match at Data.List (line 368, column 3 - line 368, column 19): "+[e.constructor.name,a.constructor.name])}for(;!r;)a=i(o,t);return a})(n.Nil.value);t.null=e=>e instanceof n.Nil,t.last=e=>{var t,o,r=!1;for(;!r;)t=(o=e)instanceof n.Cons&&o.value1 instanceof n.Nil?(r=!0,new a.Just(o.value0)):o instanceof n.Cons?void(e=o.value1):(r=!0,a.Nothing.value);return t},t.reverse=o})(PS),function(e){"use strict";e["Data.Tuple"]=e["Data.Tuple"]||{};var t=e["Data.Tuple"],n=e["Data.Functor"],a=function(){function e(e,t){this.value0=e,this.value1=t}return e.create=t=>n=>new e(t,n),e}(),o=new n.Functor(e=>t=>new a(t.value0,e(t.value1)));t.Tuple=a,t.fst=e=>e.value0,t.snd=e=>e.value1,t.uncurry=e=>t=>e(t.value0)(t.value1),t.functorTuple=o}(PS),function(e){"use strict";e["Data.CatQueue"]=e["Data.CatQueue"]||{};var t=e["Data.CatQueue"],n=e["Data.List"],a=e["Data.List.Types"],o=e["Data.Maybe"],r=e["Data.Tuple"],i=function(){function e(e,t){this.value0=e,this.value1=t}return e.create=t=>n=>new e(t,n),e}(),l=new i(a.Nil.value,a.Nil.value);t.empty=l,t.null=e=>e.value0 instanceof a.Nil&&e.value1 instanceof a.Nil,t.snoc=e=>t=>new i(e.value0,new a.Cons(t,e.value1)),t.uncons=e=>{var t,l=!1;function s(t){if(t.value0 instanceof a.Nil&&t.value1 instanceof a.Nil)return l=!0,o.Nothing.value;if(!(t.value0 instanceof a.Nil)){if(t.value0 instanceof a.Cons)return l=!0,new o.Just(new r.Tuple(t.value0.value0,new i(t.value0.value1,t.value1)));throw new Error("Failed pattern match at Data.CatQueue (line 83, column 1 - line 83, column 63): "+[t.constructor.name])}e=new i(n.reverse(t.value1),a.Nil.value)}for(;!l;)t=s(e);return t}}(PS),function(e){"use strict";e["Data.CatList"]=e["Data.CatList"]||{};var t=e["Data.CatList"],n=e["Data.CatQueue"],a=e["Data.List.Types"],o=e["Data.Maybe"],r=e["Data.Semigroup"],i=e["Data.Tuple"],l=(()=>{function e(){}return e.value=new e,e})(),s=function(){function e(e,t){this.value0=e,this.value1=t}return e.create=t=>n=>new e(t,n),e}(),u=e=>t=>{if(e instanceof l)return t;if(t instanceof l)return e;if(e instanceof s)return new s(e.value0,n.snoc(e.value1)(t));throw new Error("Failed pattern match at Data.CatList (line 109, column 1 - line 109, column 54): "+[e.constructor.name,t.constructor.name])},c=l.value,d=u,v=new r.Semigroup(d);t.empty=c,t.snoc=e=>t=>d(e)(new s(t,n.empty)),t.uncons=e=>{if(e instanceof l)return o.Nothing.value;if(e instanceof s)return new o.Just(new i.Tuple(e.value0,n.null(e.value1)?l.value:(e=>t=>r=>{var i=e=>t=>n=>{var o,r=e,i=t,l=!1;function s(e,t,o){if(o instanceof a.Nil)return l=!0,t;if(o instanceof a.Cons)return r=e,i=e(t)(o.value0),void(n=o.value1);throw new Error("Failed pattern match at Data.CatList (line 125, column 3 - line 125, column 59): "+[e.constructor.name,t.constructor.name,o.constructor.name])}for(;!l;)o=s(r,i,n);return o};return(r=>l=>{var s,u=r,c=!1;function d(r,s){var d=n.uncons(r);if(d instanceof o.Nothing)return c=!0,i(e=>t=>t(e))(t)(s);if(d instanceof o.Just)return u=d.value0.value1,void(l=new a.Cons(e(d.value0.value0),s));throw new Error("Failed pattern match at Data.CatList (line 121, column 14 - line 123, column 67): "+[d.constructor.name])}for(;!c;)s=d(u,l);return s})(r)(a.Nil.value)})(u)(l.value)(e.value1)));throw new Error("Failed pattern match at Data.CatList (line 100, column 1 - line 100, column 61): "+[e.constructor.name])},t.semigroupCatList=v}(PS),function(e){"use strict";e["Control.Monad.Free"]=e["Control.Monad.Free"]||{};var t=e["Control.Monad.Free"],n=e["Control.Applicative"],a=e["Control.Apply"],o=e["Control.Bind"],r=e["Control.Monad"],i=e["Data.CatList"],l=e["Data.Functor"],s=e["Data.Maybe"],u=e["Data.Semigroup"],c=function(){function e(e,t){this.value0=e,this.value1=t}return e.create=t=>n=>new e(t,n),e}(),d=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),v=function(){function e(e,t){this.value0=e,this.value1=t}return e.create=t=>n=>new e(t,n),e}(),p=e=>{var t,n=!1;function a(t){var a=e=>t=>new c(e.value0,u.append(i.semigroupCatList)(e.value1)(t));if(t.value0 instanceof d){var o=i.uncons(t.value1);if(o instanceof s.Nothing)return n=!0,new d(t.value0.value0);if(o instanceof s.Just)return void(e=a((e=>e)(o.value0.value0)(t.value0.value0))(o.value0.value1));throw new Error("Failed pattern match at Control.Monad.Free (line 227, column 7 - line 231, column 64): "+[o.constructor.name])}if(t.value0 instanceof v)return n=!0,new v(t.value0.value0,e=>a(t.value0.value1(e))(t.value1));throw new Error("Failed pattern match at Control.Monad.Free (line 225, column 3 - line 233, column 56): "+[t.value0.constructor.name])}for(;!n;)t=a(e);return t},m=e=>new c(e,i.empty),h=new r.Monad(()=>b,()=>g),w=new l.Functor(e=>t=>{return o.bindFlipped(g)((a=n.pure(b),t=>a(e(t))))(t);var a}),g=new o.Bind(()=>f,e=>t=>new c(e.value0,i.snoc(e.value1)(t))),f=new a.Apply(()=>w,r.ap(h)),b=new n.Applicative(()=>f,e=>m(d.create(e))),y=e=>{return m(new v(e,(t=n.pure(b),e=>t(e))));var t};t.liftF=y,t.hoistFree=e=>(e=>{var t=a=>{var r=p(a);if(r instanceof d)return n.pure(b)(r.value0);if(r instanceof v)return o.bind(g)(e(r.value0))(l.map(l.functorFn)(t)(r.value1));throw new Error("Failed pattern match at Control.Monad.Free (line 168, column 10 - line 170, column 33): "+[r.constructor.name])};return t})(t=>y(e(t))),t["resume'"]=e=>t=>n=>{var a=p(n);if(a instanceof d)return t(a.value0);if(a instanceof v)return e(a.value0)(a.value1);throw new Error("Failed pattern match at Control.Monad.Free (line 213, column 17 - line 215, column 20): "+[a.constructor.name])},t.freeFunctor=w,t.freeBind=g,t.freeApplicative=b,t.freeApply=f,t.freeMonad=h}(PS),function(e){"use strict";e["Control.Monad.Rec.Class"]=e["Control.Monad.Rec.Class"]||{};var t=e["Control.Monad.Rec.Class"],n=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),a=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}();t.Loop=n,t.Done=a,t.MonadRec=function(e,t){this.Monad0=e,this.tailRecM=t},t.tailRecM=e=>e.tailRecM}(PS),(e=>{"use strict";e.map_=e=>t=>()=>e(t()),e.pure_=e=>()=>e,e.bind_=e=>t=>()=>t(e())(),e.foreach=e=>t=>()=>{for(var n=0,a=e.length;n<a;n++)t(e[n])()}})(PS["Control.Monad.ST.Internal"]=PS["Control.Monad.ST.Internal"]||{}),(e=>{"use strict";e["Control.Monad.ST.Internal"]=e["Control.Monad.ST.Internal"]||{};var t=e["Control.Monad.ST.Internal"],n=e["Control.Monad.ST.Internal"],a=e["Control.Applicative"],o=e["Control.Apply"],r=e["Control.Bind"],i=e["Control.Monad"],l=new e["Data.Functor"].Functor(n.map_),s=new i.Monad(()=>d,()=>u),u=new r.Bind(()=>c,n.bind_),c=new o.Apply(()=>l,i.ap(s)),d=new a.Applicative(()=>c,n.pure_);t.functorST=l,t.applicativeST=d,t.foreach=n.foreach})(PS),(e=>{"use strict";e.range=e=>t=>{for(var n=e>t?-1:1,a=new Array(n*(t-e)+1),o=e,r=0;o!==t;)a[r++]=o,o+=n;return a[r]=o,a};e.replicate="function"==typeof Array.prototype.fill?e=>t=>{return e<1?[]:new Array(e).fill(t)}:e=>t=>{for(var n=[],a=0,o=0;o<e;o++)n[a++]=t;return n},e.length=e=>e.length,e.cons=e=>t=>[e].concat(t),e.snoc=e=>t=>{var n=e.slice();return n.push(t),n},e["uncons'"]=e=>t=>n=>0===n.length?e({}):t(n[0])(n.slice(1)),e.indexImpl=e=>t=>n=>a=>a<0||a>=n.length?t:e(n[a]),e._insertAt=e=>t=>n=>a=>o=>{if(n<0||n>o.length)return t;var r=o.slice();return r.splice(n,0,a),e(r)},e._updateAt=e=>t=>n=>a=>o=>{if(n<0||n>=o.length)return t;var r=o.slice();return r[n]=a,e(r)},e.reverse=e=>e.slice().reverse(),e.concat=e=>{if(e.length<=1e4)return Array.prototype.concat.apply([],e);for(var t=[],n=0,a=e.length;n<a;n++)for(var o=e[n],r=0,i=o.length;r<i;r++)t.push(o[r]);return t},e.filter=e=>t=>t.filter(e),e.sortImpl=e=>t=>t.slice().sort((t,n)=>e(t)(n)),e.slice=e=>t=>n=>n.slice(e,t),e.take=e=>t=>e<1?[]:t.slice(0,e),e.drop=e=>t=>e<1?t:t.slice(e),e.zipWith=e=>t=>n=>{for(var a=t.length<n.length?t.length:n.length,o=new Array(a),r=0;r<a;r++)o[r]=e(t[r])(n[r]);return o}})(PS["Data.Array"]=PS["Data.Array"]||{}),(e=>{"use strict";e.poke=e=>t=>n=>()=>{var a=e>=0&&e<n.length;return a&&(n[e]=t),a},e.pushAll=e=>t=>()=>t.push.apply(t,e),e.unsafeFreeze=e=>()=>e,e.unsafeThaw=e=>()=>e,e.thaw=function(e){return()=>e.slice()}})(PS["Data.Array.ST"]=PS["Data.Array.ST"]||{}),(e=>{"use strict";e["Data.Array.ST"]=e["Data.Array.ST"]||{};var t=e["Data.Array.ST"],n=e["Data.Array.ST"];t.withArray=e=>t=>(function(){var a=n.thaw(t)();e(a)();return n.unsafeFreeze(a)()}),t.push=e=>n.pushAll([e]),t.poke=n.poke,t.unsafeFreeze=n.unsafeFreeze,t.unsafeThaw=n.unsafeThaw})(PS),(e=>{"use strict";e["Data.Boolean"]=e["Data.Boolean"]||{};e["Data.Boolean"].otherwise=!0})(PS),(e=>{"use strict";e["Data.Array"]=e["Data.Array"]||{};var t=e["Data.Array"],n=e["Data.Array"],a=e["Control.Applicative"],o=e["Control.Bind"],r=e["Control.Category"],i=e["Control.Monad.ST.Internal"],l=e["Data.Array.ST"],s=e["Data.Boolean"],u=e["Data.Eq"],c=e["Data.Foldable"],d=e["Data.Function"],v=e["Data.Functor"],p=e["Data.Maybe"],m=e["Data.Ord"],h=e["Data.Ordering"],w=e["Data.Tuple"],g=n.zipWith(w.Tuple.create),f=n._updateAt(p.Just.create)(p.Nothing.value),b=n["uncons'"](d.const(p.Nothing.value))(e=>e=>new p.Just(e)),y=e=>t=>{return n.sortImpl(t=>n=>{var a=e(t)(n);if(a instanceof h.GT)return 1;if(a instanceof h.EQ)return 0;if(a instanceof h.LT)return-1;throw new Error("Failed pattern match at Data.Array (line 702, column 15 - line 705, column 13): "+[a.constructor.name])})(t)},D=e=>t=>y(m.comparing(e)(t)),S=e=>[e],F=e=>0===n.length(e),P=e=>t=>n.zipWith(e)(n.range(0)(n.length(t)-1|0))(t),C=n._insertAt(p.Just.create)(p.Nothing.value),I=n.indexImpl(p.Just.create)(p.Nothing.value),M=e=>I(e)(n.length(e)-1|0),x=e=>I(e)(0),A=d.flip(o.bind(o.bindArray)),_=e=>{return A((t=p.maybe([])(S),n=>t(e(n))));var t},G=_(r.identity(r.categoryFn));t.singleton=S,t.null=F,t.head=x,t.last=M,t.tail=b,t.init=e=>{if(F(e))return p.Nothing.value;if(s.otherwise)return new p.Just(n.slice(0)(n.length(e)-1|0)(e));throw new Error("Failed pattern match at Data.Array (line 323, column 1 - line 323, column 45): "+[e.constructor.name])},t.index=I,t.insertAt=C,t.updateAt=f,t.updateAtIndices=e=>t=>n=>l.withArray(n=>c.traverse_(i.applicativeST)(e)(e=>l.poke(e.value0)(e.value1)(n))(t))(n)(),t.modifyAt=e=>t=>n=>{return p.maybe(p.Nothing.value)(a=>f(e)(t(a))(n))(I(n)(e))},t.concatMap=A,t.mapMaybe=_,t.catMaybes=G,t.mapWithIndex=P,t.sortWith=D,t.takeEnd=e=>t=>n.drop(n.length(t)-e|0)(t),t.nub=e=>(e=>t=>{var n,o=y(t=>n=>e(w.snd(t))(w.snd(n)))(P(w.Tuple.create)(t)),r=x(o);if(r instanceof p.Nothing)return[];if(r instanceof p.Just)return v.map(v.functorArray)(w.snd)(D(m.ordInt)(w.fst)((n=l.unsafeThaw(S(r.value0))(),i.foreach(o)(t=>()=>{var o,r,s=v.map(i.functorST)((o=p.fromJust(),r=e=>o(M(e)),e=>w.snd(r(e))))(l.unsafeFreeze(n))();return a.when(i.applicativeST)(u.notEq(h.eqOrdering)(e(s)(t.value1))(h.EQ.value))(v.void(i.functorST)(l.push(t)(n)))()})(),l.unsafeFreeze(n)())));throw new Error("Failed pattern match at Data.Array (line 903, column 17 - line 911, column 29): "+[r.constructor.name])})(m.compare(e)),t.zip=g,t.range=n.range,t.replicate=n.replicate,t.length=n.length,t.cons=n.cons,t.snoc=n.snoc,t.reverse=n.reverse,t.concat=n.concat,t.filter=n.filter,t.take=n.take,t.zipWith=n.zipWith})(PS),(e=>{"use strict";(PS["Unsafe.Coerce"]=PS["Unsafe.Coerce"]||{}).unsafeCoerce=e=>e})(),(e=>{"use strict";e["Unsafe.Coerce"]=e["Unsafe.Coerce"]||{};var t=e["Unsafe.Coerce"],n=e["Unsafe.Coerce"];t.unsafeCoerce=n.unsafeCoerce})(PS),(e=>{"use strict";e["Data.Array.NonEmpty"]=e["Data.Array.NonEmpty"]||{};var t=e["Data.Array.NonEmpty"],n=e["Data.Array"],a=e["Data.Boolean"],o=e["Data.Maybe"],r=e["Unsafe.Coerce"],i=r.unsafeCoerce,l=r.unsafeCoerce,s=e=>{var t=o.fromJust();return n=>t(e(l(n)))},u=s(n.head),c=s(n.init),d=s(n.last),v=s(n.tail),p=e=>t=>e(l(t));p(n.length);t.fromArray=e=>{if(n.length(e)>0)return new o.Just(i(e));if(a.otherwise)return o.Nothing.value;throw new Error("Failed pattern match at Data.Array.NonEmpty (line 134, column 1 - line 134, column 58): "+[e.constructor.name])},t.toArray=l,t.singleton=e=>i(n.singleton(e)),t.cons=e=>{return t=n.cons(e),a=p(t),e=>i(a(e));var t,a},t.head=u,t.last=d,t.tail=v,t.init=c})(PS),(e=>{"use strict";e["Data.Array.NonEmpty.Internal"]=e["Data.Array.NonEmpty.Internal"]||{};var t=e["Data.Array.NonEmpty.Internal"],n=e["Data.Foldable"].foldableArray;t.foldableNonEmptyArray=n})(PS),(e=>{"use strict";e.topInt=2147483647,e.bottomInt=-2147483648,e.topChar=String.fromCharCode(65535),e.bottomChar=String.fromCharCode(0)})(PS["Data.Bounded"]=PS["Data.Bounded"]||{}),function(e){"use strict";e["Data.Bounded"]=e["Data.Bounded"]||{};var t=e["Data.Bounded"],n=e["Data.Bounded"],a=e["Data.Ord"],o=function(e,t,n){this.Ord0=e,this.bottom=t,this.top=n},r=new o(()=>a.ordInt,n.bottomInt,n.topInt),i=new o(()=>a.ordChar,n.bottomChar,n.topChar);t.bottom=e=>e.bottom,t.top=e=>e.top,t.boundedInt=r,t.boundedChar=i}(PS),(e=>{"use strict";(PS["Data.Ring"]=PS["Data.Ring"]||{}).intSub=e=>t=>e-t|0})(),(e=>{"use strict";e.intAdd=e=>t=>e+t|0,e.intMul=e=>t=>e*t|0})(PS["Data.Semiring"]=PS["Data.Semiring"]||{}),function(e){"use strict";e["Data.Semiring"]=e["Data.Semiring"]||{};var t=e["Data.Semiring"],n=e["Data.Semiring"],a=new function(e,t,n,a){this.add=e,this.mul=t,this.one=n,this.zero=a}(n.intAdd,n.intMul,1,0);t.add=e=>e.add,t.semiringInt=a}(PS),function(e){"use strict";e["Data.Ring"]=e["Data.Ring"]||{};var t=e["Data.Ring"],n=e["Data.Ring"],a=e["Data.Semiring"],o=new function(e,t){this.Semiring0=e,this.sub=t}(()=>a.semiringInt,n.intSub);t.ringInt=o}(PS),function(e){"use strict";e["Data.CommutativeRing"]=e["Data.CommutativeRing"]||{};var t=e["Data.CommutativeRing"],n=e["Data.Ring"],a=new function(e){this.Ring0=e}(()=>n.ringInt);t.commutativeRingInt=a}(PS),(e=>{"use strict";e["Data.Const"]=e["Data.Const"]||{};var t=e["Data.Const"],n=e["Control.Applicative"],a=e["Control.Apply"],o=e["Data.Functor"],r=e["Data.Monoid"],i=e["Data.Newtype"],l=e["Data.Semigroup"],s=e=>e,u=new i.Newtype(e=>e,s),c=new o.Functor(e=>e=>e);t.Const=s,t.newtypeConst=u,t.applicativeConst=e=>new n.Applicative(()=>(e=>new a.Apply(()=>c,t=>n=>l.append(e)(t)(n)))(e.Semigroup0()),t=>r.mempty(e))})(PS),(e=>{"use strict";e.toCharCode=e=>e.charCodeAt(0),e.fromCharCode=e=>String.fromCharCode(e)})(PS["Data.Enum"]=PS["Data.Enum"]||{}),function(e){"use strict";e["Data.Enum"]=e["Data.Enum"]||{};var t=e["Data.Enum"],n=e["Data.Enum"],a=e["Data.Bounded"],o=e["Data.Maybe"],r=e["Data.Ord"],i=e=>e.fromEnum,l=e=>e>=a.bottom(a.boundedInt)&&e<=a.top(a.boundedInt)?new o.Just(n.fromCharCode(e)):o.Nothing.value,s=new function(e,t,n){this.Ord0=e,this.pred=t,this.succ=n}(()=>r.ordChar,(e=>t=>n=>e(t(n)-1|0))(l)(n.toCharCode),(e=>t=>n=>e(t(n)+1|0))(l)(n.toCharCode)),u=new function(e,t,n,a,o){this.Bounded0=e,this.Enum1=t,this.cardinality=n,this.fromEnum=a,this.toEnum=o}(()=>a.boundedChar,()=>s,n.toCharCode(a.top(a.boundedChar))-n.toCharCode(a.bottom(a.boundedChar))|0,n.toCharCode,l);t.fromEnum=i,t.toEnumWithDefaults=e=>t=>n=>r=>{var l=(e=>e.toEnum)(e)(r);if(l instanceof o.Just)return l.value0;if(l instanceof o.Nothing)return r<i(e)(a.bottom(e.Bounded0()))?t:n;throw new Error("Failed pattern match at Data.Enum (line 158, column 33 - line 160, column 62): "+[l.constructor.name])},t.boundedEnumChar=u}(PS),(e=>{"use strict";e.intDegree=e=>Math.min(Math.abs(e),2147483647),e.intDiv=e=>t=>0===t?0:t>0?Math.floor(e/t):-Math.floor(e/-t),e.intMod=e=>t=>{if(0===t)return 0;var n=Math.abs(t);return(e%n+n)%n}})(PS["Data.EuclideanRing"]=PS["Data.EuclideanRing"]||{}),function(e){"use strict";e["Data.EuclideanRing"]=e["Data.EuclideanRing"]||{};var t=e["Data.EuclideanRing"],n=e["Data.EuclideanRing"],a=e["Data.CommutativeRing"],o=new function(e,t,n,a){this.CommutativeRing0=e,this.degree=t,this.div=n,this.mod=a}(()=>a.commutativeRingInt,n.intDegree,n.intDiv,n.intMod);t.div=e=>e.div,t.mod=e=>e.mod,t.euclideanRingInt=o}(PS),(e=>{"use strict";(PS["Data.FunctorWithIndex"]=PS["Data.FunctorWithIndex"]||{}).mapWithIndexArray=e=>t=>{for(var n=t.length,a=Array(n),o=0;o<n;o++)a[o]=e(o)(t[o]);return a}})(),function(e){"use strict";e["Data.FunctorWithIndex"]=e["Data.FunctorWithIndex"]||{};var t=e["Data.FunctorWithIndex"],n=e["Data.FunctorWithIndex"],a=e["Data.Functor"],o=new function(e,t){this.Functor0=e,this.mapWithIndex=t}(()=>a.functorArray,n.mapWithIndexArray);t.mapWithIndex=e=>e.mapWithIndex,t.functorWithIndexArray=o}(PS),function(e){"use strict";e["Data.FoldableWithIndex"]=e["Data.FoldableWithIndex"]||{};var t=e["Data.FoldableWithIndex"],n=e["Data.Foldable"],a=e["Data.FunctorWithIndex"],o=e["Data.Monoid"],r=e["Data.Monoid.Conj"],i=e["Data.Newtype"],l=e["Data.Semigroup"],s=function(){function e(e,t){this.value0=e,this.value1=t}return e.create=t=>n=>new e(t,n),e}(),u=new function(e,t,n,a){this.Foldable0=e,this.foldMapWithIndex=t,this.foldlWithIndex=n,this.foldrWithIndex=a}(()=>n.foldableArray,e=>(e=>t=>n=>(e=>e.foldrWithIndex)(e)(e=>a=>o=>l.append(t.Semigroup0())(n(e)(a))(o))(o.mempty(t)))(u)(e),e=>t=>{var o=n.foldl(n.foldableArray)(t=>n=>e(n.value0)(t)(n.value1))(t),r=a.mapWithIndex(a.functorWithIndexArray)(s.create);return e=>o(r(e))},e=>t=>{var o=n.foldr(n.foldableArray)(t=>n=>e(t.value0)(t.value1)(n))(t),r=a.mapWithIndex(a.functorWithIndexArray)(s.create);return e=>o(r(e))});t.allWithIndex=e=>t=>n=>{var a=i.unwrap(i.newtypeConj),o=(e=>e.foldMapWithIndex)(e)(r.monoidConj(t))(e=>{var t=n(e);return e=>r.Conj(t(e))});return e=>a(o(e))},t.foldableWithIndexArray=u}(PS),function(e){"use strict";e["Data.Symbol"]=e["Data.Symbol"]||{};var t=e["Data.Symbol"],n=(()=>{function e(){}return e.value=new e,e})();t.IsSymbol=function(e){this.reflectSymbol=e},t.reflectSymbol=e=>e.reflectSymbol,t.SProxy=n}(PS),(e=>{"use strict";(PS["Partial.Unsafe"]=PS["Partial.Unsafe"]||{}).unsafePartial=e=>e()})(),(e=>{"use strict";(PS["Partial"]=PS["Partial"]||{}).crashWith=()=>e=>{throw new Error(e)}})(),(e=>{"use strict";e.Partial=e.Partial||{};var t=e.Partial,n=e.Partial;t.crashWith=n.crashWith})(PS),(e=>{"use strict";e["Partial.Unsafe"]=e["Partial.Unsafe"]||{};var t=e["Partial.Unsafe"],n=e["Partial.Unsafe"],a=e.Partial;t.unsafeCrashWith=e=>n.unsafePartial(t=>a.crashWith()(e))})(PS),(e=>{"use strict";e.unsafeHas=e=>t=>({}).hasOwnProperty.call(t,e),e.unsafeGet=e=>t=>t[e]})(PS["Record.Unsafe"]=PS["Record.Unsafe"]||{}),(e=>{"use strict";e["Record.Unsafe"]=e["Record.Unsafe"]||{};var t=e["Record.Unsafe"],n=e["Record.Unsafe"];t.unsafeHas=n.unsafeHas,t.unsafeGet=n.unsafeGet})(PS),(e=>{"use strict";e["Data.Functor.Variant"]=e["Data.Functor.Variant"]||{};var t=e["Data.Functor.Variant"],n=e["Data.Functor"],a=e["Data.Symbol"],o=e["Partial.Unsafe"],r=e["Record.Unsafe"],i=e=>e=>e=>e=>t=>n=>r.unsafeHas(n.type)(e)?r.unsafeGet(n.type)(e)(n.value):t(n),l=new n.Functor(e=>t=>({type:t.type,value:t.map(e)(t.value),map:t.map})),s=e=>o.unsafeCrashWith("Data.Functor.Variant: pattern match failure ["+e.type+"]");t.inj=e=>e=>t=>o=>r=>({type:a.reflectSymbol(e)(o),value:r,map:n.map(t)}),t.onMatch=i,t.match=e=>e=>e=>e=>i()()()(e)(s),t.functorVariantF=l})(PS),(e=>{"use strict";e.fromNumberImpl=e=>t=>n=>(0|n)===n?e(n):t,e.toNumber=e=>e})(PS["Data.Int"]=PS["Data.Int"]||{}),(e=>{"use strict";(PS["Global"]=PS["Global"]||{}).infinity=1/0})(),(e=>{"use strict";e.Global=e.Global||{};var t=e.Global,n=e.Global;t.infinity=n.infinity})(PS),(e=>{"use strict";e.abs=Math.abs,e.cos=Math.cos,e.floor=Math.floor,e.sin=Math.sin,e.sqrt=Math.sqrt,e.pi=Math.PI})(PS.Math=PS.Math||{}),(e=>{"use strict";e.Math=e.Math||{};var t=e.Math,n=e.Math;t.abs=n.abs,t.cos=n.cos,t.floor=n.floor,t.sin=n.sin,t.sqrt=n.sqrt,t.pi=n.pi})(PS),(e=>{"use strict";e["Data.Int"]=e["Data.Int"]||{};var t=e["Data.Int"],n=e["Data.Int"],a=e["Data.Boolean"],o=e["Data.Bounded"],r=e["Data.Maybe"],i=e.Global,l=e.Math,s=n.fromNumberImpl(r.Just.create)(r.Nothing.value);t.floor=e=>(e=>{if(e===i.infinity)return 0;if(e===-i.infinity)return 0;if(e>=n.toNumber(o.top(o.boundedInt)))return o.top(o.boundedInt);if(e<=n.toNumber(o.bottom(o.boundedInt)))return o.bottom(o.boundedInt);if(a.otherwise)return r.fromMaybe(0)(s(e));throw new Error("Failed pattern match at Data.Int (line 66, column 1 - line 66, column 29): "+[e.constructor.name])})(l.floor(e)),t.even=e=>0==(1&e),t.toNumber=n.toNumber})(PS),(e=>{"use strict";(PS["Data.Int.Bits"]=PS["Data.Int.Bits"]||{}).xor=e=>t=>e^t})(),(e=>{"use strict";e["Data.Int.Bits"]=e["Data.Int.Bits"]||{};var t=e["Data.Int.Bits"],n=e["Data.Int.Bits"];t.xor=n.xor})(PS),(e=>{"use strict";e.defer=e=>{var t=null;return()=>void 0===e?t:(t=e(),e=void 0,t)},e.force=e=>e()})(PS["Data.Lazy"]=PS["Data.Lazy"]||{}),(e=>{"use strict";e["Data.Lazy"]=e["Data.Lazy"]||{};var t=e["Data.Lazy"],n=e["Data.Lazy"];t.defer=n.defer,t.force=n.force})(PS),function(e){"use strict";e["Data.Profunctor"]=e["Data.Profunctor"]||{};var t=e["Data.Profunctor"],n=function(e){this.dimap=e},a=new n(e=>t=>n=>a=>t(n(e(a))));t.dimap=e=>e.dimap,t.Profunctor=n,t.profunctorFn=a}(PS),function(e){"use strict";e["Data.Profunctor.Choice"]=e["Data.Profunctor.Choice"]||{};var t=e["Data.Profunctor.Choice"],n=e["Data.Either"],a=e["Data.Functor"],o=e["Data.Profunctor"],r=function(e,t,n){this.Profunctor0=e,this.left=t,this.right=n},i=new r(()=>o.profunctorFn,e=>t=>{if(t instanceof n.Left)return n.Left.create(e(t.value0));if(t instanceof n.Right)return new n.Right(t.value0);throw new Error("Failed pattern match at Data.Profunctor.Choice (line 32, column 1 - line 35, column 16): "+[e.constructor.name,t.constructor.name])},a.map(n.functorEither));t.Choice=r,t.choiceFn=i}(PS),function(e){"use strict";e["Data.Profunctor.Strong"]=e["Data.Profunctor.Strong"]||{};var t=e["Data.Profunctor.Strong"],n=e["Data.Functor"],a=e["Data.Profunctor"],o=e["Data.Tuple"],r=function(e,t,n){this.Profunctor0=e,this.first=t,this.second=n},i=new r(()=>a.profunctorFn,e=>t=>new o.Tuple(e(t.value0),t.value1),n.map(o.functorTuple));t.first=e=>e.first,t.Strong=r,t.strongFn=i}(PS),function(e){"use strict";e["Data.Lens.Internal.Wander"]=e["Data.Lens.Internal.Wander"]||{};var t=e["Data.Lens.Internal.Wander"],n=e["Data.Functor"],a=e["Data.Identity"],o=e["Data.Newtype"],r=e["Data.Profunctor.Choice"],i=e["Data.Profunctor.Strong"],l=function(e,t,n){this.Choice1=e,this.Strong0=t,this.wander=n},s=new l(()=>r.choiceFn,()=>i.strongFn,e=>o.alaF(n.functorFn)(n.functorFn)(a.newtypeIdentity)(a.newtypeIdentity)(a.Identity)(e(a.applicativeIdentity)));t.wander=e=>e.wander,t.Wander=l,t.wanderFunction=s}(PS),function(e){"use strict";e["Data.Map.Internal"]=e["Data.Map.Internal"]||{};var t=e["Data.Map.Internal"],n=e["Control.Applicative"],a=e["Data.Foldable"],o=e["Data.List.Types"],r=e["Data.Maybe"],i=e["Data.Ord"],l=e["Data.Ordering"],s=e["Data.Semigroup"],u=e["Data.Tuple"],c=(()=>{function e(){}return e.value=new e,e})(),d=function(){function e(e,t,n,a){this.value0=e,this.value1=t,this.value2=n,this.value3=a}return e.create=t=>n=>a=>o=>new e(t,n,a,o),e}(),v=function(){function e(e,t,n,a,o,r,i){this.value0=e,this.value1=t,this.value2=n,this.value3=a,this.value4=o,this.value5=r,this.value6=i}return e.create=t=>n=>a=>o=>r=>i=>l=>new e(t,n,a,o,r,i,l),e}(),p=function(){function e(e,t,n){this.value0=e,this.value1=t,this.value2=n}return e.create=t=>n=>a=>new e(t,n,a),e}(),m=function(){function e(e,t,n){this.value0=e,this.value1=t,this.value2=n}return e.create=t=>n=>a=>new e(t,n,a),e}(),h=function(){function e(e,t,n,a,o,r){this.value0=e,this.value1=t,this.value2=n,this.value3=a,this.value4=o,this.value5=r}return e.create=t=>n=>a=>o=>r=>i=>new e(t,n,a,o,r,i),e}(),w=function(){function e(e,t,n,a,o,r){this.value0=e,this.value1=t,this.value2=n,this.value3=a,this.value4=o,this.value5=r}return e.create=t=>n=>a=>o=>r=>i=>new e(t,n,a,o,r,i),e}(),g=function(){function e(e,t,n,a,o,r){this.value0=e,this.value1=t,this.value2=n,this.value3=a,this.value4=o,this.value5=r}return e.create=t=>n=>a=>o=>r=>i=>new e(t,n,a,o,r,i),e}(),f=function(){function e(e,t,n,a){this.value0=e,this.value1=t,this.value2=n,this.value3=a}return e.create=t=>n=>a=>o=>new e(t,n,a,o),e}(),b=e=>{if(e instanceof c)return o.Nil.value;if(e instanceof d)return s.append(o.semigroupList)(b(e.value0))(s.append(o.semigroupList)(n.pure(o.applicativeList)(e.value2))(b(e.value3)));if(e instanceof v)return s.append(o.semigroupList)(b(e.value0))(s.append(o.semigroupList)(n.pure(o.applicativeList)(e.value2))(s.append(o.semigroupList)(b(e.value3))(s.append(o.semigroupList)(n.pure(o.applicativeList)(e.value5))(b(e.value6)))));throw new Error("Failed pattern match at Data.Map.Internal (line 612, column 1 - line 612, column 40): "+[e.constructor.name])},y=e=>t=>n=>{var a,r=e,i=t,l=!1;function s(e,t,a){if(t instanceof o.Nil)return l=!0,a;if(t instanceof o.Cons){if(t.value0 instanceof p)return r=e,i=t.value1,void(n=new d(a,t.value0.value0,t.value0.value1,t.value0.value2));if(t.value0 instanceof m)return r=e,i=t.value1,void(n=new d(t.value0.value0,t.value0.value1,t.value0.value2,a));if(t.value0 instanceof h)return r=e,i=t.value1,void(n=new v(a,t.value0.value0,t.value0.value1,t.value0.value2,t.value0.value3,t.value0.value4,t.value0.value5));if(t.value0 instanceof w)return r=e,i=t.value1,void(n=new v(t.value0.value0,t.value0.value1,t.value0.value2,a,t.value0.value3,t.value0.value4,t.value0.value5));if(t.value0 instanceof g)return r=e,i=t.value1,void(n=new v(t.value0.value0,t.value0.value1,t.value0.value2,t.value0.value3,t.value0.value4,t.value0.value5,a));throw new Error("Failed pattern match at Data.Map.Internal (line 418, column 3 - line 423, column 88): "+[t.value0.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 415, column 1 - line 415, column 80): "+[t.constructor.name,a.constructor.name])}for(;!l;)a=s(r,i,n);return a},D=e=>t=>n=>{var a=t=>n=>{var a,r=t,i=!1;function l(t,a){if(t instanceof o.Nil)return i=!0,new d(a.value0,a.value1,a.value2,a.value3);if(t instanceof o.Cons){if(t.value0 instanceof p)return i=!0,y(e)(t.value1)(new v(a.value0,a.value1,a.value2,a.value3,t.value0.value0,t.value0.value1,t.value0.value2));if(t.value0 instanceof m)return i=!0,y(e)(t.value1)(new v(t.value0.value0,t.value0.value1,t.value0.value2,a.value0,a.value1,a.value2,a.value3));if(t.value0 instanceof h)return r=t.value1,void(n=new f(new d(a.value0,a.value1,a.value2,a.value3),t.value0.value0,t.value0.value1,new d(t.value0.value2,t.value0.value3,t.value0.value4,t.value0.value5)));if(t.value0 instanceof w)return r=t.value1,void(n=new f(new d(t.value0.value0,t.value0.value1,t.value0.value2,a.value0),a.value1,a.value2,new d(a.value3,t.value0.value3,t.value0.value4,t.value0.value5)));if(t.value0 instanceof g)return r=t.value1,void(n=new f(new d(t.value0.value0,t.value0.value1,t.value0.value2,t.value0.value3),t.value0.value4,t.value0.value5,new d(a.value0,a.value1,a.value2,a.value3)));throw new Error("Failed pattern match at Data.Map.Internal (line 454, column 5 - line 459, column 108): "+[t.value0.constructor.name,a.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 451, column 3 - line 451, column 56): "+[t.constructor.name,a.constructor.name])}for(;!i;)a=l(r,n);return a},r=i.compare(e);return(i=>s=>{var u,b=i,D=!1;function S(i,u){if(u instanceof c)return D=!0,a(i)(new f(c.value,t,n,c.value));if(u instanceof d){var S=r(t)(u.value1);return S instanceof l.EQ?(D=!0,y(e)(i)(new d(u.value0,t,n,u.value3))):S instanceof l.LT?(b=new o.Cons(new p(u.value1,u.value2,u.value3),i),void(s=u.value0)):(b=new o.Cons(new m(u.value0,u.value1,u.value2),i),void(s=u.value3))}if(u instanceof v){var F=r(t)(u.value1);if(F instanceof l.EQ)return D=!0,y(e)(i)(new v(u.value0,t,n,u.value3,u.value4,u.value5,u.value6));var P=r(t)(u.value4);return P instanceof l.EQ?(D=!0,y(e)(i)(new v(u.value0,u.value1,u.value2,u.value3,t,n,u.value6))):F instanceof l.LT?(b=new o.Cons(new h(u.value1,u.value2,u.value3,u.value4,u.value5,u.value6),i),void(s=u.value0)):F instanceof l.GT&&P instanceof l.LT?(b=new o.Cons(new w(u.value0,u.value1,u.value2,u.value4,u.value5,u.value6),i),void(s=u.value3)):(b=new o.Cons(new g(u.value0,u.value1,u.value2,u.value3,u.value4,u.value5),i),void(s=u.value6))}throw new Error("Failed pattern match at Data.Map.Internal (line 434, column 3 - line 434, column 55): "+[i.constructor.name,u.constructor.name])}for(;!D;)u=S(b,s);return u})(o.Nil.value)},S=c.value;t.empty=S,t.insert=D,t.lookup=e=>t=>{var n=i.compare(e);return e=>{var a,o=!1;function i(a){if(a instanceof c)return o=!0,r.Nothing.value;if(a instanceof d){var i=n(t)(a.value1);return i instanceof l.EQ?(o=!0,new r.Just(a.value2)):i instanceof l.LT?void(e=a.value0):void(e=a.value3)}if(a instanceof v){var s=n(t)(a.value1);if(s instanceof l.EQ)return o=!0,new r.Just(a.value2);var u=n(t)(a.value4);return u instanceof l.EQ?(o=!0,new r.Just(a.value5)):s instanceof l.LT?void(e=a.value0):u instanceof l.GT?void(e=a.value6):void(e=a.value3)}throw new Error("Failed pattern match at Data.Map.Internal (line 200, column 5 - line 200, column 22): "+[a.constructor.name])}for(;!o;)a=i(e);return a}},t.fromFoldable=e=>t=>a.foldl(t)(t=>n=>D(e)(n.value0)(n.value1)(t))(S),t.delete=e=>t=>n=>r.maybe(n)(u.snd)((e=>t=>{var n=t=>n=>{var a,r=t,i=!1;function l(t,a){if(t instanceof o.Nil)return i=!0,a;if(t instanceof o.Cons){if(t.value0 instanceof p&&t.value0.value2 instanceof c&&a instanceof c)return i=!0,y(e)(t.value1)(new d(c.value,t.value0.value0,t.value0.value1,c.value));if(t.value0 instanceof m&&t.value0.value0 instanceof c&&a instanceof c)return i=!0,y(e)(t.value1)(new d(c.value,t.value0.value1,t.value0.value2,c.value));if(t.value0 instanceof p&&t.value0.value2 instanceof d)return r=t.value1,void(n=new v(a,t.value0.value0,t.value0.value1,t.value0.value2.value0,t.value0.value2.value1,t.value0.value2.value2,t.value0.value2.value3));if(t.value0 instanceof m&&t.value0.value0 instanceof d)return r=t.value1,void(n=new v(t.value0.value0.value0,t.value0.value0.value1,t.value0.value0.value2,t.value0.value0.value3,t.value0.value1,t.value0.value2,a));if(t.value0 instanceof p&&t.value0.value2 instanceof v)return i=!0,y(e)(t.value1)(new d(new d(a,t.value0.value0,t.value0.value1,t.value0.value2.value0),t.value0.value2.value1,t.value0.value2.value2,new d(t.value0.value2.value3,t.value0.value2.value4,t.value0.value2.value5,t.value0.value2.value6)));if(t.value0 instanceof m&&t.value0.value0 instanceof v)return i=!0,y(e)(t.value1)(new d(new d(t.value0.value0.value0,t.value0.value0.value1,t.value0.value0.value2,t.value0.value0.value3),t.value0.value0.value4,t.value0.value0.value5,new d(t.value0.value0.value6,t.value0.value1,t.value0.value2,a)));if(t.value0 instanceof h&&t.value0.value2 instanceof c&&t.value0.value5 instanceof c&&a instanceof c)return i=!0,y(e)(t.value1)(new v(c.value,t.value0.value0,t.value0.value1,c.value,t.value0.value3,t.value0.value4,c.value));if(t.value0 instanceof w&&t.value0.value0 instanceof c&&t.value0.value5 instanceof c&&a instanceof c)return i=!0,y(e)(t.value1)(new v(c.value,t.value0.value1,t.value0.value2,c.value,t.value0.value3,t.value0.value4,c.value));if(t.value0 instanceof g&&t.value0.value0 instanceof c&&t.value0.value3 instanceof c&&a instanceof c)return i=!0,y(e)(t.value1)(new v(c.value,t.value0.value1,t.value0.value2,c.value,t.value0.value4,t.value0.value5,c.value));if(t.value0 instanceof h&&t.value0.value2 instanceof d)return i=!0,y(e)(t.value1)(new d(new v(a,t.value0.value0,t.value0.value1,t.value0.value2.value0,t.value0.value2.value1,t.value0.value2.value2,t.value0.value2.value3),t.value0.value3,t.value0.value4,t.value0.value5));if(t.value0 instanceof w&&t.value0.value0 instanceof d)return i=!0,y(e)(t.value1)(new d(new v(t.value0.value0.value0,t.value0.value0.value1,t.value0.value0.value2,t.value0.value0.value3,t.value0.value1,t.value0.value2,a),t.value0.value3,t.value0.value4,t.value0.value5));if(t.value0 instanceof w&&t.value0.value5 instanceof d)return i=!0,y(e)(t.value1)(new d(t.value0.value0,t.value0.value1,t.value0.value2,new v(a,t.value0.value3,t.value0.value4,t.value0.value5.value0,t.value0.value5.value1,t.value0.value5.value2,t.value0.value5.value3)));if(t.value0 instanceof g&&t.value0.value3 instanceof d)return i=!0,y(e)(t.value1)(new d(t.value0.value0,t.value0.value1,t.value0.value2,new v(t.value0.value3.value0,t.value0.value3.value1,t.value0.value3.value2,t.value0.value3.value3,t.value0.value4,t.value0.value5,a)));if(t.value0 instanceof h&&t.value0.value2 instanceof v)return i=!0,y(e)(t.value1)(new v(new d(a,t.value0.value0,t.value0.value1,t.value0.value2.value0),t.value0.value2.value1,t.value0.value2.value2,new d(t.value0.value2.value3,t.value0.value2.value4,t.value0.value2.value5,t.value0.value2.value6),t.value0.value3,t.value0.value4,t.value0.value5));if(t.value0 instanceof w&&t.value0.value0 instanceof v)return i=!0,y(e)(t.value1)(new v(new d(t.value0.value0.value0,t.value0.value0.value1,t.value0.value0.value2,t.value0.value0.value3),t.value0.value0.value4,t.value0.value0.value5,new d(t.value0.value0.value6,t.value0.value1,t.value0.value2,a),t.value0.value3,t.value0.value4,t.value0.value5));if(t.value0 instanceof w&&t.value0.value5 instanceof v)return i=!0,y(e)(t.value1)(new v(t.value0.value0,t.value0.value1,t.value0.value2,new d(a,t.value0.value3,t.value0.value4,t.value0.value5.value0),t.value0.value5.value1,t.value0.value5.value2,new d(t.value0.value5.value3,t.value0.value5.value4,t.value0.value5.value5,t.value0.value5.value6)));if(t.value0 instanceof g&&t.value0.value3 instanceof v)return i=!0,y(e)(t.value1)(new v(t.value0.value0,t.value0.value1,t.value0.value2,new d(t.value0.value3.value0,t.value0.value3.value1,t.value0.value3.value2,t.value0.value3.value3),t.value0.value3.value4,t.value0.value3.value5,new d(t.value0.value3.value6,t.value0.value4,t.value0.value5,a)));throw new Error("Failed pattern match at Data.Map.Internal (line 511, column 9 - line 528, column 136): "+[t.value0.constructor.name,a.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 508, column 5 - line 528, column 136): "+[t.constructor.name])}for(;!i;)a=l(r,n);return a},a=e=>t=>{var a,r=e,i=!1;function l(e,a){if(a instanceof d&&a.value0 instanceof c&&a.value3 instanceof c)return i=!0,n(e)(c.value);if(a instanceof d)return r=new o.Cons(new m(a.value0,a.value1,a.value2),e),void(t=a.value3);if(a instanceof v&&a.value0 instanceof c&&a.value3 instanceof c&&a.value6 instanceof c)return i=!0,n(new o.Cons(new m(c.value,a.value1,a.value2),e))(c.value);if(a instanceof v)return r=new o.Cons(new g(a.value0,a.value1,a.value2,a.value3,a.value4,a.value5),e),void(t=a.value6);throw new Error("Failed pattern match at Data.Map.Internal (line 540, column 5 - line 544, column 107): "+[a.constructor.name])}for(;!i;)a=l(r,t);return a},s=e=>{var t,n=!1;function a(t){if(t instanceof d&&t.value3 instanceof c)return n=!0,{key:t.value1,value:t.value2};if(t instanceof d)e=t.value3;else{if(t instanceof v&&t.value6 instanceof c)return n=!0,{key:t.value4,value:t.value5};if(!(t instanceof v))throw new Error("Failed pattern match at Data.Map.Internal (line 531, column 33 - line 535, column 45): "+[t.constructor.name]);e=t.value6}}for(;!n;)t=a(e);return t},f=i.compare(e);return(i=>b=>{var D,S=i,F=!1;function P(i,D){if(D instanceof c)return F=!0,r.Nothing.value;if(D instanceof d){var P=f(t)(D.value1);if(D.value3 instanceof c&&P instanceof l.EQ)return F=!0,new r.Just(new u.Tuple(D.value2,n(i)(c.value)));if(P instanceof l.EQ){var C=s(D.value0);return F=!0,new r.Just(new u.Tuple(D.value2,a(new o.Cons(new p(C.key,C.value,D.value3),i))(D.value0)))}return P instanceof l.LT?(S=new o.Cons(new p(D.value1,D.value2,D.value3),i),void(b=D.value0)):(S=new o.Cons(new m(D.value0,D.value1,D.value2),i),void(b=D.value3))}if(D instanceof v){var I=(()=>D.value0 instanceof c&&D.value3 instanceof c&&D.value6 instanceof c)(),M=(P=f(t)(D.value4),f(t)(D.value1));if(I&&M instanceof l.EQ)return F=!0,new r.Just(new u.Tuple(D.value2,y(e)(i)(new d(c.value,D.value4,D.value5,c.value))));if(I&&P instanceof l.EQ)return F=!0,new r.Just(new u.Tuple(D.value5,y(e)(i)(new d(c.value,D.value1,D.value2,c.value))));if(M instanceof l.EQ){C=s(D.value0);return F=!0,new r.Just(new u.Tuple(D.value2,a(new o.Cons(new h(C.key,C.value,D.value3,D.value4,D.value5,D.value6),i))(D.value0)))}if(P instanceof l.EQ){C=s(D.value3);return F=!0,new r.Just(new u.Tuple(D.value5,a(new o.Cons(new w(D.value0,D.value1,D.value2,C.key,C.value,D.value6),i))(D.value3)))}return M instanceof l.LT?(S=new o.Cons(new h(D.value1,D.value2,D.value3,D.value4,D.value5,D.value6),i),void(b=D.value0)):M instanceof l.GT&&P instanceof l.LT?(S=new o.Cons(new w(D.value0,D.value1,D.value2,D.value4,D.value5,D.value6),i),void(b=D.value3)):(S=new o.Cons(new g(D.value0,D.value1,D.value2,D.value3,D.value4,D.value5),i),void(b=D.value6))}throw new Error("Failed pattern match at Data.Map.Internal (line 481, column 34 - line 504, column 80): "+[D.constructor.name])}for(;!F;)D=P(S,b);return D})(o.Nil.value)})(e)(t)(n)),t.values=b}(PS),function(e){"use strict";e["Data.Lens.Index"]=e["Data.Lens.Index"]||{};var t=e["Data.Lens.Index"],n=e["Control.Applicative"],a=e["Data.Array"],o=e["Data.Functor"],r=e["Data.Lens.Internal.Wander"],i=e["Data.Map.Internal"],l=e["Data.Maybe"],s=function(e){this.ix=e},u=new s(e=>t=>r.wander(t)(t=>r=>i=>{return l.maybe(n.pure(t)(i))((s=o.map(t.Apply0().Functor0())(t=>l.fromMaybe(i)(a.updateAt(e)(t)(i))),e=>s(r(e))))(a.index(i)(e));var s}));t.ix=e=>e.ix,t.indexArray=u,t.indexMap=e=>new s(t=>a=>r.wander(a)(a=>r=>s=>{return l.maybe(n.pure(a)(s))((u=o.map(a.Apply0().Functor0())(n=>i.insert(e)(t)(n)(s)),e=>u(r(e))))(i.lookup(e)(t)(s));var u}))}(PS),(e=>{"use strict";e["Data.Lens.Lens"]=e["Data.Lens.Lens"]||{};var t=e["Data.Lens.Lens"],n=e["Data.Profunctor"],a=e["Data.Profunctor.Strong"],o=e["Data.Tuple"];t.lens=e=>t=>r=>(e=>t=>o=>n.dimap(t.Profunctor0())(e)(e=>e.value1(e.value0))(a.first(t)(o)))(n=>new o.Tuple(e(n),e=>t(n)(e)))(r)})(PS),function(e){"use strict";e["Data.Lens.At"]=e["Data.Lens.At"]||{};var t=e["Data.Lens.At"],n=e["Data.Lens.Index"],a=e["Data.Lens.Lens"],o=e["Data.Map.Internal"],r=e["Data.Maybe"],i=function(e,t){this.Index0=e,this.at=t};t.at=e=>e.at,t.atMap=e=>new i(()=>n.indexMap(e),t=>n=>a.lens(o.lookup(e)(t))(n=>r.maybe(o.delete(e)(t)(n))(a=>o.insert(e)(t)(a)(n)))(n))}(PS),(e=>{"use strict";e["Data.Lens.Internal.Forget"]=e["Data.Lens.Internal.Forget"]||{};var t=e["Data.Lens.Internal.Forget"],n=e["Data.Const"],a=e["Data.Either"],o=e["Data.Functor"],r=e["Data.Lens.Internal.Wander"],i=e["Data.Monoid"],l=e["Data.Newtype"],s=e["Data.Profunctor"],u=e["Data.Profunctor.Choice"],c=e["Data.Profunctor.Strong"],d=e["Data.Tuple"],v=new s.Profunctor(e=>t=>t=>n=>t(e(n))),p=new c.Strong(()=>v,e=>t=>e(d.fst(t)),e=>t=>e(d.snd(t))),m=new l.Newtype(e=>e,e=>e);t.newtypeForget=m,t.profunctorForget=v,t.strongForget=p,t.wanderForget=e=>new r.Wander(()=>(e=>new u.Choice(()=>v,t=>a.either(t)(i.mempty(i.monoidFn(e))),t=>a.either(i.mempty(i.monoidFn(e)))(t)))(e),()=>p,t=>a=>l.alaF(o.functorFn)(o.functorFn)(n.newtypeConst)(n.newtypeConst)(n.Const)(t(n.applicativeConst(e)))(a))})(PS),(e=>{"use strict";e["Data.Lens.Getter"]=e["Data.Lens.Getter"]||{};var t=e["Data.Lens.Getter"],n=e["Control.Category"],a=e["Data.Lens.Internal.Forget"],o=e["Data.Newtype"],r=e=>o.unwrap(a.newtypeForget)(e(n.identity(n.categoryFn)));t.viewOn=e=>t=>r(t)(e),t.view=r})(PS),(e=>{"use strict";e["Data.Lens.Iso"]=e["Data.Lens.Iso"]||{};var t=e["Data.Lens.Iso"],n=e["Data.Profunctor"];t.iso=e=>t=>a=>o=>n.dimap(a)(e)(t)(o)})(PS),(e=>{"use strict";e["Data.Lens.Setter"]=e["Data.Lens.Setter"]||{};var t=e["Data.Lens.Setter"],n=e["Data.Function"],a=e["Data.Semiring"],o=e=>e;t.over=o,t.set=e=>t=>o(e)(n.const(t)),t.addOver=e=>t=>{var n=o(t),r=a.add(e);return e=>n(r(e))}})(PS),function(e){"use strict";e["Data.NonEmpty"]=e["Data.NonEmpty"]||{};var t=e["Data.NonEmpty"],n=e["Control.Plus"],a=function(){function e(e,t){this.value0=e,this.value1=t}return e.create=t=>n=>new e(t,n),e}();t.singleton=e=>t=>new a(t,n.empty(e))}(PS),(e=>{"use strict";e["Data.List.NonEmpty"]=e["Data.List.NonEmpty"]||{};var t,n=e["Data.List.NonEmpty"],a=e["Data.List.Types"],o=e["Data.NonEmpty"],r=(t=o.singleton(a.plusList),e=>a.NonEmptyList(t(e)));n.singleton=r})(PS),(e=>{"use strict";e.showIntImpl=e=>e.toString(),e.showNumberImpl=e=>{var t=e.toString();return isNaN(t+".0")?t:t+".0"}})(PS["Data.Show"]=PS["Data.Show"]||{}),function(e){"use strict";e["Data.Show"]=e["Data.Show"]||{};var t=e["Data.Show"],n=e["Data.Show"],a=function(e){this.show=e},o=new a(n.showNumberImpl),r=new a(n.showIntImpl);t.Show=a,t.show=e=>e.show,t.showInt=r,t.showNumber=o}(PS),(e=>{"use strict";var t="function"==typeof Array.from,n="undefined"!=typeof Symbol&&null!=Symbol&&void 0!==Symbol.iterator&&"function"==typeof String.prototype[Symbol.iterator],a="function"==typeof String.prototype.fromCodePoint,o="function"==typeof String.prototype.codePointAt;e._unsafeCodePointAt0=e=>o?e=>e.codePointAt(0):e,e._singleton=e=>a?String.fromCodePoint:e,e._take=e=>t=>n?e=>{for(var n="",a=e[Symbol.iterator](),o=0;o<t;++o){var r=a.next();if(r.done)return n;n+=r.value}return n}:e(t),e._toCodePointArray=e=>n=>t?e=>Array.from(e,n):e})(PS["Data.String.CodePoints"]=PS["Data.String.CodePoints"]||{}),(e=>{"use strict";e.singleton=e=>e,e.length=e=>e.length,e._indexOf=e=>t=>n=>a=>{var o=a.indexOf(n);return-1===o?t:e(o)},e.take=e=>t=>t.substr(0,e),e.drop=e=>t=>t.substring(e)})(PS["Data.String.CodeUnits"]=PS["Data.String.CodeUnits"]||{}),(e=>{"use strict";e["Data.String.CodeUnits"]=e["Data.String.CodeUnits"]||{};var t=e["Data.String.CodeUnits"],n=e["Data.String.CodeUnits"],a=e["Data.Maybe"],o=n._indexOf(a.Just.create)(a.Nothing.value);t.indexOf=o,t.singleton=n.singleton,t.length=n.length,t.take=n.take,t.drop=n.drop})(PS),(e=>{"use strict";(PS["Data.String.Unsafe"]=PS["Data.String.Unsafe"]||{}).charAt=e=>t=>{if(e>=0&&e<t.length)return t.charAt(e);throw new Error("Data.String.Unsafe.charAt: Invalid index.")}})(),(e=>{"use strict";e["Data.String.Unsafe"]=e["Data.String.Unsafe"]||{};var t=e["Data.String.Unsafe"],n=e["Data.String.Unsafe"];t.charAt=n.charAt})(PS),(e=>{"use strict";(PS["Data.Unfoldable"]=PS["Data.Unfoldable"]||{}).unfoldrArrayImpl=e=>t=>n=>a=>o=>r=>{for(var i=[],l=r;;){var s=o(l);if(e(s))return i;var u=t(s);i.push(n(u)),l=a(u)}}})(),(e=>{"use strict";(PS["Data.Unfoldable1"]=PS["Data.Unfoldable1"]||{}).unfoldr1ArrayImpl=e=>t=>n=>a=>o=>r=>{for(var i=[],l=r;;){var s=o(l);i.push(n(s));var u=a(s);if(e(u))return i;l=t(u)}}})(),function(e){"use strict";e["Data.Unfoldable1"]=e["Data.Unfoldable1"]||{};var t=e["Data.Unfoldable1"],n=e["Data.Unfoldable1"],a=e["Data.Maybe"],o=e["Data.Tuple"],r=new function(e){this.unfoldr1=e}(n.unfoldr1ArrayImpl(a.isNothing)(a.fromJust())(o.fst)(o.snd));t.unfoldable1Array=r}(PS),function(e){"use strict";e["Data.Unfoldable"]=e["Data.Unfoldable"]||{};var t=e["Data.Unfoldable"],n=e["Data.Unfoldable"],a=e["Data.Maybe"],o=e["Data.Tuple"],r=e["Data.Unfoldable1"],i=new function(e,t){this.Unfoldable10=e,this.unfoldr=t}(()=>r.unfoldable1Array,n.unfoldrArrayImpl(a.isNothing)(a.fromJust())(o.fst)(o.snd));t.unfoldr=e=>e.unfoldr,t.unfoldableArray=i}(PS),(e=>{"use strict";e["Data.String.CodePoints"]=e["Data.String.CodePoints"]||{};var t,n=e["Data.String.CodePoints"],a=e["Data.String.CodePoints"],o=e["Data.Array"],r=e["Data.Bounded"],i=e["Data.Enum"],l=e["Data.EuclideanRing"],s=e["Data.Functor"],u=e["Data.Maybe"],c=e["Data.String.CodeUnits"],d=e["Data.String.Unsafe"],v=e["Data.Tuple"],p=e["Data.Unfoldable"],m=e=>t=>65536+((1024*(e-55296|0)|0)+(t-56320|0)|0)|0,h=e=>56320<=e&&e<=57343,w=e=>55296<=e&&e<=56319,g=e=>{var t=c.length(e);if(0===t)return u.Nothing.value;if(1===t)return new u.Just({head:i.fromEnum(i.boundedEnumChar)(d.charAt(0)(e)),tail:""});var n=i.fromEnum(i.boundedEnumChar)(d.charAt(1)(e)),a=i.fromEnum(i.boundedEnumChar)(d.charAt(0)(e));return w(a)&&h(n)?new u.Just({head:m(a)(n),tail:c.drop(2)(e)}):new u.Just({head:a,tail:c.drop(1)(e)})},f=e=>s.map(u.functorMaybe)(e=>new v.Tuple(e.head,e.tail))(g(e)),b=a._unsafeCodePointAt0(e=>{var t=i.fromEnum(i.boundedEnumChar)(d.charAt(0)(e));if(w(t)&&c.length(e)>1){var n=i.fromEnum(i.boundedEnumChar)(d.charAt(1)(e));return h(n)?m(t)(n):t}return t}),y=a._toCodePointArray(e=>p.unfoldr(p.unfoldableArray)(f)(e))(b),D=(t=i.toEnumWithDefaults(i.boundedEnumChar)(r.bottom(r.boundedChar))(r.top(r.boundedChar)),e=>c.singleton(t(e))),S=a._singleton(e=>{if(e<=65535)return D(e);var t=l.div(l.euclideanRingInt)(e-65536|0)(1024)+55296|0,n=l.mod(l.euclideanRingInt)(e-65536|0)(1024)+56320|0;return D(t)+D(n)}),F=e=>t=>{if(e<1)return"";var n=g(t);return n instanceof u.Just?S(n.value0.head)+F(e-1|0)(n.value0.tail):t},P=a._take(F);n.indexOf=e=>t=>s.map(u.functorMaybe)(e=>(e=>o.length(y(e)))(c.take(e)(t)))(c.indexOf(e)(t)),n.drop=e=>t=>c.drop(c.length(P(e)(t)))(t)})(PS),(e=>{"use strict";(PS["Data.String.Common"]=PS["Data.String.Common"]||{}).joinWith=e=>t=>t.join(e)})(),(e=>{"use strict";e["Data.String.Common"]=e["Data.String.Common"]||{};var t=e["Data.String.Common"],n=e["Data.String.Common"];t.joinWith=n.joinWith})(PS),(e=>{"use strict";(PS["Data.Traversable"]=PS["Data.Traversable"]||{}).traverseArrayImpl=(()=>{function e(e){return[e]}function t(e){return t=>[e,t]}function n(e){return t=>n=>[e,t,n]}function a(e){return t=>e.concat(t)}return o=>r=>i=>l=>s=>{return function u(c,d){switch(d-c){case 0:return i([]);case 1:return r(e)(l(s[c]));case 2:return o(r(t)(l(s[c])))(l(s[c+1]));case 3:return o(o(r(n)(l(s[c])))(l(s[c+1])))(l(s[c+2]));default:var v=c+2*Math.floor((d-c)/4);return o(r(a)(u(c,v)))(u(v,d))}}(0,s.length)}})()})(),function(e){"use strict";e["Data.Traversable"]=e["Data.Traversable"]||{};var t=e["Data.Traversable"],n=e["Data.Traversable"],a=e["Control.Applicative"],o=e["Control.Apply"],r=e["Control.Category"],i=e["Data.Foldable"],l=e["Data.Functor"],s=new function(e,t,n,a){this.Foldable1=e,this.Functor0=t,this.sequence=n,this.traverse=a}(()=>i.foldableArray,()=>l.functorArray,e=>(e=>t=>(e=>e.traverse)(e)(t)(r.identity(r.categoryFn)))(s)(e),e=>n.traverseArrayImpl(o.apply(e.Apply0()))(l.map(e.Apply0().Functor0()))(a.pure(e)));t.sequence=e=>e.sequence,t.traversableArray=s}(PS),(e=>{"use strict";e.pureE=e=>()=>e,e.bindE=e=>t=>()=>t(e())()})(PS.Effect=PS.Effect||{}),(e=>{"use strict";e.Effect=e.Effect||{};var t=e.Effect,n=e.Effect,a=e["Control.Applicative"],o=e["Control.Apply"],r=e["Control.Bind"],i=e["Control.Monad"],l=e["Data.Functor"],s=new i.Monad(()=>d,()=>u),u=new r.Bind(()=>c,n.bindE),c=new o.Apply(()=>v,i.ap(s)),d=new a.Applicative(()=>c,n.pureE),v=new l.Functor(a.liftA1(d));t.applicativeEffect=d,t.bindEffect=u})(PS),(e=>{"use strict";e.unsafeToForeign=e=>e,e.unsafeFromForeign=e=>e,e.typeOf=e=>typeof e,e.tagOf=e=>Object.prototype.toString.call(e).slice(8,-1)})(PS.Foreign=PS.Foreign||{}),function(e){"use strict";e.Foreign=e.Foreign||{};var t,n=e.Foreign,a=e.Foreign,o=e["Control.Applicative"],r=e["Control.Monad.Error.Class"],i=e["Control.Monad.Except.Trans"],l=e["Data.Boolean"],s=e["Data.Identity"],u=e["Data.List.NonEmpty"],c=function(){function e(e,t){this.value0=e,this.value1=t}return e.create=t=>n=>new e(t,n),e}(),d=(t=r.throwError(i.monadThrowExceptT(s.monadIdentity)),e=>t(u.singleton(e))),v=e=>t=>{if(a.tagOf(t)===e)return o.pure(i.applicativeExceptT(s.monadIdentity))(a.unsafeFromForeign(t));if(l.otherwise)return d(new c(e,a.tagOf(t)));throw new Error("Failed pattern match at Foreign (line 106, column 1 - line 106, column 55): "+[e.constructor.name,t.constructor.name])},p=v("Boolean"),m=v("Number"),h=v("String");n.TypeMismatch=c,n.readString=h,n.readBoolean=p,n.readNumber=m,n.fail=d,n.unsafeToForeign=a.unsafeToForeign,n.typeOf=a.typeOf}(PS),(e=>{"use strict";(PS["Foreign.Index"]=PS["Foreign.Index"]||{}).unsafeReadPropImpl=(e,t,n,a)=>null==a?e:t(a[n])})(),(e=>{"use strict";e["Foreign.Index"]=e["Foreign.Index"]||{};var t=e["Foreign.Index"],n=e["Foreign.Index"],a=e["Control.Applicative"],o=e["Control.Monad.Except.Trans"],r=e["Data.Identity"],i=e.Foreign,l=e=>t=>n.unsafeReadPropImpl(i.fail(new i.TypeMismatch("object",i.typeOf(t))),a.pure(o.applicativeExceptT(r.monadIdentity)),e,t);t.readProp=l})(PS),(e=>{"use strict";e.Run=e.Run||{};var t=e.Run,n=e["Control.Applicative"],a=e["Control.Bind"],o=e["Control.Monad.Free"],r=e["Control.Monad.Rec.Class"],i=e["Data.Functor"],l=e["Data.Functor.Variant"],s=e["Data.Newtype"],u=e=>e,c=new s.Newtype(e=>e,u),d=o.freeMonad,v=o.freeFunctor,p=o.freeBind,m=o.freeApply,h=o.freeApplicative,w=new r.MonadRec(()=>d,e=>{var t=o=>a.bind(p)(e(o))(e=>{if(e instanceof r.Done)return n.pure(h)(e.value0);if(e instanceof r.Loop)return t(e.value0);throw new Error("Failed pattern match at Run (line 108, column 7 - line 110, column 24): "+[e.constructor.name])});return t});t.Run=u,t.lift=e=>e=>t=>n=>{var a=l.inj()(e)(t)(n);return e=>u(o.liftF(a(e)))},t.runCont=e=>t=>{var n=(e=>t=>{var n=o["resume'"](t=>n=>e(i.map(l.functorVariantF)(e=>u(n(e)))(t)))(t),a=s.unwrap(c);return e=>n(a(e))})(t=>e(i.map(l.functorVariantF)(n)(t)))(t);return n},t.functorRun=v,t.applyRun=m,t.applicativeRun=h,t.bindRun=p,t.monadRun=d,t.monadRecRun=w})(PS),function(e){"use strict";e["Pha.Action"]=e["Pha.Action"]||{};var t=e["Pha.Action"],n=e["Control.Category"],a=e["Data.Functor"],o=e["Data.Symbol"],r=e["Data.Unit"],i=e.Run,l=function(){function e(e,t){this.value0=e,this.value1=t}return e.create=t=>n=>new e(t,n),e}(),s=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),u=new a.Functor(e=>t=>new l(t.value0,e(t.value1))),c=new a.Functor(e=>t=>new s(a.map(a.functorFn)(e)(t.value0))),d=i.lift()(new o.IsSymbol(()=>"getState"))(c)(o.SProxy.value)(new s(n.identity(n.categoryFn)));t.getState=d,t.setState=e=>i.lift()(new o.IsSymbol(()=>"setState"))(u)(o.SProxy.value)(new l(e,r.unit)),t.GetState=s,t.SetState=l,t.functorGetState=c,t.functorSetState=u}(PS),(PS["Pha.Effects.Delay"]=PS["Pha.Effects.Delay"]||{}).setTimeout=e=>t=>()=>setTimeout(t,e),function(e){"use strict";e["Pha.Effects.Delay"]=e["Pha.Effects.Delay"]||{};var t=e["Pha.Effects.Delay"],n=e["Pha.Effects.Delay"],a=e["Data.Functor"],o=e["Data.Symbol"],r=e["Data.Unit"],i=e.Run,l=function(){function e(e,t){this.value0=e,this.value1=t}return e.create=t=>n=>new e(t,n),e}(),s=new a.Functor(e=>t=>new l(t.value0,e(t.value1))),u=o.SProxy.value;t.delay=e=>i.lift()(new o.IsSymbol(()=>"delay"))(s)(u)(new l(e,r.unit)),t.interpretDelay=e=>n.setTimeout(e.value0)(e.value1)}(PS),(PS["Pha.Effects.Random"]=PS["Pha.Effects.Random"]||{}).mathRandom=Math.random,function(e){"use strict";e["Pha.Effects.Random"]=e["Pha.Effects.Random"]||{};var t=e["Pha.Effects.Random"],n=e["Pha.Effects.Random"],a=e["Control.Applicative"],o=e["Control.Bind"],r=e["Control.Category"],i=e["Data.Array"],l=e["Data.Eq"],s=e["Data.Foldable"],u=e["Data.Functor"],c=e["Data.Int"],d=e["Data.Maybe"],v=e["Data.Symbol"],p=e["Data.Traversable"],m=e["Data.Tuple"],h=e.Effect,w=e.Run,g=function(){function e(e,t){this.value0=e,this.value1=t}return e.create=t=>n=>new e(t,n),e}(),f=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),b=new u.Functor(e=>t=>{if(t instanceof g)return new g(t.value0,u.map(u.functorFn)(e)(t.value1));if(t instanceof f)return new f(u.map(u.functorFn)(e)(t.value0));throw new Error("Failed pattern match at Pha.Effects.Random (line 13, column 1 - line 13, column 41): "+[t.constructor.name])}),y=v.SProxy.value,D=e=>w.lift()(new v.IsSymbol(()=>"rng"))(b)(y)(new g(e,r.identity(r.categoryFn))),S=u.mapFlipped(w.functorRun)(D(2))(l.eq(l.eqInt)(0));t.randomInt=D,t.randomBool=S,t.shuffle=e=>o.bind(w.bindRun)(p.sequence(p.traversableArray)(w.applicativeRun)(i.mapWithIndex(e=>t=>u.map(w.functorRun)(m.Tuple.create(t))(D(e+1|0)))(e)))(e=>a.pure(w.applicativeRun)(s.foldl(s.foldableArray)(e=>t=>d.fromMaybe([])(i.insertAt(t.value1)(t.value0)(e)))([])(e))),t.sample=e=>u.map(w.functorRun)(i.index(e))(D(i.length(e))),t.interpretRng=e=>{if(e instanceof g)return function(){var t=n.mathRandom();return e.value1(c.floor(t*c.toNumber(e.value0)))()};if(e instanceof f)return o.bind(h.bindEffect)(n.mathRandom)(e.value0);throw new Error("Failed pattern match at Pha.Effects.Random (line 42, column 1 - line 42, column 48): "+[e.constructor.name])}}(PS),function(e){"use strict";e["Game.Core"]=e["Game.Core"]||{};var t=e["Game.Core"],n=e["Control.Applicative"],a=e["Control.Apply"],o=e["Control.Bind"],r=e["Control.Category"],i=e["Control.Monad"],l=e["Data.Eq"],s=e["Data.Foldable"],u=e["Data.Function"],c=e["Data.Functor"],d=e["Data.HeytingAlgebra"],v=e["Data.Lens.At"],p=e["Data.Lens.Getter"],m=e["Data.Lens.Internal.Forget"],h=e["Data.Lens.Lens"],w=e["Data.Lens.Setter"],g=e["Data.List"],f=e["Data.List.Types"],b=e["Data.Map.Internal"],y=e["Data.Maybe"],D=e["Data.Ord"],S=e["Data.Profunctor.Strong"],F=e["Data.Tuple"],P=e["Data.Unit"],C=e["Pha.Action"],I=e["Pha.Effects.Delay"],M=e["Pha.Effects.Random"],x=e.Run,A=(()=>{function e(){}return e.value=new e,e})(),_=(()=>{function e(){}return e.value=new e,e})(),G=function(){function e(e,t,n,a){this.value0=e,this.value1=t,this.value2=n,this.value3=a}return e.create=t=>n=>a=>o=>new e(t,n,a,o),e}(),T=(()=>{function e(){}return e.value=new e,e})(),O=(()=>{function e(){}return e.value=new e,e})(),E=(()=>{function e(){}return e.value=new e,e})(),N=(()=>{function e(){}return e.value=new e,e})(),R=(()=>{function e(){}return e.value=new e,e})(),L=(()=>{function e(){}return e.value=new e,e})(),q=(()=>{function e(){}return e.value=new e,e})(),k=(()=>{function e(){}return e.value=new e,e})(),U=(()=>{function e(){}return e.value=new e,e})(),B=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),J=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),W=(()=>{function e(){}return e.value=new e,e})(),z=(()=>{function e(){}return e.value=new e,e})(),j=(()=>{function e(){}return e.value=new e,e})(),V=(()=>{function e(){}return e.value=new e,e})(),H=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),Q=(()=>{function e(){}return e.value=new e,e})(),K=(()=>{function e(){}return e.value=new e,e})(),Z=function(){function e(e,t){this.value0=e,this.value1=t}return e.create=t=>n=>new e(t,n),e}(),X=(()=>{function e(){}return e.value=new e,e})(),Y=(()=>{function e(){}return e.value=new e,e})(),$=(()=>{function e(){}return e.value=new e,e})(),ee=(()=>{function e(){}return e.value=new e,e})(),te=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),ne=function(){function e(e,t,n){this.value0=e,this.value1=t,this.value2=n}return e.create=t=>n=>a=>new e(t,n,a),e}(),ae=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),oe=(()=>{function e(){}return e.value=new e,e})(),re=(()=>{function e(){}return e.value=new e,e})(),ie=(()=>{function e(){}return e.value=new e,e})(),le=(()=>{function e(){}return e.value=new e,e})(),se=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),ue=(()=>{function e(){}return e.value=new e,e})(),ce=(()=>{function e(){}return e.value=new e,e})(),de=e=>e.sizeLimit,ve=e=>e.scoreFn,pe=e=>e.possibleMoves,me=e=>e.play,he=e=>e instanceof A?_.value:A.value,we=e=>e.isLevelFinished,ge=e=>t=>{return(e=>e.isCustomGame)(e)(t)?"custom":(e=>e.scoreHash)(e)(t)},fe=new l.Eq(e=>t=>e instanceof A&&t instanceof A||e instanceof _&&t instanceof _),be=new l.Eq(e=>t=>e instanceof T&&t instanceof T||(e instanceof O&&t instanceof O||e instanceof E&&t instanceof E)),ye=new l.Eq(e=>t=>e instanceof N&&t instanceof N||e instanceof R&&t instanceof R),De=new l.Eq(e=>t=>e instanceof L&&t instanceof L||(e instanceof q&&t instanceof q||(e instanceof k&&t instanceof k||e instanceof U&&t instanceof U))),Se=n.pure(x.applicativeRun),Fe=e=>h.lens(e=>e.value0)(e=>t=>new Z(t,e.value1))(e),Pe=e=>{var t=Fe(e),n=h.lens(e=>e.customSize)(e=>t=>({customSize:t,dialog:e.dialog,help:e.help,history:e.history,locked:e.locked,mode:e.mode,nbColumns:e.nbColumns,nbRows:e.nbRows,pointer:e.pointer,position:e.position,redoHistory:e.redoHistory,scores:e.scores,showWin:e.showWin,turn:e.turn}))(e);return e=>t(n(e))},Ce=e=>{var t=Fe(e),n=h.lens(e=>e.dialog)(e=>t=>({dialog:t,customSize:e.customSize,help:e.help,history:e.history,locked:e.locked,mode:e.mode,nbColumns:e.nbColumns,nbRows:e.nbRows,pointer:e.pointer,position:e.position,redoHistory:e.redoHistory,scores:e.scores,showWin:e.showWin,turn:e.turn}))(e);return e=>t(n(e))},Ie=e=>{var t=Fe(e),n=h.lens(e=>e.help)(e=>t=>({help:t,customSize:e.customSize,dialog:e.dialog,history:e.history,locked:e.locked,mode:e.mode,nbColumns:e.nbColumns,nbRows:e.nbRows,pointer:e.pointer,position:e.position,redoHistory:e.redoHistory,scores:e.scores,showWin:e.showWin,turn:e.turn}))(e);return e=>t(n(e))},Me=e=>{var t=Fe(e),n=h.lens(e=>e.history)(e=>t=>({history:t,customSize:e.customSize,dialog:e.dialog,help:e.help,locked:e.locked,mode:e.mode,nbColumns:e.nbColumns,nbRows:e.nbRows,pointer:e.pointer,position:e.position,redoHistory:e.redoHistory,scores:e.scores,showWin:e.showWin,turn:e.turn}))(e);return e=>t(n(e))},xe=e=>{var t=Fe(e),n=h.lens(e=>e.locked)(e=>t=>({locked:t,customSize:e.customSize,dialog:e.dialog,help:e.help,history:e.history,mode:e.mode,nbColumns:e.nbColumns,nbRows:e.nbRows,pointer:e.pointer,position:e.position,redoHistory:e.redoHistory,scores:e.scores,showWin:e.showWin,turn:e.turn}))(e);return e=>t(n(e))},Ae=e=>i.unlessM(x.monadRun)(c.map(x.functorRun)(p.view(xe(m.strongForget)))(C.getState))(o.discard(o.discardUnit)(x.bindRun)(C.setState(w.set(xe(S.strongFn))(!0)))(()=>o.discard(o.discardUnit)(x.bindRun)(e)(()=>C.setState(w.set(xe(S.strongFn))(!1))))),_e=e=>{var t=Fe(e),n=h.lens(e=>e.mode)(e=>t=>({mode:t,customSize:e.customSize,dialog:e.dialog,help:e.help,history:e.history,locked:e.locked,nbColumns:e.nbColumns,nbRows:e.nbRows,pointer:e.pointer,position:e.position,redoHistory:e.redoHistory,scores:e.scores,showWin:e.showWin,turn:e.turn}))(e);return e=>t(n(e))},Ge=e=>{var t=Fe(e),n=h.lens(e=>e.nbColumns)(e=>t=>({nbColumns:t,customSize:e.customSize,dialog:e.dialog,help:e.help,history:e.history,locked:e.locked,mode:e.mode,nbRows:e.nbRows,pointer:e.pointer,position:e.position,redoHistory:e.redoHistory,scores:e.scores,showWin:e.showWin,turn:e.turn}))(e);return e=>t(n(e))},Te=e=>{var t=Fe(e),n=h.lens(e=>e.nbRows)(e=>t=>({nbRows:t,customSize:e.customSize,dialog:e.dialog,help:e.help,history:e.history,locked:e.locked,mode:e.mode,nbColumns:e.nbColumns,pointer:e.pointer,position:e.position,redoHistory:e.redoHistory,scores:e.scores,showWin:e.showWin,turn:e.turn}))(e);return e=>t(n(e))},Oe=e=>{var t=Fe(e),n=h.lens(e=>e.pointer)(e=>t=>({pointer:t,customSize:e.customSize,dialog:e.dialog,help:e.help,history:e.history,locked:e.locked,mode:e.mode,nbColumns:e.nbColumns,nbRows:e.nbRows,position:e.position,redoHistory:e.redoHistory,scores:e.scores,showWin:e.showWin,turn:e.turn}))(e);return e=>t(n(e))},Ee=e=>{var t=Fe(e),n=h.lens(e=>e.position)(e=>t=>({position:t,customSize:e.customSize,dialog:e.dialog,help:e.help,history:e.history,locked:e.locked,mode:e.mode,nbColumns:e.nbColumns,nbRows:e.nbRows,pointer:e.pointer,redoHistory:e.redoHistory,scores:e.scores,showWin:e.showWin,turn:e.turn}))(e);return e=>t(n(e))},Ne=e=>{var t=Fe(e),n=h.lens(e=>e.redoHistory)(e=>t=>({redoHistory:t,customSize:e.customSize,dialog:e.dialog,help:e.help,history:e.history,locked:e.locked,mode:e.mode,nbColumns:e.nbColumns,nbRows:e.nbRows,pointer:e.pointer,position:e.position,scores:e.scores,showWin:e.showWin,turn:e.turn}))(e);return e=>t(n(e))},Re=e=>w.set(Ne(S.strongFn))(f.Nil.value)(w.over(Me(S.strongFn))(f.Cons.create(p.viewOn(e)(Ee(m.strongForget))))(e)),Le=e=>{var t=Fe(e),n=h.lens(e=>e.scores)(e=>t=>({scores:t,customSize:e.customSize,dialog:e.dialog,help:e.help,history:e.history,locked:e.locked,mode:e.mode,nbColumns:e.nbColumns,nbRows:e.nbRows,pointer:e.pointer,position:e.position,redoHistory:e.redoHistory,showWin:e.showWin,turn:e.turn}))(e);return e=>t(n(e))},qe=e=>t=>{return p.viewOn(t)((n=Le(m.strongForget),a=v.at(v.atMap(D.ordString))(ge(e)(t))(m.strongForget),e=>n(a(e))));var n,a},ke=e=>t=>o.bind(x.bindRun)(C.getState)(n=>{var a=t(n);return o.bind(x.bindRun)((e=>e.onNewGame)(e)(a))(t=>o.bind(x.bindRun)((e=>e.initialPosition)(e)(t))(o=>{var r,i,l=w.set((r=Le(S.strongFn),i=v.at(v.atMap(D.ordString))("custom")(S.strongFn),e=>r(i(e))))(y.Nothing.value)(w.set(Ie(S.strongFn))(!1)(w.set(Ne(S.strongFn))(f.Nil.value)(w.set(Me(S.strongFn))(f.Nil.value)(w.set(Ee(S.strongFn))(o)(t)))));return C.setState(g.null(p.viewOn(a)(Me(m.strongForget)))||we(e)(n)?u.const(l):w.set(Ce(S.strongFn))(new H(l)))}))}),Ue=e=>{var t=Fe(e),n=h.lens(e=>e.showWin)(e=>t=>({showWin:t,customSize:e.customSize,dialog:e.dialog,help:e.help,history:e.history,locked:e.locked,mode:e.mode,nbColumns:e.nbColumns,nbRows:e.nbRows,pointer:e.pointer,position:e.position,redoHistory:e.redoHistory,scores:e.scores,turn:e.turn}))(e);return e=>t(n(e))},Be=o.discard(o.discardUnit)(x.bindRun)(C.setState(w.set(Ue(S.strongFn))(!0)))(()=>o.discard(o.discardUnit)(x.bindRun)(I.delay(1e3))(()=>C.setState(w.set(Ue(S.strongFn))(!1)))),Je=e=>{var t=Fe(e),n=h.lens(e=>e.turn)(e=>t=>({turn:t,customSize:e.customSize,dialog:e.dialog,help:e.help,history:e.history,locked:e.locked,mode:e.mode,nbColumns:e.nbColumns,nbRows:e.nbRows,pointer:e.pointer,position:e.position,redoHistory:e.redoHistory,scores:e.scores,showWin:e.showWin}))(e);return e=>t(n(e))},We=e=>w.over(Je(S.strongFn))(t=>{return l.eq(De)(p.viewOn(e)(_e(m.strongForget)))(U.value)?he(t):A.value})(e),ze=e=>t=>n=>c.mapFlipped(y.functorMaybe)(me(e)(n)(t))(e=>w.over(Je(S.strongFn))(he)(w.set(Ee(S.strongFn))(e)(n))),je=e=>o.bind(x.bindRun)(C.getState)(t=>o.bind(x.bindRun)((e=>e.computerMove)(e)(t))(a=>{var r=o.bindFlipped(y.bindMaybe)(u.flip(ze(e))(t))(a);if(r instanceof y.Nothing)return n.pure(x.applicativeRun)(P.unit);if(r instanceof y.Just)return o.discard(o.discardUnit)(x.bindRun)(C.setState(u.const(r.value0)))(()=>n.when(x.applicativeRun)(we(e)(r.value0))(Be));throw new Error("Failed pattern match at Game.Core (line 224, column 5 - line 228, column 51): "+[r.constructor.name])})),Ve=e=>t=>Ae(o.bind(x.bindRun)(C.getState)(r=>{var i=ze(e)(t)(Re(r));if(i instanceof y.Nothing)return n.pure(x.applicativeRun)(P.unit);if(i instanceof y.Just)return o.discard(o.discardUnit)(x.bindRun)(C.setState(e=>i.value0))(()=>{if(we(e)(i.value0)){var t=(e=>e.updateScore)(e)(i.value0);return o.discard(o.discardUnit)(x.bindRun)(C.setState(e=>t.value0))(()=>n.when(x.applicativeRun)(t.value1)(Be))}return l.eq(De)(p.viewOn(i.value0)(_e(m.strongForget)))(k.value)||l.eq(De)(p.viewOn(i.value0)(_e(m.strongForget)))(q.value)?a.applySecond(x.applyRun)(I.delay(1e3))(je(e)):n.pure(x.applicativeRun)(P.unit)});throw new Error("Failed pattern match at Game.Core (line 233, column 5 - line 244, column 26): "+[i.constructor.name])}));t.core=e=>e.core,t.dndmsg=e=>e.dndmsg,t.isLevelFinished=we,t.possibleMoves=pe,t.scoreFn=ve,t.sizeLimit=de,t.Rules=j,t.ConfirmNewGameDialog=H,t.ScoreDialog=Q,t.CustomDialog=K,t.RandomMode=q,t.ExpertMode=k,t.DuelMode=U,t.Turn1=A,t.Turn2=_,t.genState=e=>t=>n=>new Z(t((e=>({position:e,history:f.Nil.value,redoHistory:f.Nil.value,dialog:j.value,turn:A.value,nbRows:0,nbColumns:0,customSize:!1,help:!1,mode:L.value,locked:!1,showWin:!1,scores:b.empty,pointer:y.Nothing.value}))(e)),n),t._ext=e=>h.lens(e=>e.value1)(e=>t=>new Z(e.value0,t))(e),t._position=Ee,t._history=Me,t._redoHistory=Ne,t._mode=_e,t._help=Ie,t._turn=Je,t._dialog=Ce,t._nbRows=Te,t._nbColumns=Ge,t._customSize=Pe,t._locked=xe,t._showWin=Ue,t._pointer=Oe,t.SizeLimit=G,t.Game=function(e,t,n,a,o,r,i){this.computerMove=e,this.initialPosition=t,this.isLevelFinished=n,this.onNewGame=a,this.play=o,this.sizeLimit=r,this.updateScore=i},t.canPlay=e=>t=>n=>y.isJust(me(e)(t)(n)),t.defaultSizeLimit=e=>new G(0,0,0,0),t.defaultOnNewGame=Se,t.Undo=X,t.Redo=Y,t.Reset=$,t.ToggleHelp=ee,t.SetMode=te,t.SetGridSize=ne,t.SetCustomSize=ae,t.SetNoDialog=oe,t.SetRulesDialog=re,t.SetScoreDialog=ie,t.ConfirmNewGame=le,t.SetPointer=se,t.ComputerStarts=ue,t.Init=ce,t.MsgWithCore=function(e){this.core=e},t.coreUpdate=e=>t=>{if(t instanceof X)return C.setState(e=>{var t=p.viewOn(e)(Me(m.strongForget));if(t instanceof f.Nil)return e;if(t instanceof f.Cons)return w.over(Ne(S.strongFn))(f.Cons.create(p.viewOn(e)(Ee(m.strongForget))))(w.set(Me(S.strongFn))(t.value1)(w.set(Ee(S.strongFn))(t.value0)(We(e))));throw new Error("Failed pattern match at Game.Core (line 159, column 38 - line 165, column 56): "+[t.constructor.name])});if(t instanceof Y)return C.setState(e=>{var t=p.viewOn(e)(Ne(m.strongForget));if(t instanceof f.Nil)return e;if(t instanceof f.Cons)return w.over(Me(S.strongFn))(f.Cons.create(p.viewOn(e)(Ee(m.strongForget))))(w.set(Ne(S.strongFn))(t.value1)(w.set(Ee(S.strongFn))(t.value0)(We(e))));throw new Error("Failed pattern match at Game.Core (line 167, column 38 - line 173, column 52): "+[t.constructor.name])});if(t instanceof $)return C.setState(e=>{var t=g.last(p.viewOn(e)(Me(m.strongForget)));if(t instanceof y.Nothing)return e;if(t instanceof y.Just)return w.set(Je(S.strongFn))(A.value)(w.set(Ne(S.strongFn))(f.Nil.value)(w.set(Me(S.strongFn))(f.Nil.value)(w.set(Ee(S.strongFn))(t.value0)(e))));throw new Error("Failed pattern match at Game.Core (line 175, column 39 - line 180, column 37): "+[t.constructor.name])});if(t instanceof ee)return C.setState(w.over(Ie(S.strongFn))(d.not(d.heytingAlgebraBoolean)));if(t instanceof te)return ke(e)(w.set(_e(S.strongFn))(t.value0));if(t instanceof ne){return ke(e)((n=w.set(Pe(S.strongFn))(t.value2),a=>{return o=n(a),r=de(e)(o),t.value0>=r.value0&&t.value0<=r.value2&&t.value1>=r.value1&&t.value1<=r.value3?w.set(Ge(S.strongFn))(t.value1)(w.set(Te(S.strongFn))(t.value0)(o)):o;var o,r}))}var n,o;if(t instanceof ae)return C.setState(w.set(Pe(S.strongFn))(!0));if(t instanceof oe)return C.setState(w.set(Ce(S.strongFn))(V.value));if(t instanceof re)return C.setState(w.set(Ce(S.strongFn))(j.value));if(t instanceof ie)return C.setState(w.set(Ce(S.strongFn))(Q.value));if(t instanceof le)return C.setState(e=>{var t=p.viewOn(e)(Ce(m.strongForget));return t instanceof H?t.value0:e});if(t instanceof se)return C.setState(w.set(Oe(S.strongFn))(t.value0));if(t instanceof ue)return a.applySecond(x.applyRun)(C.setState((o=w.over(Je(S.strongFn))(he),e=>Re(o(e)))))(je(e));if(t instanceof ce)return ke(e)(r.identity(r.categoryFn));throw new Error("Failed pattern match at Game.Core (line 158, column 1 - line 158, column 88): "+[t.constructor.name])},t.playA=Ve,t.lockAction=Ae,t.newGame=ke,t.TwoPlayersGame=function(e,t,n){this.Game0=e,this.isLosingPosition=t,this.possibleMoves=n},t["computerMove'"]=e=>t=>{if(we(e.Game0())(t))return n.pure(x.applicativeRun)(y.Nothing.value);var a,o,r=pe(e)(t),i=l.eq(De)(p.viewOn(t)(_e(m.strongForget)))(q.value)?y.Nothing.value:s.find(s.foldableArray)((a=y.maybe(!1)((e=>e.isLosingPosition)(e)),o=u.flip(ze(e.Game0()))(t),e=>a(o(e))))(r);if(i instanceof y.Just)return n.pure(x.applicativeRun)(i);if(i instanceof y.Nothing)return M.sample(r);throw new Error("Failed pattern match at Game.Core (line 290, column 13 - line 292, column 40): "+[i.constructor.name])},t.Minimize=N,t.Maximize=R,t.AlwaysShowWin=T,t.NeverShowWin=O,t.ShowWinOnNewRecord=E,t.ScoreGame=function(e,t,n,a,o){this.Game0=e,this.isCustomGame=t,this.objective=n,this.scoreFn=a,this.scoreHash=o},t["updateScore'"]=e=>t=>n=>{var a,o,i,s=ve(e)(n),u=qe(e)(n),c=ge(e)(n),d=l.eq(ye)((e=>e.objective)(e)(n))(N.value)?D.lessThan(D.ordInt):D.greaterThan(D.ordInt),h=y.maybe(!0)((a=d(s),e=>a(F.fst(e))))(u),g=h&&l.eq(be)(t)(E.value)||l.eq(be)(t)(T.value),f=w.over((o=Le(S.strongFn),i=v.at(v.atMap(D.ordString))(c)(S.strongFn),e=>o(i(e))))((()=>h?e=>new y.Just(new F.Tuple(s,p.viewOn(n)(Ee(m.strongForget)))):r.identity(r.categoryFn))())(n);return new F.Tuple(f,g)},t.bestScore=qe,t.Drag=B,t.Drop=J,t.Leave=W,t.DropOnBoard=z,t.MsgWithDnd=function(e){this.dndmsg=e},t.dndUpdate=e=>t=>a=>r=>{if(r instanceof B)return C.setState(w.set(a(S.strongFn))(new y.Just(r.value0)));if(r instanceof J)return(e=>t=>a=>r=>o.bind(x.bindRun)(C.getState)(i=>{var s=p.viewOn(i)(a(m.strongForget));if(s instanceof y.Nothing)return n.pure(x.applicativeRun)(P.unit);if(s instanceof y.Just)return o.discard(o.discardUnit)(x.bindRun)(C.setState(w.set(a(S.strongFn))(y.Nothing.value)))(()=>{return l.notEq(e)(s.value0)(r)?Ve(t)({from:s.value0,to:r}):n.pure(x.applicativeRun)(P.unit)});throw new Error("Failed pattern match at Game.Core (line 338, column 5 - line 342, column 71): "+[s.constructor.name])}))(e)(t)(e=>a(e))(r.value0);if(r instanceof W)return C.setState(w.set(a(S.strongFn))(y.Nothing.value));if(r instanceof z)return C.setState(w.set(a(S.strongFn))(y.Nothing.value));throw new Error("Failed pattern match at Game.Core (line 327, column 1 - line 328, column 81): "+[a.constructor.name,r.constructor.name])},t.eqMode=De,t.eqTurn=fe}(PS),(e=>{"use strict";(PS["Record.Unsafe.Union"]=PS["Record.Unsafe.Union"]||{}).unsafeUnionFn=(e,t)=>{var n={};for(var a in t)({}).hasOwnProperty.call(t,a)&&(n[a]=t[a]);for(var o in e)({}).hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}})(),(e=>{"use strict";e["Record.Unsafe.Union"]=e["Record.Unsafe.Union"]||{};var t=e["Record.Unsafe.Union"],n=e["Record.Unsafe.Union"];t.unsafeUnionFn=n.unsafeUnionFn})(PS),(e=>{"use strict";e.Record=e.Record||{};var t=e.Record,n=e["Record.Unsafe.Union"];t.merge=e=>e=>e=>t=>n.unsafeUnionFn(e,t)})(PS),function(e){"use strict";e["Lib.Util"]=e["Lib.Util"]||{};var t=e["Lib.Util"],n=e["Control.Bind"],a=e["Data.Array"],o=e["Data.EuclideanRing"],r=e["Data.Function"],i=e["Data.Functor"],l=e["Data.Int"],s=e["Data.Maybe"],u=e["Data.Ord"],c=e.Record,d=function(e){this.partialUpdate=e},v=e=>t=>{return e>t?[]:a.range(e)(t)},p=e=>t=>i.mapFlipped(i.functorArray)(v(0)(e-1|0))(t),m=e=>t=>({row:o.div(o.euclideanRingInt)(t)(e),col:o.mod(o.euclideanRingInt)(t)(e)});t.partialUpdate=e=>e.partialUpdate,t.abs=e=>{return e<0?0|-e:e},t["range'"]=v,t.tabulate=p,t.tabulate2=e=>t=>n=>p(e*t|0)(e=>n(o.div(o.euclideanRingInt)(e)(t))(o.mod(o.euclideanRingInt)(e)(t))),t.map2=e=>t=>n=>a.zipWith(r.apply)(a.mapWithIndex(n)(e))(t),t.map3=e=>t=>n=>o=>a.zipWith(r.apply)(a.zipWith(r.apply)(a.mapWithIndex(o)(e))(t))(n),t.rangeStep=e=>t=>n=>p(u.max(u.ordInt)(0)(1+o.div(o.euclideanRingInt)(t-e|0)(n)|0))(t=>e+(t*n|0)|0),t.floatRange=e=>t=>n=>p(u.max(u.ordInt)(0)(l.floor(1+(t-e)/n)))(t=>e+l.toNumber(t)*n),t.pairwise=e=>s.maybe([])(a.zip(e))(a.tail(e)),t.swap=e=>t=>o=>n.bind(s.bindMaybe)(a.index(o)(e))(r=>n.bind(s.bindMaybe)(a.index(o)(t))(i=>n.bind(s.bindMaybe)(a.updateAt(e)(i)(o))(a.updateAt(t)(r)))),t.coords=m,t.dCoords=e=>t=>n=>{var a=m(e)(n),o=m(e)(t);return{row:o.row-a.row|0,col:o.col-a.col|0}},t.precord=e=>e=>new d(c.merge()())}(PS),function(e){"use strict";e["Game.Baseball.Model"]=e["Game.Baseball.Model"]||{};var t=e["Game.Baseball.Model"],n=e["Control.Applicative"],a=e["Control.Bind"],o=e["Control.Category"],r=e["Data.Array"],i=e["Data.Eq"],l=e["Data.EuclideanRing"],s=e["Data.Foldable"],u=e["Data.FoldableWithIndex"],c=e["Data.Functor"],d=e["Data.HeytingAlgebra"],v=e["Data.Lens.Getter"],p=e["Data.Lens.Internal.Forget"],m=e["Data.Lens.Iso"],h=e["Data.Lens.Lens"],w=e["Data.Lens.Setter"],g=e["Data.Maybe"],f=e["Data.Profunctor.Strong"],b=e["Data.Tuple"],y=e["Game.Core"],D=e["Lib.Util"],S=e["Pha.Effects.Random"],F=e.Run,P=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),C=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),I=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),M=e=>e,x=new y.MsgWithCore(P.create),A=y.genState([])(o.identity(o.categoryFn))({nbBases:5,missingPeg:0}),_=e=>{var t=y._ext(e),n=m.iso(e=>e)(M)(e.Profunctor0());return e=>t(n(e))},G=e=>{var t=_(e),n=h.lens(e=>e.missingPeg)(e=>t=>({missingPeg:t,nbBases:e.nbBases}))(e);return e=>t(n(e))},T=e=>{var t=_(e),n=h.lens(e=>e.nbBases)(e=>t=>({nbBases:t,missingPeg:e.missingPeg}))(e);return e=>t(n(e))},O=new y.Game(e=>n.pure(F.applicativeRun)(g.Nothing.value),e=>S.shuffle(D["range'"](0)((2*v.viewOn(e)(T(p.strongForget))|0)-1|0)),e=>u.allWithIndex(u.foldableWithIndexArray)(d.heytingAlgebraBoolean)(e=>t=>l.div(l.euclideanRingInt)(e)(2)===l.div(l.euclideanRingInt)(t)(2))(v.viewOn(e)(y._position(p.strongForget))),e=>c.mapFlipped(F.functorRun)(S.randomInt(2*v.viewOn(e)(T(p.strongForget))|0))(t=>w.set(G(f.strongFn))(t)(e)),e=>t=>{var n=v.viewOn(e)(y._position(p.strongForget)),o=v.viewOn(e)(T(p.strongForget)),u=v.viewOn(e)(G(p.strongForget));return a.bind(g.bindMaybe)(r.index(n)(t))(e=>a.bind(g.bindMaybe)(r.index(n)(u))(a=>{return s.elem(s.foldableArray)(i.eqInt)(l.div(l.euclideanRingInt)(e)(2)-l.div(l.euclideanRingInt)(a)(2)|0)([1,o-1|0,-1,1-o|0])?g.Just.create(r.updateAtIndices(s.foldableArray)([new b.Tuple(t,a),new b.Tuple(u,e)])(n)):g.Nothing.value}))},y.defaultSizeLimit,e=>new b.Tuple(e,!0));t._nbBases=T,t._missingPeg=G,t.istate=A,t.SetNbBases=C,t.Play=I,t.update=e=>{if(e instanceof P)return y.coreUpdate(O)(e.value0);if(e instanceof C)return y.newGame(O)(w.set(T(f.strongFn))(e.value0));if(e instanceof I)return y.playA(O)(e.value0);throw new Error("Failed pattern match at Game.Baseball.Model (line 51, column 1 - line 51, column 35): "+[e.constructor.name])},t.baseballGame=O,t.withcore=x}(PS),(e=>{const t=(e,t)=>e&&t?n=>e(t(n)):e||t;e.mapView=e=>n=>Object.assign({},n,{mapf:t(n.mapf,e)}),e.emptyNode=null,e.key=e=>[0,e],e.attr=e=>t=>[1,e,t],e.class_=e=>[2,e],e.noProp=[-1],e.unsafeOnWithEffect=e=>t=>[1,e,t],e.style=e=>t=>[3,e,t],e.h=e=>t=>n=>{const a={},o={style:a},r={name:e,children:n.filter(e=>e),props:o,node:null},i=t.length;for(let e=0;e<i;e++){const[n,i,l]=t[e];0===n?r.key=i:1==n?o[i]=l:2===n?o.class=(o.class?o.class+" ":"")+i:3===n&&(a[i]=l)}return r},e.text=e=>({name:e,props:{},children:[],type:3})})(PS.Pha=PS.Pha||{}),(e=>{"use strict";e.Pha=e.Pha||{};var t=e.Pha,n=e.Pha,a=e["Control.Applicative"],o=e["Data.Functor"],r=e["Data.Maybe"],i=e["Data.Unit"],l=e.Effect,s=r.fromMaybe(n.emptyNode),u=new o.Functor(e=>{return n.mapView(t=>n=>{var a=t(n);return{effect:a.effect,msg:o.map(r.functorMaybe)(e)(a.msg)}})});t.on_=e=>t=>n.unsafeOnWithEffect(e)(e=>({effect:a.pure(l.applicativeEffect)(i.unit),msg:t(e)})),t["class'"]=e=>t=>t?n.class_(e):n.noProp,t.when=e=>t=>e?t(i.unit):n.emptyNode,t.maybeN=s,t.maybe=e=>t=>{if(e instanceof r.Just)return t(e.value0);if(e instanceof r.Nothing)return n.emptyNode;throw new Error("Failed pattern match at Pha (line 77, column 1 - line 77, column 52): "+[e.constructor.name,t.constructor.name])},t.functorVDom=u,t.h=n.h,t.text=n.text,t.emptyNode=n.emptyNode,t.key=n.key,t.attr=n.attr,t.style=n.style,t.class_=n.class_,t.unsafeOnWithEffect=n.unsafeOnWithEffect})(PS),(e=>{"use strict";e["Pha.Elements"]=e["Pha.Elements"]||{};var t=e["Pha.Elements"],n=e.Pha,a=n.h("span"),o=n.h("p"),r=n.h("h2"),i=n.h("h1"),l=n.h("div"),s=n.h("button"),u=n.h("br")([])([]),c=n.h("a");t.a=c,t.br=u,t.button=s,t.div=l,t.h1=i,t.h2=r,t.p=o,t.span=a})(PS),(e=>{e.preventDefaultE=e=>()=>e&&e.preventDefault&&e.preventDefault(),e.stopPropagationE=e=>()=>e&&e.stopPropagation&&e.stopPropagation()})(PS["Pha.Events"]=PS["Pha.Events"]||{}),(PS["Pha.Events.Decoder"]=PS["Pha.Events.Decoder"]||{}).getBoundingClientRectAux=e=>e&&e.getBoundingClientRect&&e.getBoundingClientRect(),(e=>{"use strict";e["Pha.Events.Decoder"]=e["Pha.Events.Decoder"]||{};var t,n=e["Pha.Events.Decoder"],a=e["Pha.Events.Decoder"],o=e["Control.Applicative"],r=e["Control.Bind"],i=e["Control.Monad.Except.Trans"],l=e["Data.Function"],s=e["Data.Identity"],u=e.Foreign,c=e["Foreign.Index"],d=r.composeKleisli(i.bindExceptT(s.monadIdentity))(c.readProp("shiftKey"))(u.readBoolean),v=r.composeKleisli(i.bindExceptT(s.monadIdentity))(c.readProp("key"))(u.readString),p=c.readProp("currentTarget"),m=(t=o.pure(i.applicativeExceptT(s.monadIdentity)),e=>l.const(t(e)));n.always=m,n.currentTarget=p,n.shiftKey=d,n.key=v,n.getBoundingClientRect=e=>{var t=a.getBoundingClientRectAux(e);return r.bind(i.bindExceptT(s.monadIdentity))(r.bind(i.bindExceptT(s.monadIdentity))(c.readProp("left")(t))(u.readNumber))(e=>r.bind(i.bindExceptT(s.monadIdentity))(r.bind(i.bindExceptT(s.monadIdentity))(c.readProp("top")(t))(u.readNumber))(n=>r.bind(i.bindExceptT(s.monadIdentity))(r.bind(i.bindExceptT(s.monadIdentity))(c.readProp("width")(t))(u.readNumber))(a=>r.bind(i.bindExceptT(s.monadIdentity))(r.bind(i.bindExceptT(s.monadIdentity))(c.readProp("height")(t))(u.readNumber))(t=>o.pure(i.applicativeExceptT(s.monadIdentity))({left:e,top:n,width:a,height:t})))))}})(PS),(e=>{"use strict";e["Pha.Events"]=e["Pha.Events"]||{};var t,n,a,o,r,i,l,s,u=e["Pha.Events"],c=e["Pha.Events"],d=e["Control.Applicative"],v=e["Control.Monad.Except"],p=e["Control.Monad.Except.Trans"],m=e["Data.Either"],h=e["Data.Functor"],w=e["Data.Identity"],g=e["Data.Maybe"],f=e["Data.Tuple"],b=e["Data.Unit"],y=e.Effect,D=e.Foreign,S=e.Pha,F=e["Pha.Events.Decoder"],P=e=>t=>{return S.on_(e)(e=>{var n=v.runExcept(t(D.unsafeToForeign(e)));return n instanceof m.Right?n.value0:g.Nothing.value})},C=(t=P("click"),e=>t(F.always(e))),I=(n=P("pointerdown"),e=>n(F.always(e))),M=(a=P("pointerup"),e=>a(F.always(e))),x=e=>t=>{return P(e)((n=h.map(p.functorExceptT(w.functorIdentity))(g.Just.create),e=>n(t(e))));var n},A=(o=x("click"),e=>o(F.always(e))),_=(r=x("pointerdown"),e=>r(F.always(e))),G=(i=x("pointerenter"),e=>i(F.always(e))),T=(l=x("pointerleave"),e=>l(F.always(e))),O=(s=x("pointerup"),e=>s(F.always(e)));u.onclick=A,u["onclick'"]=C,u.onpointerup=O,u["onpointerup'"]=M,u.onpointerdown=_,u["onpointerdown'"]=I,u.onpointerenter=G,u.onpointerleave=T,u.oncontextmenu=e=>(e=>t=>{return(e=>t=>{return S.unsafeOnWithEffect(e)(e=>{var n=v.runExcept(t(D.unsafeToForeign(e)));return n instanceof m.Right?{effect:function(){return d.when(y.applicativeEffect)(n.value0.stopPropagation)(c.stopPropagationE(e))(),d.when(y.applicativeEffect)(n.value0.preventDefault)(c.preventDefaultE(e))()},msg:n.value0.message}:{effect:d.pure(y.applicativeEffect)(b.unit),msg:g.Nothing.value}})})(e)((n=h.map(p.functorExceptT(w.functorIdentity))(e=>({message:e.value0,preventDefault:e.value1,stopPropagation:!1})),e=>n(t(e))));var n})("contextmenu")(F.always(new f.Tuple(new g.Just(e),!0))),u.on=x,u["on'"]=P})(PS),(e=>{"use strict";e["Pha.Svg"]=e["Pha.Svg"]||{};var t=e["Pha.Svg"],n=e["Data.Semigroup"],a=e["Data.Show"],o=e.Pha,r=o.attr("y"),i=o.attr("y2"),l=o.attr("y1"),s=o.attr("x"),u=o.attr("x2"),c=o.attr("x1"),d=o.attr("width"),v=o.attr("transform"),p=o.h("svg"),m=o.attr("stroke-width"),h=o.attr("stroke-dasharray"),w=o.attr("stroke"),g=o.attr("r"),f=o.attr("opacity"),b=o.attr("height"),y=o.h("g"),D=o.attr("fill"),S=o.attr("cy"),F=o.attr("cx");t.g=y,t.svg=p,t.rect=e=>o.h("rect")(e)([]),t.path=e=>t=>o.h("path")(n.append(n.semigroupArray)([o.attr("d")(e)])(t))([]),t.line=e=>o.h("line")(e)([]),t.circle=e=>o.h("circle")(e)([]),t.use=e=>t=>o.h("use")(n.append(n.semigroupArray)([o.attr("href")(e)])(t))([]),t["text'"]=e=>t=>o.h("text")(t)([o.text(e)]),t.x_=s,t.y_=r,t.x1=c,t.y1=l,t.x2=u,t.y2=i,t.cx=F,t.cy=S,t.r=g,t.width=d,t.height=b,t.stroke=w,t.opacity=f,t.fill=D,t.viewBox=e=>t=>n=>r=>o.attr("viewBox")(a.show(a.showInt)(e)+" "+a.show(a.showInt)(t)+" "+a.show(a.showInt)(n)+" "+a.show(a.showInt)(r)),t.transform=v,t.strokeWidth=m,t.strokeDasharray=h})(PS),(e=>{"use strict";e["Pha.Util"]=e["Pha.Util"]||{};var t=e["Pha.Util"],n=e["Data.Show"];t.px=e=>n.show(n.showNumber)(e)+"px",t.pc=e=>n.show(n.showNumber)(100*e)+"%",t.translate=e=>t=>"translate("+e+","+t+")",t.rgbColor=e=>t=>a=>"rgb("+n.show(n.showInt)(e)+","+n.show(n.showInt)(t)+","+n.show(n.showInt)(a)+")"})(PS),(e=>{"use strict";e["Pha.Attributes"]=e["Pha.Attributes"]||{};var t=e["Pha.Attributes"],n=e.Pha,a=n.attr("href");t.disabled=e=>n.attr("disabled")((()=>e?"true":"")()),t.href=a})(PS),function(e){"use strict";e["UI.Icon"]=e["UI.Icon"]||{};var t=e["UI.Icon"],n=e["Data.Functor"],a=e["Data.Maybe"],o=e["Data.Semigroup"],r=e["Data.Tuple"],i=e["Lib.Util"],l=e.Pha,s=e["Pha.Attributes"],u=e["Pha.Elements"],c=e["Pha.Svg"],d=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),v=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),p=(()=>{function e(){}return e.value=new e,e})(),m={icon:p.value,selected:!1,tooltip:a.Nothing.value,round:!1,large:!1,hidden:!1,disabled:!1,style:[]};t.IconText=d,t.IconSymbol=v,t.IconNone=p,t.defaultOptions=m,t.iconbutton=e=>t=>a=>{var h=i.partialUpdate(e)(t)(m);return u.button(o.append(o.semigroupArray)([l.class_("ui-icon"),l["class'"]("selected")(h.selected),l["class'"]("round")(h.large),l["class'"]("hidden")(h.hidden),s.disabled(h.disabled)])(a))([(()=>{if(h.icon instanceof v)return c.svg(o.append(o.semigroupArray)(n.map(n.functorArray)(r.uncurry(l.style))(h.style))([c.width("100%"),c.height("100%")]))([c.use(h.icon.value0)([l.class_("ui-icon-symbol")])]);if(h.icon instanceof d)return u.span([l.class_("ui-icon-text")])([l.text(h.icon.value0)]);if(h.icon instanceof p)return l.emptyNode;throw new Error("Failed pattern match at UI.Icon (line 46, column 9 - line 51, column 34): "+[h.icon.constructor.name])})(),l.maybe(h.tooltip)(e=>u.span([l.class_("ui-icon-tooltip")])([l.text(e)]))])}}(PS),function(e){"use strict";e["UI.Icons"]=e["UI.Icons"]||{};var t=e["UI.Icons"],n=e["Data.Eq"],a=e["Data.Foldable"],o=e["Data.Functor"],r=e["Data.Lens.Getter"],i=e["Data.Lens.Internal.Forget"],l=e["Data.List"],s=e["Data.Maybe"],u=e["Data.Semigroup"],c=e["Data.Show"],d=e["Data.Tuple"],v=e["Game.Core"],p=e["Lib.Util"],m=e.Pha,h=e["Pha.Elements"],w=e["Pha.Events"],g=e["UI.Icon"],f=function(e){this.defIconText=e},b=e=>t=>h.div([])([h.h2([])([m.text(e)]),h.div([m.class_("ui-icon-grid")])(t)]),y=e=>t=>n=>a=>{var o=p.partialUpdate(e)(n)(g.defaultOptions);return g.iconbutton(p.precord()())({disabled:o.disabled||r.viewOn(t)(v._locked(i.strongForget)),hidden:o.hidden,icon:o.icon,large:o.large,round:o.round,selected:o.selected,style:o.style,tooltip:o.tooltip})(a)},D=new f(e=>t=>({icon:g.IconText.create(c.show(c.showInt)(e)),selected:t.selected,tooltip:t.tooltip,round:t.round,large:t.large,hidden:t.hidden,disabled:t.disabled,style:t.style})),S=new f(e=>e=>e),F=e=>e.defIconText;t.iconbutton=y,t.icongroup=b,t.iundo=e=>t=>y(p.precord()())(t)({icon:new g.IconSymbol("#undo"),tooltip:new s.Just("Annule le dernier coup effectué"),disabled:l.null(r.viewOn(t)(v._history(i.strongForget)))})([w.onclick(v.core(e)(v.Undo.value))]),t.iredo=e=>t=>y(p.precord()())(t)({icon:new g.IconSymbol("#undo"),tooltip:new s.Just("Rejoue le coup annulé"),disabled:l.null(r.viewOn(t)(v._redoHistory(i.strongForget))),style:[new d.Tuple("transform","scaleX(-1)")]})([w.onclick(v.core(e)(v.Redo.value))]),t.ireset=e=>t=>y(p.precord()())(t)({icon:new g.IconSymbol("#reset"),tooltip:new s.Just("Recommence la partie"),disabled:l.null(r.viewOn(t)(v._history(i.strongForget)))})([w.onclick(v.core(e)(v.Reset.value))]),t.ihelp=e=>t=>y(p.precord()())(t)({icon:new g.IconSymbol("#help"),tooltip:new s.Just("Aide"),selected:r.viewOn(t)(v._help(i.strongForget))})([w.onclick(v.core(e)(v.ToggleHelp.value))]),t.irules=e=>t=>{var n=r.viewOn(t)(v._dialog(i.strongForget))instanceof v.Rules;return y(p.precord()())(t)({icon:new g.IconSymbol("#rules"),tooltip:new s.Just("Règles"),selected:n})([w.onclick(v.core(e)(v.SetRulesDialog.value))])},t.iconSelectGroup=e=>t=>a=>r=>i=>l=>s=>u=>b(r)(o.mapFlipped(o.functorArray)(i)(o=>y(p.precord()())(a)(u(o)(F(e)(o)({icon:g.defaultOptions.icon,selected:n.eq(t)(o)(l),tooltip:g.defaultOptions.tooltip,round:g.defaultOptions.round,large:g.defaultOptions.large,hidden:g.defaultOptions.hidden,disabled:g.defaultOptions.disabled,style:g.defaultOptions.style})))([w.onclick(s(o))]))),t.iconSelectGroupM=e=>t=>n=>r=>i=>l=>s=>u=>c=>b(i)(o.mapFlipped(o.functorArray)(l)(o=>y(p.precord()())(r)(c(o)(F(e)(o)({icon:g.defaultOptions.icon,selected:a.elem(n)(t)(o)(s),tooltip:g.defaultOptions.tooltip,round:g.defaultOptions.round,large:g.defaultOptions.large,hidden:g.defaultOptions.hidden,disabled:g.defaultOptions.disabled,style:g.defaultOptions.style})))([w.onclick(u(o))]))),t.iconSizesGroup=e=>t=>n=>a=>{var l=r.viewOn(t)(v._customSize(i.strongForget)),d=r.viewOn(t)(v._nbRows(i.strongForget)),m=r.viewOn(t)(v._nbColumns(i.strongForget));return b("Dimensions de la grille")(u.append(u.semigroupArray)(o.mapFlipped(o.functorArray)(n)(n=>y(p.precord()())(t)({icon:g.IconText.create(c.show(c.showInt)(n.value0)+"x"+c.show(c.showInt)(n.value1)),selected:n.value0===d&&n.value1===m&&!l})([w.onclick(v.core(e)(new v.SetGridSize(n.value0,n.value1,!1)))])))((()=>a?[y(p.precord()())(t)({icon:new g.IconText("NxM"),tooltip:new s.Just("Taille personnalisée"),selected:l})([w.onclick(v.core(e)(new v.SetCustomSize(!0)))])]:[])()))},t.icons2Players=e=>t=>t=>b("Mode de jeu")([y(p.precord()())(t)({icon:new g.IconSymbol("#school"),selected:n.eq(v.eqMode)(r.viewOn(t)(v._mode(i.strongForget)))(v.RandomMode.value),tooltip:new s.Just("IA mode facile")})([w.onclick(v.core(e)(new v.SetMode(v.RandomMode.value)))]),y(p.precord()())(t)({icon:new g.IconSymbol("#enstein"),selected:n.eq(v.eqMode)(r.viewOn(t)(v._mode(i.strongForget)))(v.ExpertMode.value),tooltip:new s.Just("IA mode expert")})([w.onclick(v.core(e)(new v.SetMode(v.ExpertMode.value)))]),y(p.precord()())(t)({icon:new g.IconSymbol("#duel"),selected:n.eq(v.eqMode)(r.viewOn(t)(v._mode(i.strongForget)))(v.DuelMode.value),tooltip:new s.Just("Affronte un autre joueur")})([w.onclick(v.core(e)(new v.SetMode(v.DuelMode.value)))]),y(p.precord()())(t)({icon:new g.IconText("2P⇨"),disabled:!l.null(r.viewOn(t)(v._history(i.strongForget)))||n.eq(v.eqMode)(r.viewOn(t)(v._mode(i.strongForget)))(v.DuelMode.value),tooltip:new s.Just("L'IA commence")})([w.onclick(v.core(e)(v.ComputerStarts.value))])]),t.iconBestScore=e=>t=>n=>{return b("Meilleur score ("+s.maybe("∅")((a=c.show(c.showInt),e=>a(d.fst(e))))(v.bestScore(t)(n))+")")([y(p.precord()())(n)({icon:new g.IconSymbol("#cup"),disabled:s.isNothing(v.bestScore(t)(n)),tooltip:new s.Just("Meilleur score")})([w.onclick(v.core(e)(v.SetScoreDialog.value))])]);var a},t.defint=D,t.defa=S}(PS),(e=>{"use strict";e["Game.Common"]=e["Game.Common"]||{};var t=e["Game.Common"],n=e["Control.Applicative"],a=e["Control.Bind"],o=e["Control.Monad.Except.Trans"],r=e["Data.Array"],i=e["Data.EuclideanRing"],l=e["Data.Foldable"],s=e["Data.Function"],u=e["Data.Functor"],c=e["Data.Identity"],d=e["Data.Lens.Iso"],v=e["Data.Maybe"],p=e["Data.Tuple"],m=e.Foreign,h=e["Foreign.Index"],w=e["Pha.Events.Decoder"];t._isoCustom=e=>{var t,n,a,o=(t=r.mapWithIndex(e=>t=>t?new v.Just({row:i.div(i.euclideanRingInt)(e)(5)-2|0,col:i.mod(i.euclideanRingInt)(e)(5)-2|0}):v.Nothing.value),e=>r.catMaybes(t(e))),c=(n=s.flip(r.updateAtIndices(l.foldableArray))(r.replicate(25)(!1)),a=u.map(u.functorArray)(e=>new p.Tuple(12+((5*e.row|0)+e.col|0)|0,!0)),e=>n(a(e)));return d.iso(c)(o)(e)},t.pointerDecoder=e=>a.bind(o.bindExceptT(c.monadIdentity))(a.bind(o.bindExceptT(c.monadIdentity))(w.currentTarget(e))(w.getBoundingClientRect))(t=>a.bind(o.bindExceptT(c.monadIdentity))(a.bind(o.bindExceptT(c.monadIdentity))(h.readProp("clientX")(e))(m.readNumber))(r=>a.bind(o.bindExceptT(c.monadIdentity))(a.bind(o.bindExceptT(c.monadIdentity))(h.readProp("clientY")(e))(m.readNumber))(e=>n.pure(o.applicativeExceptT(c.monadIdentity))({x:(r-t.left)/t.width,y:(e-t.top)/t.height}))))})(PS),(e=>{"use strict";e["UI.Dialog"]=e["UI.Dialog"]||{};var t=e["UI.Dialog"],n=e["Data.Array"],a=e["Data.Functor"],o=e["Data.Maybe"],r=e.Pha,i=e["Pha.Elements"],l=e["Pha.Events"];t.dialog=e=>t=>i.div([r.class_("ui-absolute ui-flex-center ui-dialog-container")])([i.div([r.class_("ui-dialog")])([i.div([r.class_("ui-dialog-head")])([i.div([r.class_("ui-dialog-title")])([r.text(e.title)])]),i.div([r.class_("ui-dialog-body")])(t),i.div([r.class_("ui-dialog-buttons")])(n.catMaybes([a.mapFlipped(o.functorMaybe)(e.onCancel)(e=>i.button([r.class_("ui-button ui-button-primary"),l.onclick(e)])([r.text("Annuler")])),a.mapFlipped(o.functorMaybe)(e.onOk)(e=>i.button([r.class_("ui-button ui-button-primary"),l.onclick(e)])([r.text("Ok")]))]))])])})(PS),(e=>{"use strict";e["UI.IncDecGrid"]=e["UI.IncDecGrid"]||{};var t=e["UI.IncDecGrid"],n=e["Data.Show"],a=e["Lib.Util"],o=e.Pha,r=e["Pha.Elements"],i=e["Pha.Events"],l=e["UI.Icon"];t.incDecGrid=e=>t=>r.div([o.class_("ui-incdecgrid")])([r.div([o.class_("flex")])([r.div([o.class_("ui-flex-center ui-incdecgrid-container")])(t),o.when(e.showRowButtons)(t=>r.div([o.class_("ui-flex-center ui-incdecgrid-rows")])([l.iconbutton(a.precord()())({round:!0,icon:new l.IconSymbol("#plus"),disabled:e.locked,hidden:!e.customSize})([i.onclick(e.resize(e.nbRows+1|0)(e.nbColumns))]),r.div([o.class_("ui-incdecgrid-text")])([r.span([])([o.text(n.show(n.showInt)(e.nbRows))])]),l.iconbutton(a.precord()())({round:!0,icon:new l.IconSymbol("#minus"),disabled:e.locked,hidden:!e.customSize})([i.onclick(e.resize(e.nbRows-1|0)(e.nbColumns))])]))]),o.when(e.showColButtons)(t=>r.div([o.class_("ui-flex-center ui-incdecgrid-cols")])([l.iconbutton(a.precord()())({round:!0,icon:new l.IconSymbol("#minus"),disabled:e.locked,hidden:!e.customSize})([i.onclick(e.resize(e.nbRows)(e.nbColumns-1|0))]),r.div([o.class_("ui-incdecgrid-text")])([r.span([])([o.text(n.show(n.showInt)(e.nbColumns))])]),l.iconbutton(a.precord()())({round:!0,icon:new l.IconSymbol("#plus"),disabled:e.locked,hidden:!e.customSize})([i.onclick(e.resize(e.nbRows)(e.nbColumns+1|0))])]))])})(PS),(e=>{"use strict";e["UI.Template"]=e["UI.Template"]||{};var t=e["UI.Template"],n=e["Control.Monad.Except.Trans"],a=e["Data.Eq"],o=e["Data.Functor"],r=e["Data.Identity"],i=e["Data.Int"],l=e["Data.Lens.Getter"],s=e["Data.Lens.Internal.Forget"],u=e["Data.Maybe"],c=e["Data.Ord"],d=e["Data.Tuple"],v=e["Data.Unit"],p=e["Game.Common"],m=e["Game.Core"],h=e["Lib.Util"],w=e.Pha,g=e["Pha.Elements"],f=e["Pha.Events"],b=e["Pha.Util"],y=e["UI.Dialog"],D=e["UI.IncDecGrid"],S=e=>t=>g.div([w.class_("ui-flex-center ui-absolute component-win-container")])([g.div([w.class_("component-win"),w["class'"]("visible")(t)])([w.text(e)])]),F=e=>t=>y.dialog({title:t,onCancel:u.Nothing.value,onOk:u.Just.create(m.core(e)(m.SetNoDialog.value))}),P={board:w.emptyNode,config:w.emptyNode,rules:[w.text("blah blah")],winTitle:"GAGNÉ",customDialog:e=>w.emptyNode,scoreDialog:e=>w.emptyNode};t.card=e=>t=>g.div([w.class_("ui-card")])([g.div([w.class_("ui-card-head ui-flex-center")])([g.div([w.class_("ui-card-title")])([w.text(e)])]),g.div([w.class_("ui-card-body")])(t)]),t.incDecGrid=e=>t=>n=>{var a=m.sizeLimit(t)(n);return D.incDecGrid({locked:l.viewOn(n)(m._locked(s.strongForget)),nbRows:l.viewOn(n)(m._nbRows(s.strongForget)),nbColumns:l.viewOn(n)(m._nbColumns(s.strongForget)),showRowButtons:a.value0<a.value2,showColButtons:a.value1<a.value3,customSize:l.viewOn(n)(m._customSize(s.strongForget)),resize:t=>n=>m.core(e)(new m.SetGridSize(t,n,!0))})},t.template=e=>t=>n=>n=>a=>{var o=h.partialUpdate(e)(n)(P);return g.div([])([g.div([w.class_("main-container")])([g.div([])([o.board,S(o.winTitle)(l.viewOn(a)(m._showWin(s.strongForget)))]),o.config]),(e=>e instanceof m.Rules?F(t)("Règles du jeu")(o.rules):e instanceof m.ConfirmNewGameDialog?y.dialog({title:"Nouvelle partie",onCancel:u.Just.create(m.core(t)(m.SetNoDialog.value)),onOk:u.Just.create(m.core(t)(m.ConfirmNewGame.value))})([w.text("Tu es sur le point de créer une nouvelle partie. Ta partie en cours sera perdue. Es-tu sûr(e)?")]):e instanceof m.CustomDialog?o.customDialog(v.unit):e instanceof m.ScoreDialog?o.scoreDialog(v.unit):w.emptyNode)(l.viewOn(a)(m._dialog(s.strongForget)))])},t.dialog=F,t.bestScoreDialog=e=>t=>n=>a=>w.maybe(o.map(u.functorMaybe)(d.snd)(m.bestScore(t)(n)))(t=>F(e)("Meilleur score")(a(t))),t.gridStyle=e=>t=>n=>{var a=i.toNumber(c.max(c.ordInt)(n)(c.max(c.ordInt)(e)(t)));return[w.style("height")(b.pc(i.toNumber(e)/a)),w.style("width")(b.pc(i.toNumber(t)/a))]},t.cursorStyle=e=>t=>n=>a=>[w.style("left")(b.pc(e.x)),w.style("top")(b.pc(e.y)),w.style("width")(b.pc(a/i.toNumber(n))),w.style("height")(b.pc(a/i.toNumber(t)))],t.svgCursorStyle=e=>[w.style("transform")(b.translate(b.pc(e.x))(b.pc(e.y)))],t.trackPointer=e=>{var t=t=>o.map(n.functorExceptT(r.functorIdentity))(m.core(e))(o.map(n.functorExceptT(r.functorIdentity))(o.map(o.functorFn)(m.SetPointer.create)(u.Just.create))(p.pointerDecoder(t)));return[w.style("touch-action")("none"),f.on("pointermove")(t),f.onpointerleave(m.core(e)(new m.SetPointer(u.Nothing.value))),f.on("pointerdown")(t)]},t.dndBoardProps=e=>t=>{return[w.style("touch-action")("none"),f.on("pointermove")(t=>o.map(n.functorExceptT(r.functorIdentity))(m.core(e))(o.map(n.functorExceptT(r.functorIdentity))(o.map(o.functorFn)(m.SetPointer.create)(u.Just.create))(p.pointerDecoder(t)))),f.onpointerup(m.dndmsg(t)(m.DropOnBoard.value)),f.onpointerleave(m.dndmsg(t)(m.Leave.value))]},t.dndItemProps=e=>t=>n=>o=>r=>{var i=o.draggable&&a.eq(u.eqMaybe(e))(new u.Just(o.id))(o.currentDragged),l=o.droppable&&u.maybe(!1)(e=>m.canPlay(n)(r)({from:e,to:o.id}))(o.currentDragged);return[w["class'"]("dragged")(i),w["class'"]("candrop")(l),f["onpointerdown'"]((()=>o.draggable?u.Just.create(m.dndmsg(t)(new m.Drag(o.id))):u.Nothing.value)()),f["onpointerup'"]((()=>l?u.Just.create(m.dndmsg(t)(new m.Drop(o.id))):u.Nothing.value)())]},t.turnMessage=e=>t=>{return m.isLevelFinished(e)(t)?"Partie finie":a.eq(m.eqTurn)(l.viewOn(t)(m._turn(s.strongForget)))(m.Turn1.value)?"Tour du premier joueur":a.eq(m.eqMode)(l.viewOn(t)(m._mode(s.strongForget)))(m.DuelMode.value)?"Tour du second joueur":"Tour de l'IA"},t.winTitleFor2Players=e=>{return a.eq(m.eqMode)(l.viewOn(e)(m._mode(s.strongForget)))(m.DuelMode.value)?"Le "+(a.eq(m.eqTurn)(l.viewOn(e)(m._turn(s.strongForget)))(m.Turn2.value)?"premier":"second")+" joueur gagne":a.eq(m.eqTurn)(l.viewOn(e)(m._turn(s.strongForget)))(m.Turn2.value)?"Tu as gagné":"L'IA gagne"}})(PS),(e=>{"use strict";e["Game.Baseball.View"]=e["Game.Baseball.View"]||{};var t=e["Game.Baseball.View"],n=e["Control.Bind"],a=e["Control.Category"],o=e["Data.Array"],r=e["Data.Eq"],i=e["Data.EuclideanRing"],l=e["Data.Function"],s=e["Data.Int"],u=e["Data.Lens.Getter"],c=e["Data.Lens.Internal.Forget"],d=e["Data.Show"],v=e["Game.Baseball.Model"],p=e["Game.Core"],m=e["Lib.Util"],h=e.Math,w=e.Pha,g=e["Pha.Elements"],f=e["Pha.Events"],b=e["Pha.Svg"],y=e["Pha.Util"],D=e["UI.Icons"],S=e["UI.Template"],F=e=>t=>{var n=s.toNumber(i.div(i.euclideanRingInt)(e)(2)),a=.42+.35*h.cos(2*n*h.pi/s.toNumber(t))+.1*s.toNumber(i.mod(i.euclideanRingInt)(e)(2)),o=.46+.35*h.sin(2*n*h.pi/s.toNumber(t));return y.translate(y.pc(a))(y.pc(o))},P=e=>t=>{var n=.5+.35*h.sin(2*s.toNumber(e)*h.pi/s.toNumber(t)),a=.5+.35*h.cos(2*s.toNumber(e)*h.pi/s.toNumber(t));return y.translate(y.pc(a))(y.pc(n))+" rotate(45deg)"},C=["blue","red","green","magenta","orange","black","cyan","gray"],I=n.bind(n.bindArray)(C)(e=>[e,e]);t.view=e=>{var t=[w.text("blah blah blah blah")],n=u.viewOn(e)(v._nbBases(c.strongForget)),s=p.isLevelFinished(v.baseballGame)(e),h=S.card("Baseball multicolore")([D.iconSelectGroup(D.defint)(r.eqInt)(e)("Nombres de bases")([4,5,6,7,8])(n)(v.SetNbBases.create)(l.const(a.identity(a.categoryFn))),D.icongroup("Options")([D.iundo(v.withcore)(e),D.iredo(v.withcore)(e),D.ireset(v.withcore)(e),D.irules(v.withcore)(e)])]),y=g.div([w.class_("ui-board baseball-board")])([b.svg([b.viewBox(0)(0)(100)(100)])(o.concat([o.mapWithIndex(e=>t=>b.rect([b.x_("-10"),b.y_("-10"),b.width("20"),b.height("20"),w.key("b"+d.show(d.showInt)(e)),w.class_("baseball-base"),b.stroke(t),w.style("transform")(P(e)(n))]))(o.take(n)(C)),m.map2(u.viewOn(e)(p._position(c.strongForget)))(I)(t=>a=>o=>w.when(t!==u.viewOn(e)(v._missingPeg(c.strongForget)))(r=>b.g([w.class_("baseball-player"),w.style("transform")(F(a)(n)),w.key("p"+d.show(d.showInt)(t))])([b.use("#meeple")([b.width("7"),b.height("7"),f.onclick(new v.Play(t)),b.fill(o),w.style("animation")((()=>s?"baseballHola 4s linear "+d.show(d.showInt)(1e3+i.div(i.euclideanRingInt)(2e3*t|0)(n)|0)+"ms infinite":"none")()),w.style("cursor")(p.canPlay(v.baseballGame)(e)(t)?"pointer":"not-allowed")])])))]))]);return S.template(m.precord()())(v.withcore)(v.baseballGame)({config:h,board:y,rules:t})(e)}})(PS),(e=>{"use strict";e["Game.Baseball"]=e["Game.Baseball"]||{};var t=e["Game.Baseball"],n=e["Data.Function"],a=e["Data.Maybe"],o=e["Game.Baseball.Model"],r=e["Game.Baseball.View"],i=e["Game.Core"],l={init:new a.Just(i.core(o.withcore)(i.Init.value)),view:r.view,onKeydown:n.const(a.Nothing.value)};t.game=l})(PS),function(e){"use strict";e["Game.Chocolat.Model"]=e["Game.Chocolat.Model"]||{};var t,n=e["Game.Chocolat.Model"],a=e["Control.Applicative"],o=e["Control.Apply"],r=e["Control.Bind"],i=e["Data.Eq"],l=e["Data.Function"],s=e["Data.Functor"],u=e["Data.Lens.Getter"],c=e["Data.Lens.Internal.Forget"],d=e["Data.Lens.Iso"],v=e["Data.Lens.Lens"],p=e["Data.Lens.Setter"],m=e["Data.Maybe"],h=e["Data.Profunctor.Strong"],w=e["Data.Semigroup"],g=e["Data.Tuple"],f=e["Game.Core"],b=e["Lib.Util"],y=e["Pha.Action"],D=e["Pha.Effects.Random"],S=e.Run,F=(()=>{function e(){}return e.value=new e,e})(),P=(()=>{function e(){}return e.value=new e,e})(),C=(()=>{function e(){}return e.value=new e,e})(),I=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),M=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),x=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),A=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),_=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),G=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),T=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),O=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),E=e=>e,N=new f.MsgWithCore(_.create),R=f.genState({left:0,top:0,right:0,bottom:0})(e=>({position:e.position,history:e.history,redoHistory:e.redoHistory,dialog:e.dialog,turn:e.turn,nbRows:6,nbColumns:7,customSize:e.customSize,mode:f.RandomMode.value,help:e.help,locked:e.locked,showWin:e.showWin,scores:e.scores,pointer:e.pointer}))({soap:{row:0,col:0},soapMode:F.value,moveWhenHover:m.Nothing.value}),L=new i.Eq(e=>t=>e instanceof F&&t instanceof F||(e instanceof P&&t instanceof P||e instanceof C&&t instanceof C)),q=e=>{var t=f._ext(e),n=d.iso(e=>e)(E)(e.Profunctor0());return e=>t(n(e))},k=e=>{var t=q(e),n=v.lens(e=>e.moveWhenHover)(e=>t=>({moveWhenHover:t,soap:e.soap,soapMode:e.soapMode}))(e);return e=>t(n(e))},U=e=>{var t=q(e),n=v.lens(e=>e.soap)(e=>t=>({soap:t,moveWhenHover:e.moveWhenHover,soapMode:e.soapMode}))(e);return e=>t(n(e))},B=e=>{var t=q(e),n=v.lens(e=>e.soapMode)(e=>t=>({soapMode:t,moveWhenHover:e.moveWhenHover,soap:e.soap}))(e);return e=>t(n(e))},J=new f.TwoPlayersGame(()=>W,e=>{var t=u.viewOn(e)(f._position(c.strongForget)),n=u.viewOn(e)(U(c.strongForget));return 0==((n.col-t.left|0)^((t.right-n.col|0)-1|0)^(n.row-t.top|0)^((t.bottom-n.row|0)-1|0))},e=>{var t=u.viewOn(e)(f._position(c.strongForget)),n=u.viewOn(e)(U(c.strongForget));return w.append(w.semigroupArray)(s.mapFlipped(s.functorArray)(b["range'"](t.left+1|0)(n.col))(I.create))(w.append(w.semigroupArray)(s.mapFlipped(s.functorArray)(b["range'"](n.col+1|0)(t.right-1|0))(M.create))(w.append(w.semigroupArray)(s.mapFlipped(s.functorArray)(b["range'"](t.top+1|0)(n.row))(x.create))(s.mapFlipped(s.functorArray)(b["range'"](n.row+1|0)(t.bottom-1|0))(A.create))))}),W=new f.Game(f["computerMove'"](J),e=>a.pure(S.applicativeRun)({left:0,right:u.viewOn(e)(f._nbColumns(c.strongForget)),top:0,bottom:u.viewOn(e)(f._nbRows(c.strongForget))}),(t=u.view(f._position(c.strongForget)),e=>(e=>e.left===(e.right-1|0)&&e.top===(e.bottom-1|0))(t(e))),e=>r.bind(S.bindRun)(i.eq(L)(u.viewOn(e)(B(c.strongForget)))(C.value)?D.randomInt(u.viewOn(e)(f._nbRows(c.strongForget))):a.pure(S.applicativeRun)(0))(t=>r.bind(S.bindRun)(i.notEq(L)(u.viewOn(e)(B(c.strongForget)))(F.value)?D.randomInt(u.viewOn(e)(f._nbColumns(c.strongForget))):a.pure(S.applicativeRun)(0))(n=>a.pure(S.applicativeRun)(p.set(U(h.strongFn))({row:t,col:n})(e)))),e=>{var t=u.viewOn(e)(f._position(c.strongForget));return e=>{if(e instanceof I)return new m.Just({left:e.value0,bottom:t.bottom,right:t.right,top:t.top});if(e instanceof x)return new m.Just({top:e.value0,bottom:t.bottom,left:t.left,right:t.right});if(e instanceof M)return new m.Just({right:e.value0,bottom:t.bottom,left:t.left,top:t.top});if(e instanceof A)return new m.Just({bottom:e.value0,left:t.left,right:t.right,top:t.top});throw new Error("Failed pattern match at Game.Chocolat.Model (line 42, column 15 - line 46, column 47): "+[e.constructor.name])}},l.const(new f.SizeLimit(4,4,10,10)),e=>new g.Tuple(e,!0));n.FromLeft=I,n.FromRight=M,n.FromTop=x,n.FromBottom=A,n.CornerMode=F,n.BorderMode=P,n.StandardMode=C,n._soap=U,n._soapMode=B,n._moveWhenHover=k,n.istate=R,n.cutLine=e=>{var t=u.viewOn(e)(f._position(c.strongForget));return e=>{if(e instanceof I)return{x1:e.value0,y1:t.top,x2:e.value0,y2:t.bottom};if(e instanceof M)return{x1:e.value0,y1:t.top,x2:e.value0,y2:t.bottom};if(e instanceof x)return{x1:t.left,y1:e.value0,x2:t.right,y2:e.value0};if(e instanceof A)return{x1:t.left,y1:e.value0,x2:t.right,y2:e.value0};throw new Error("Failed pattern match at Game.Chocolat.Model (line 75, column 17 - line 79, column 56): "+[e.constructor.name])}},n.SetHover=G,n.SetSoapMode=T,n.Play=O,n.update=e=>{if(e instanceof _)return f.coreUpdate(W)(e.value0);if(e instanceof G)return y.setState(p.set(k(h.strongFn))(e.value0));if(e instanceof T)return f.newGame(W)(p.set(B(h.strongFn))(e.value0));if(e instanceof O)return o.applySecond(S.applyRun)(y.setState(p.set(k(h.strongFn))(m.Nothing.value)))(f.playA(W)(e.value0));throw new Error("Failed pattern match at Game.Chocolat.Model (line 85, column 1 - line 85, column 35): "+[e.constructor.name])},n.eqSoapMode=L,n.gameChocolat=W,n.chocolat2Game=J,n.withcore=N}(PS),(e=>{"use strict";e["Game.Chocolat.View"]=e["Game.Chocolat.View"]||{};var t=e["Game.Chocolat.View"],n=e["Control.Bind"],a=e["Data.Array"],o=e["Data.Functor"],r=e["Data.Int"],i=e["Data.Lens.Getter"],l=e["Data.Lens.Internal.Forget"],s=e["Data.Maybe"],u=e["Data.Semigroup"],c=e["Data.Show"],d=e["Data.Tuple"],v=e["Game.Chocolat.Model"],p=e["Game.Core"],m=e["Lib.Util"],h=e.Pha,w=e["Pha.Elements"],g=e["Pha.Events"],f=e["Pha.Svg"],b=e["UI.Icon"],y=e["UI.Icons"],D=e["UI.Template"],S=e=>t=>n=>{var a=i.viewOn(e)(p._position(l.strongForget));return n>=a.left&&n<=(a.right-1|0)&&t>=a.top&&t<=(a.bottom-1|0)};t.view=e=>{var t=i.viewOn(e)(p._nbRows(l.strongForget)),F=i.viewOn(e)(p._position(l.strongForget)),P=i.viewOn(e)(p._nbColumns(l.strongForget)),C=i.viewOn(e)(v._soap(l.strongForget)),I=D.winTitleFor2Players(e),M=[h.text("A chaque tour de ce jeu, tu peux déplacer une pile de jetons vers une case adjacente"),w.br,h.text("qui contient au moins autant de jetons"),w.br,h.text("Le but est de finir la partie avec le moins de cases contenant des piles de jetons.")],x=e=>t=>n=>f.circle([f.cx(c.show(c.showNumber)(50*r.toNumber(t))),f.cy(c.show(c.showNumber)(50*r.toNumber(e))),f.r("7"),h.key("c"+c.show(c.showInt)((e*(P+1|0)|0)+t|0)),h.class_("chocolat-cutter"),g.onpointerenter(new v.SetHover(new s.Just(n))),g.onpointerleave(new v.SetHover(s.Nothing.value)),g.onclick(new v.Play(n))]),A=w.div(u.append(u.semigroupArray)(D.gridStyle(t)(P)(3))([h.class_("ui-board")]))([f.svg([f.viewBox(-7)(-7)(14+(50*P|0)|0)(14+(50*t|0)|0)])(a.concat([m.tabulate2(t)(P)(t=>n=>f.rect([f.x_(c.show(c.showNumber)(50*r.toNumber(n)+7)),f.y_(c.show(c.showNumber)(50*r.toNumber(t)+7)),f.width("36"),f.height("36"),h.key("choc"+c.show(c.showInt)((t*P|0)+n|0)),h.class_("chocolat-square"),h["class'"]("soap")(t===C.row&&n===C.col),h["class'"]("hidden")(!S(e)(t)(n))])),n.bind(n.bindArray)(p.possibleMoves(v.chocolat2Game)(e))(e=>{if(e instanceof v.FromLeft)return[x(F.top)(e.value0)(new v.FromLeft(e.value0)),x(F.bottom)(e.value0)(new v.FromLeft(e.value0))];if(e instanceof v.FromRight)return[x(F.top)(e.value0)(new v.FromRight(e.value0)),x(F.bottom)(e.value0)(new v.FromRight(e.value0))];if(e instanceof v.FromTop)return[x(e.value0)(F.left)(new v.FromTop(e.value0)),x(e.value0)(F.right)(new v.FromTop(e.value0))];if(e instanceof v.FromBottom)return[x(e.value0)(F.left)(new v.FromBottom(e.value0)),x(e.value0)(F.right)(new v.FromBottom(e.value0))];throw new Error("Failed pattern match at Game.Chocolat.View (line 62, column 41 - line 66, column 106): "+[e.constructor.name])}),[f.use("#skull")([f.x_(c.show(c.showInt)(12+(50*C.col|0)|0)),f.y_(c.show(c.showInt)(12+(50*C.row|0)|0)),f.width("26"),f.height("26"),h.key("skull"),f.fill("#20AF20")]),h.maybe(i.viewOn(e)(v._moveWhenHover(l.strongForget)))(t=>{var n=v.cutLine(e)(t);return f.line([f.x1(c.show(c.showInt)(50*n.x1|0)),f.y1(c.show(c.showInt)(50*n.y1|0)),f.x2(c.show(c.showInt)(50*n.x2|0)),f.y2(c.show(c.showInt)(50*n.y2|0)),h.key("line"),h.class_("chocolat-line-to-pointer")])})]]))]),_=D.card("Barre de chocolat")([y.iconSizesGroup(v.withcore)(e)([new d.Tuple(6,7)])(!0),y.iconSelectGroup(y.defa)(v.eqSoapMode)(e)("Emplacement du savon")([v.CornerMode.value,v.BorderMode.value,v.StandardMode.value])(i.viewOn(e)(v._soapMode(l.strongForget)))(v.SetSoapMode.create)(e=>t=>{if(e instanceof v.CornerMode)return{icon:new b.IconSymbol("#choc-mode0"),selected:t.selected,tooltip:new s.Just("Dans le coin"),round:t.round,large:t.large,hidden:t.hidden,disabled:t.disabled,style:t.style};if(e instanceof v.BorderMode)return{icon:new b.IconSymbol("#choc-mode1"),selected:t.selected,tooltip:new s.Just("Sur un bord"),round:t.round,large:t.large,hidden:t.hidden,disabled:t.disabled,style:t.style};if(e instanceof v.StandardMode)return{icon:new b.IconSymbol("#choc-mode2"),selected:t.selected,tooltip:new s.Just("N'importe où"),round:t.round,large:t.large,hidden:t.hidden,disabled:t.disabled,style:t.style};throw new Error("Failed pattern match at Game.Chocolat.View (line 29, column 57 - line 32, column 100): "+[e.constructor.name])}),y.icons2Players(v.withcore)(v.gameChocolat)(e),y.icongroup("Options")(o.mapFlipped(o.functorArray)([y.iundo(v.withcore),y.iredo(v.withcore),y.ireset(v.withcore),y.irules(v.withcore)])(t=>t(e)))]),G=D.incDecGrid(v.withcore)(v.gameChocolat)(e)([A,w.span([h.class_("frog-turn-message")])([h.text(D.turnMessage(v.gameChocolat)(e))])]);return D.template(m.precord()())(v.withcore)(v.gameChocolat)({config:_,board:G,rules:M,winTitle:I})(e)}})(PS),(e=>{"use strict";e["Game.Chocolat"]=e["Game.Chocolat"]||{};var t=e["Game.Chocolat"],n=e["Data.Function"],a=e["Data.Maybe"],o=e["Game.Chocolat.Model"],r=e["Game.Chocolat.View"],i=e["Game.Core"],l={init:new a.Just(i.core(o.withcore)(i.Init.value)),view:r.view,onKeydown:n.const(a.Nothing.value)};t.game=l})(PS),function(e){"use strict";e["Game.Dessin.Model"]=e["Game.Dessin.Model"]||{};var t,n,a,o=e["Game.Dessin.Model"],r=e["Control.Applicative"],i=e["Control.Category"],l=e["Data.Array"],s=e["Data.Eq"],u=e["Data.Foldable"],c=e["Data.Functor"],d=e["Data.Lens.Getter"],v=e["Data.Lens.Internal.Forget"],p=e["Data.Lens.Iso"],m=e["Data.Lens.Lens"],h=e["Data.Lens.Setter"],w=e["Data.Maybe"],g=e["Data.Profunctor.Strong"],f=e["Data.Tuple"],b=e["Game.Core"],y=e["Lib.Util"],D=e.Run,S=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),F=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),P=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),C=function(){function e(e,t){this.value0=e,this.value1=t}return e.create=t=>n=>new e(t,n),e}(),I=e=>e,M=new b.MsgWithCore(S.create),x=(t=l.filter(w.isNothing),n=d.view(b._position(v.strongForget)),e=>l.length(t(n(e)))),A={vertices:[{x:1,y:4},{x:3,y:4},{x:1,y:2},{x:3,y:2},{x:2,y:1}],edges:[new C(0,1),new C(0,2),new C(0,3),new C(1,2),new C(1,3),new C(2,3),new C(2,4),new C(3,4)]},_=b.genState([])(i.identity(i.categoryFn))({graphIndex:0,graph:A}),G={vertices:c.mapFlipped(c.functorArray)([{x:1,y:2},{x:2,y:1},{x:3,y:2},{x:2,y:3},{x:1,y:1},{x:1,y:3},{x:3,y:3},{x:3,y:1},{x:2,y:2}])(e=>({x:1.3*e.x,y:1.3*e.y-.3})),edges:[new C(0,1),new C(1,2),new C(2,3),new C(3,0),new C(0,8),new C(1,8),new C(2,8),new C(3,8),new C(0,4),new C(1,4),new C(0,5),new C(3,5),new C(2,6),new C(3,6),new C(1,7),new C(2,7)]},T={vertices:c.mapFlipped(c.functorArray)([{x:1,y:2},{x:2,y:1},{x:3,y:2},{x:2,y:3},{x:1,y:1},{x:1,y:3},{x:3,y:3},{x:3,y:1}])(e=>({x:1.3*e.x,y:1.3*e.y-.3})),edges:[new C(0,1),new C(1,2),new C(2,3),new C(3,0),new C(0,2),new C(0,4),new C(1,4),new C(0,5),new C(3,5),new C(2,6),new C(3,6),new C(1,7),new C(2,7)]},O={vertices:c.mapFlipped(c.functorArray)([{x:1,y:0},{x:0,y:1},{x:2,y:1},{x:1,y:2},{x:0,y:3},{x:2,y:3},{x:1,y:4},{x:0,y:5},{x:2,y:5}])(e=>({x:.9*e.x+1,y:.9*e.y+.2})),edges:[new C(0,1),new C(0,2),new C(1,2),new C(1,3),new C(2,3),new C(3,4),new C(3,5),new C(4,5),new C(1,4),new C(2,5),new C(4,6),new C(5,6),new C(6,7),new C(6,8),new C(4,7),new C(5,8)]},E=new s.Eq(e=>t=>e.value0===t.value0&&e.value1===t.value1||e.value0===t.value1&&t.value0===e.value1),N=(a=l.mapMaybe(e=>e.value0 instanceof w.Just&&e.value1 instanceof w.Just?new w.Just(new C(e.value0.value0,e.value1.value0)):w.Nothing.value),e=>a(y.pairwise(e))),R={vertices:c.mapFlipped(c.functorArray)([{x:0,y:1},{x:0,y:2},{x:.5,y:1.5},{x:1,y:0},{x:1,y:1},{x:1,y:2},{x:1,y:3},{x:1.5,y:.5},{x:1.5,y:1.5},{x:1.5,y:2.5},{x:2,y:0},{x:2,y:1},{x:2,y:2},{x:2,y:3},{x:2.5,y:1.5},{x:3,y:1},{x:3,y:2}])(e=>({x:1.3*e.x+.5,y:1.3*e.y+.5})),edges:[new C(0,1),new C(0,2),new C(1,2),new C(0,4),new C(1,5),new C(2,4),new C(2,5),new C(3,4),new C(4,5),new C(5,6),new C(3,7),new C(4,7),new C(4,8),new C(5,8),new C(5,9),new C(6,9),new C(3,10),new C(4,11),new C(5,12),new C(6,13),new C(7,10),new C(7,11),new C(8,11),new C(8,12),new C(9,12),new C(9,13),new C(10,11),new C(11,12),new C(12,13),new C(11,14),new C(12,14),new C(11,15),new C(12,16),new C(14,15),new C(14,16),new C(15,16)]},L=[A,O,T,G,R],q=e=>{var t=b._ext(e),n=p.iso(e=>e)(I)(e.Profunctor0());return e=>t(n(e))},k=e=>{var t=q(e),n=m.lens(e=>e.graph)(e=>t=>({graph:t,graphIndex:e.graphIndex}))(e);return e=>t(n(e))},U=e=>{var t=q(e),n=m.lens(e=>e.graphIndex)(e=>t=>({graphIndex:t,graph:e.graph}))(e);return e=>t(n(e))},B=new b.Game(e=>r.pure(D.applicativeRun)(w.Nothing.value),e=>r.pure(D.applicativeRun)([]),e=>l.length(N(d.viewOn(e)(b._position(v.strongForget))))===l.length(d.viewOn(e)(k(v.strongForget)).edges),e=>r.pure(D.applicativeRun)(h.set(k(g.strongFn))(w.fromMaybe(A)(l.index(L)(d.viewOn(e)(U(v.strongForget)))))(e)),e=>t=>{var n=d.viewOn(e)(b._position(v.strongForget)),a=new f.Tuple(t,l.last(n));return a.value0 instanceof w.Nothing&&a.value1 instanceof w.Just&&a.value1.value0 instanceof w.Just?new w.Just(l.snoc(n)(t)):a.value0 instanceof w.Nothing?w.Nothing.value:a.value0 instanceof w.Just&&a.value1 instanceof w.Just&&a.value1.value0 instanceof w.Just?!u.elem(u.foldableArray)(E)(new C(a.value0.value0,a.value1.value0.value0))(N(n))&&u.elem(u.foldableArray)(E)(new C(a.value0.value0,a.value1.value0.value0))(d.viewOn(e)(k(v.strongForget)).edges)?new w.Just(l.snoc(n)(t)):w.Nothing.value:new w.Just(l.snoc(n)(t))},b.defaultSizeLimit,e=>new f.Tuple(e,!0));o._graphIndex=U,o._graph=k,o.istate=_,o.edgesOf=N,o.nbRaises=x,o.SetGraphIndex=F,o.Play=P,o.update=e=>{if(e instanceof S)return b.coreUpdate(B)(e.value0);if(e instanceof F)return b.newGame(B)(h.set(U(g.strongFn))(e.value0));if(e instanceof P)return b.playA(B)(e.value0);throw new Error("Failed pattern match at Game.Dessin.Model (line 119, column 1 - line 119, column 35): "+[e.constructor.name])},o.gameDessin=B,o.withcore=M}(PS),(e=>{"use strict";e["Game.Dessin.View"]=e["Game.Dessin.View"]||{};var t=e["Game.Dessin.View"],n=e["Control.Apply"],a=e["Control.Bind"],o=e["Data.Array"],r=e["Data.Eq"],i=e["Data.Functor"],l=e["Data.Lens.Getter"],s=e["Data.Lens.Internal.Forget"],u=e["Data.Maybe"],c=e["Data.Semigroup"],d=e["Data.Show"],v=e["Game.Core"],p=e["Game.Dessin.Model"],m=e["Lib.Util"],h=e.Pha,w=e["Pha.Attributes"],g=e["Pha.Elements"],f=e["Pha.Events"],b=e["Pha.Svg"],y=e["UI.Icon"],D=e["UI.Icons"],S=e["UI.Template"],F=e=>t=>u.fromMaybe({x:0,y:0})(o.index(e.vertices)(t)),P=e=>t=>{var n=F(e)(t.value0),a=F(e)(t.value1);return{px1:n.x,px2:a.x,py1:n.y,py2:a.y}},C=e=>t=>b.line([b.x1(d.show(d.showNumber)(100*e.x)),b.y1(d.show(d.showNumber)(100*e.y)),b.x2(d.show(d.showNumber)(20*t.x)),b.y2(d.show(d.showNumber)(20*t.y)),h.class_("dessin-line-to-pointer")]);t.view=e=>{var t=[h.text("blah blah blah blah blah blah blah blah"),g.br,h.text("blah blah blah blah blah blah blah blah")],I=p.nbRaises(e),M=I>1?"s":"",x="Tu as réussi en "+d.show(d.showInt)(I)+" levé"+M,A=l.viewOn(e)(v._position(s.strongForget)),_=l.viewOn(e)(p._graph(s.strongForget)),G=S.card("Dessin")([D.iconSelectGroup(D.defint)(r.eqInt)(e)("Dessin")([0,1,2,3,4])(l.viewOn(e)(p._graphIndex(s.strongForget)))(p.SetGraphIndex.create)(e=>t=>({icon:new y.IconText(d.show(d.showInt)(e+1|0)),selected:t.selected,tooltip:t.tooltip,round:t.round,large:t.large,hidden:t.hidden,disabled:t.disabled,style:t.style})),D.icongroup("Options")(i.mapFlipped(i.functorArray)([D.iundo(p.withcore),D.iredo(p.withcore),D.ireset(p.withcore),D.irules(p.withcore)])(t=>t(e)))]),T=g.div(c.append(c.semigroupArray)(S.trackPointer(p.withcore))([h.class_("ui-board dessin-board"),f.oncontextmenu(new p.Play(u.Nothing.value))]))([b.svg([h.class_("dessin-svg"),b.viewBox(0)(0)(100)(100)])(o.concat([i.mapFlipped(i.functorArray)(_.edges)(e=>{var t=P(_)(e);return b.line([b.x1(d.show(d.showNumber)(20*t.px1)),b.y1(d.show(d.showNumber)(20*t.py1)),b.x2(d.show(d.showNumber)(20*t.px2)),b.y2(d.show(d.showNumber)(20*t.py2)),b.stroke("grey"),b.strokeDasharray("3,1")])}),i.mapFlipped(i.functorArray)(p.edgesOf(l.viewOn(e)(v._position(s.strongForget))))(e=>{var t=P(_)(e);return b.line([b.x1(d.show(d.showNumber)(20*t.px1)),b.y1(d.show(d.showNumber)(20*t.py1)),b.x2(d.show(d.showNumber)(20*t.px2)),b.y2(d.show(d.showNumber)(20*t.py2)),b.stroke("red"),b.strokeWidth("1.5")])}),o.mapWithIndex(e=>t=>b.circle([b.cx(d.show(d.showNumber)(20*t.x)),b.cy(d.show(d.showNumber)(20*t.y)),b.r("3"),b.stroke(r.eq(u.eqMaybe(u.eqMaybe(r.eqInt)))(new u.Just(new u.Just(e)))(o.last(A))?"red":"blue"),b.fill("blue"),f.onclick(new p.Play(new u.Just(e)))]))(_.vertices),[h.maybeN(n.apply(u.applyMaybe)(i.map(u.functorMaybe)(C)(l.viewOn(e)(v._pointer(s.strongForget))))(i.map(u.functorMaybe)(F(_))(a.join(u.bindMaybe)(o.last(A)))))]])),g.span([h.class_("dessin-raise-info dessin-raise-info")])([h.text(d.show(d.showInt)(I)+" levé"+M+" de crayon")]),g.button([h.class_("ui-button ui-button-primary dessin-raise"),w.disabled(!v.canPlay(p.gameDessin)(e)(u.Nothing.value)),f.onclick(new p.Play(u.Nothing.value))])([h.text("Lever le crayon")])]);return S.template(m.precord()())(p.withcore)(p.gameDessin)({config:G,board:T,rules:t,winTitle:x})(e)}})(PS),(e=>{"use strict";e["Game.Dessin"]=e["Game.Dessin"]||{};var t=e["Game.Dessin"],n=e["Data.Function"],a=e["Data.Maybe"],o=e["Game.Core"],r=e["Game.Dessin.Model"],i=e["Game.Dessin.View"],l={init:new a.Just(o.core(r.withcore)(o.Init.value)),view:i.view,onKeydown:n.const(a.Nothing.value)};t.game=l})(PS),(PS["Game.Effs"]=PS["Game.Effs"]||{}).getLoc=()=>Object.assign({},window.location),function(e){"use strict";e["Game.Effs"]=e["Game.Effs"]||{};var t=e["Game.Effs"],n=e["Game.Effs"],a=e["Control.Bind"],o=e["Control.Category"],r=e["Data.Functor"],i=e["Data.Symbol"],l=e.Effect,s=e.Run,u=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),c=new r.Functor(e=>t=>new u(r.map(r.functorFn)(e)(t.value0))),d=i.SProxy.value,v=s.lift()(new i.IsSymbol(()=>"location"))(c)(d)(new u(o.identity(o.categoryFn)));t.getLocation=v,t.interpretLocation=e=>a.bind(l.bindEffect)(n.getLoc)(e.value0)}(PS),(e=>{"use strict";e["Lib.KonamiCode"]=e["Lib.KonamiCode"]||{};var t=e["Lib.KonamiCode"],n=e["Control.Applicative"],a=e["Control.Bind"],o=e["Data.Array"],r=e["Data.Function"],i=e["Data.Lens.Getter"],l=e["Data.Lens.Internal.Forget"],s=e["Data.Lens.Setter"],u=e["Data.Profunctor.Strong"],c=e["Data.String.Common"],d=e["Pha.Action"],v=e.Run;t.konamiCode=e=>t=>p=>a.bind(v.bindRun)(d.getState)(m=>{var h=o.takeEnd(10)(r.flip(o.snoc)(p)(i.viewOn(m)(e(l.strongForget))));return a.discard(a.discardUnit)(v.bindRun)(d.setState(s.set(e(u.strongFn))(h)))(()=>n.when(v.applicativeRun)("ArrowUp ArrowUp ArrowDown ArrowDown ArrowLeft ArrowRight ArrowLeft ArrowRight b a"===c.joinWith(" ")(h))(t))})})(PS),function(e){"use strict";e["Game.Frog.Model"]=e["Game.Frog.Model"]||{};var t=e["Game.Frog.Model"],n=e["Control.Applicative"],a=e["Data.Array"],o=e["Data.Array.NonEmpty"],r=e["Data.Array.NonEmpty.Internal"],i=e["Data.Eq"],l=e["Data.Foldable"],s=e["Data.Functor"],u=e["Data.HeytingAlgebra"],c=e["Data.Lazy"],d=e["Data.Lens.Getter"],v=e["Data.Lens.Index"],p=e["Data.Lens.Internal.Forget"],m=e["Data.Lens.Internal.Wander"],h=e["Data.Lens.Iso"],w=e["Data.Lens.Lens"],g=e["Data.Lens.Setter"],f=e["Data.Maybe"],b=e["Data.Ord"],y=e["Data.Profunctor.Strong"],D=e["Data.Tuple"],S=e["Game.Core"],F=e["Lib.KonamiCode"],P=e["Lib.Util"],C=e["Pha.Action"],I=e.Run,M=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),x=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),A=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),_=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),G=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),T=e=>e,O=new S.MsgWithCore(M.create),E=S.genState(20)(e=>({position:e.position,history:e.history,redoHistory:e.redoHistory,dialog:e.dialog,turn:e.turn,nbRows:20,nbColumns:e.nbColumns,customSize:!0,mode:S.ExpertMode.value,help:e.help,locked:e.locked,showWin:e.showWin,scores:e.scores,pointer:e.pointer}))({moves:o.cons(1)(o.cons(2)(o.singleton(3))),winning:[],marked:[],keySequence:[]}),N=e=>{var t=S._ext(e),n=h.iso(e=>e)(T)(e.Profunctor0());return e=>t(n(e))},R=e=>{var t=N(e),n=w.lens(e=>e.marked)(e=>t=>({marked:t,keySequence:e.keySequence,moves:e.moves,winning:e.winning}))(e);return e=>t(n(e))},L=e=>{var t=N(e),n=w.lens(e=>e.moves)(e=>t=>({moves:t,keySequence:e.keySequence,marked:e.marked,winning:e.winning}))(e);return e=>t(n(e))},q=e=>t=>{var n=d.viewOn(e)(S._position(p.strongForget)),a=d.viewOn(e)(L(p.strongForget)),o=l.foldr(r.foldableNonEmptyArray)(b.max(b.ordInt))(0)(a);return l.elem(r.foldableNonEmptyArray)(i.eqInt)(n-t|0)(a)||n>0&&0===t&&n<=o},k=e=>{var t=N(e),n=w.lens(e=>e.winning)(e=>t=>({winning:t,keySequence:e.keySequence,marked:e.marked,moves:e.moves}))(e);return e=>t(n(e))},U=new S.TwoPlayersGame(()=>B,e=>f.fromMaybe(!0)(a.index(d.viewOn(e)(k(p.strongForget)))(d.viewOn(e)(S._position(p.strongForget)))),e=>a.filter(q(e))(P["range'"](0)(d.viewOn(e)(S._nbRows(p.strongForget))))),B=new S.Game(S["computerMove'"](U),e=>n.pure(I.applicativeRun)(d.viewOn(e)(S._nbRows(p.strongForget))),e=>0===d.viewOn(e)(S._position(p.strongForget)),e=>n.pure(I.applicativeRun)(g.set(R(y.strongFn))(a.replicate(d.viewOn(e)(S._nbRows(p.strongForget))+1|0)(!1))(g.set(k(y.strongFn))((e=>t=>n=>{var o=P.tabulate(t)(t=>c.defer(r=>0===t||l.all(e)(u.heytingAlgebraBoolean)(e=>{return f.maybe(!1)((n=u.not(u.heytingAlgebraBoolean),e=>n(c.force(e))))(a.index(o)(t-e|0));var n})(n)));return s.mapFlipped(s.functorArray)(o)(c.force)})(r.foldableNonEmptyArray)(d.viewOn(e)(S._nbRows(p.strongForget))+1|0)(d.viewOn(e)(L(p.strongForget))))(e))),e=>t=>{return q(e)(t)?new f.Just(t):f.Nothing.value},e=>new S.SizeLimit(5,0,30,0),e=>new D.Tuple(e,!0));t._moves=L,t._marked=R,t.istate=E,t.reachableArray=e=>P.tabulate(d.viewOn(e)(S._nbRows(p.strongForget))+1|0)(q(e)),t.SelectMove=x,t.Mark=A,t.Play=_,t.update=e=>{if(e instanceof M)return S.coreUpdate(B)(e.value0);if(e instanceof x){return S.newGame(B)(g.over(L(y.strongFn))(t=>f.fromMaybe(t)(o.fromArray(a.filter(n=>n===e.value0!==l.elem(r.foldableNonEmptyArray)(i.eqInt)(n)(t))(P["range'"](1)(5))))))}if(e instanceof A)return C.setState(g.over((t=R(y.strongFn),n=v.ix(v.indexArray)(e.value0)(m.wanderFunction),e=>t(n(e))))(u.not(u.heytingAlgebraBoolean)));var t,n;if(e instanceof _)return S.playA(B)(e.value0);if(e instanceof G)return F.konamiCode(e=>(e=>{var t=N(e),n=w.lens(e=>e.keySequence)(e=>t=>({keySequence:t,marked:e.marked,moves:e.moves,winning:e.winning}))(e);return e=>t(n(e))})(e))(C.setState(e=>g.set(R(y.strongFn))(d.viewOn(e)(k(p.strongForget)))(e)))(e.value0);throw new Error("Failed pattern match at Game.Frog.Model (line 75, column 1 - line 75, column 35): "+[e.constructor.name])},t.onKeyDown=e=>f.Just.create(G.create(e)),t.frogGame=B,t.withcore=O}(PS),(e=>{"use strict";e["Game.Frog.View"]=e["Game.Frog.View"]||{};var t=e["Game.Frog.View"],n=e["Control.Category"],a=e["Control.Monad.Except.Trans"],o=e["Data.Array"],r=e["Data.Array.NonEmpty.Internal"],i=e["Data.Eq"],l=e["Data.Function"],s=e["Data.Functor"],u=e["Data.Identity"],c=e["Data.Int"],d=e["Data.Lens.Getter"],v=e["Data.Lens.Internal.Forget"],p=e["Data.Semigroup"],m=e["Data.Show"],h=e["Data.String.Common"],w=e["Game.Core"],g=e["Game.Frog.Model"],f=e["Lib.Util"],b=e.Math,y=e.Pha,D=e["Pha.Elements"],S=e["Pha.Events"],F=e["Pha.Events.Decoder"],P=e["Pha.Svg"],C=e["Pha.Util"],I=e["UI.Icons"],M=e["UI.Template"],x=e=>o.reverse(f.tabulate(e+1|0)(t=>{var n=1.36*b.sqrt(t===e?21:20*c.toNumber(t)/c.toNumber(e))*b.pi;return{theta:n,radius:61*n/(2*b.pi)}})),A=e=>({x:e.radius*b.cos(e.theta),y:e.radius*b.sin(e.theta)}),_=(e=>t=>n=>a=>r=>i=>h.joinWith(" ")(o.concat(o.mapWithIndex(t=>n=>{var a=(e=>t=>n=>a=>{var o=(a-t)/(e-n);return{x:o,y:e*o+t}})(n.value0.slope)(n.value0.intercept)(n.value1.slope)(n.value1.intercept),o=["Q",m.show(m.showNumber)(a.x+e.x),m.show(m.showNumber)(a.y+e.y),m.show(m.showNumber)(n.value1.point.x),m.show(m.showNumber)(n.value1.point.y)];return 0===t?p.append(p.semigroupArray)(["M",m.show(m.showNumber)(n.value0.point.x),m.show(m.showNumber)(n.value0.point.y)])(o):o})(f.pairwise(s.mapFlipped(s.functorArray)(f.floatRange(a)(r)(i))(a=>{var o=n/(2*b.pi),r=t+o*a,i={x:e.x+r*b.cos(a),y:e.y+r*b.sin(a)},l=(o*b.sin(a)+r*b.cos(a))/(o*b.cos(a)-r*b.sin(a));return{point:i,slope:l,intercept:-(l*r*b.cos(a)-r*b.sin(a))}}))))))({x:0,y:0})(0)(61)(0)(37/6*b.pi)(b.pi/6),G=e=>t=>n=>a=>o=>{var r=0===e?[P.x_(m.show(m.showNumber)(t-30)),P.y_(m.show(m.showNumber)(n-45)),P.width("80"),P.height("80")]:[P.x_(m.show(m.showNumber)(t-24)),P.y_(m.show(m.showNumber)(n-24)),P.width("48"),P.height("48")];return P.use("#lily")(p.append(p.semigroupArray)(r)([y.class_("frog-lily"),y["class'"]("reachable")(a),y["class'"]("hidden")(o)]))};t.view=e=>{var t=M.winTitleFor2Players(e),c=(e=>s.mapFlipped(s.functorArray)(x(e))(A))(d.viewOn(e)(w._nbRows(v.strongForget))),p=[y.text("Jeu de la grenouille"),D.br,y.text("Règles pas encore définies")],h=g.reachableArray(e),T=d.viewOn(e)(w._position(v.strongForget)),O=x(d.viewOn(e)(w._nbRows(v.strongForget))),E=D.div([y.class_("ui-board frog-board")])([P.svg([P.viewBox(-190)(-200)(400)(400)])(o.concat([[P.path(_)([P.fill("none"),P.stroke("black"),P.strokeWidth("3")]),P.line([P.x_("153"),P.y_("9"),P.width("207"),P.height("20"),P.stroke("black"),P.strokeDasharray("5"),P.strokeWidth("6")]),P.line([P.x_("153"),P.y_("7"),P.width("153"),P.height("39"),P.stroke("black"),P.strokeWidth("3")]),P.line([P.x_("207"),P.y_("18"),P.width("207"),P.height("50"),P.stroke("black"),P.strokeWidth("3")])],f.map2(c)(h)(t=>n=>o=>{return P.g([y.key("lily"+m.show(m.showInt)(t)),S.on("click")((r=s.map(a.functorExceptT(u.functorIdentity))(e=>e?new g.Mark(t):new g.Play(t)),e=>r(F.shiftKey(e))))])([G(t)(n.x)(n.y)(!1)(!1),G(t)(n.x)(n.y)(!0)(!o||d.viewOn(e)(w._locked(v.strongForget))),P["text'"](d.viewOn(e)(w._help(v.strongForget))?m.show(m.showInt)(d.viewOn(e)(w._nbRows(v.strongForget))-t|0):"")([P.x_(m.show(m.showNumber)(n.x)),P.y_(m.show(m.showNumber)(n.y)),y.class_("frog-index")])]);var r}),f.map2(d.viewOn(e)(g._marked(v.strongForget)))(c)(e=>t=>n=>y.when(t&&e!==T)(t=>P.use("#frog2")([P.x_(m.show(m.showNumber)(n.x-20)),P.y_(m.show(m.showNumber)(n.y-20)),P.width("32"),P.height("32"),y.key("reach"+m.show(m.showInt)(e)),y.class_("frog-frog marked")]))),[y.maybe(o.index(O)(T))(e=>P.g([y.key("frog"),y.class_("frog-frog-container"),y.style("transform")(C.translate(C.px(e.radius))("0")+" rotate("+m.show(m.showNumber)(180*e.theta/b.pi)+"deg)"),y.style("transform-origin")(C.px(-e.radius)+" 0")])([P.g([y.class_("frog-frog-container"),y.style("transform")("rotate("+m.show(m.showNumber)(180*-e.theta/b.pi)+"deg)")])([P.use("#frog2")([P.x_("-20"),P.y_("-20"),P.width("40"),P.height("40"),y.class_("frog-frog"),y["class'"]("goal")(0===T)])])]))]])),D.span([])([y.text(M.turnMessage(g.frogGame)(e))])]),N=M.card("La grenouille")([I.iconSelectGroupM(I.defint)(i.eqInt)(r.foldableNonEmptyArray)(e)("Déplacements autorisés")([1,2,3,4,5])(d.viewOn(e)(g._moves(v.strongForget)))(g.SelectMove.create)(l.const(n.identity(n.categoryFn))),I.icons2Players(g.withcore)(g.frogGame)(e),I.icongroup("Options")(s.mapFlipped(s.functorArray)([I.ihelp(g.withcore),I.iundo(g.withcore),I.iredo(g.withcore),I.ireset(g.withcore),I.irules(g.withcore)])(t=>t(e)))]),R=M.incDecGrid(g.withcore)(g.frogGame)(e)([E]);return M.template(f.precord()())(g.withcore)(g.frogGame)({config:N,board:R,rules:p,winTitle:t})(e)}})(PS),(e=>{"use strict";e["Game.Frog"]=e["Game.Frog"]||{};var t=e["Game.Frog"],n=e["Data.Maybe"],a=e["Game.Core"],o=e["Game.Frog.Model"],r=e["Game.Frog.View"],i={init:new n.Just(a.core(o.withcore)(a.Init.value)),view:r.view,onKeydown:o.onKeyDown};t.game=i})(PS),function(e){"use strict";e["Game.Jetons.Model"]=e["Game.Jetons.Model"]||{};var t,n,a=e["Game.Jetons.Model"],o=e["Control.Applicative"],r=e["Control.Bind"],i=e["Data.Array"],l=e["Data.Eq"],s=e["Data.EuclideanRing"],u=e["Data.Foldable"],c=e["Data.HeytingAlgebra"],d=e["Data.Lens.Getter"],v=e["Data.Lens.Index"],p=e["Data.Lens.Internal.Forget"],m=e["Data.Lens.Internal.Wander"],h=e["Data.Lens.Iso"],w=e["Data.Lens.Lens"],g=e["Data.Lens.Setter"],f=e["Data.Maybe"],b=e["Data.Show"],y=e["Game.Core"],D=e["Lib.Util"],S=e.Run,F=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),P=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),C=e=>e,I=new y.MsgWithDnd(P.create),M=new y.MsgWithCore(F.create),x=new y.ScoreGame(()=>A,e=>!1,e=>y.Minimize.value,(t=i.filter(e=>e>0),n=d.view(y._position(p.strongForget)),e=>i.length(t(n(e)))),e=>b.show(b.showInt)(d.viewOn(e)(y._nbRows(p.strongForget)))+"-"+b.show(b.showInt)(d.viewOn(e)(y._nbColumns(p.strongForget)))),A=new y.Game(e=>o.pure(S.applicativeRun)(f.Nothing.value),e=>o.pure(S.applicativeRun)(i.replicate(d.viewOn(e)(y._nbRows(p.strongForget))*d.viewOn(e)(y._nbColumns(p.strongForget))|0)(1)),e=>{var t=d.viewOn(e)(y._position(p.strongForget)),n=d.viewOn(e)(y._nbColumns(p.strongForget));return u.all(u.foldableArray)(c.heytingAlgebraBoolean)(e=>{var a=f.fromMaybe(0)(i.index(t)(e+n|0)),o=0===s.mod(s.euclideanRingInt)(e+1|0)(n)?0:f.fromMaybe(0)(i.index(t)(e+1|0));return 0==(f.fromMaybe(0)(i.index(t)(e))*(o+a|0)|0)})(D["range'"](0)(i.length(t)-1|0))},y.defaultOnNewGame,e=>t=>{var n=d.viewOn(e)(y._position(p.strongForget)),a=D.dCoords(d.viewOn(e)(y._nbColumns(p.strongForget)))(t.from)(t.to);return r.bind(f.bindMaybe)(i.index(n)(t.from))(e=>r.bind(f.bindMaybe)(i.index(n)(t.to))(o=>{return e>0&&e<=o&&1==((a.row*a.row|0)+(a.col*a.col|0)|0)?f.Just.create(g.over(v.ix(v.indexArray)(t.to)(m.wanderFunction))(t=>t+e|0)(g.set(v.ix(v.indexArray)(t.from)(m.wanderFunction))(0)(n))):f.Nothing.value}))},e=>new y.SizeLimit(1,2,6,12),y["updateScore'"](x)(y.AlwaysShowWin.value)),_=y.genState([])(e=>({position:e.position,history:e.history,redoHistory:e.redoHistory,dialog:e.dialog,turn:e.turn,nbRows:4,nbColumns:4,customSize:e.customSize,mode:e.mode,help:e.help,locked:e.locked,showWin:e.showWin,scores:e.scores,pointer:e.pointer}))({dragged:f.Nothing.value}),G=e=>{var t=(e=>{var t=y._ext(e),n=h.iso(e=>e)(C)(e.Profunctor0());return e=>t(n(e))})(e),n=w.lens(e=>e.dragged)(e=>e=>({dragged:e}))(e);return e=>t(n(e))};a._dragged=G,a.istate=_,a.update=e=>{if(e instanceof F)return y.coreUpdate(A)(e.value0);if(e instanceof P)return y.dndUpdate(l.eqInt)(A)(e=>G(e))(e.value0);throw new Error("Failed pattern match at Game.Jetons.Model (line 66, column 1 - line 66, column 35): "+[e.constructor.name])},a.jetonsGame=A,a.scoregame=x,a.withcore=M,a.withdnd=I}(PS),(e=>{"use strict";e["Game.Jetons.View"]=e["Game.Jetons.View"]||{};var t=e["Game.Jetons.View"],n=e["Control.Apply"],a=e["Data.Array"],o=e["Data.Eq"],r=e["Data.Functor"],i=e["Data.Int"],l=e["Data.Lens.Getter"],s=e["Data.Lens.Internal.Forget"],u=e["Data.Maybe"],c=e["Data.Semigroup"],d=e["Data.Show"],v=e["Data.Tuple"],p=e["Game.Core"],m=e["Game.Jetons.Model"],h=e["Lib.Util"],w=e.Math,g=e.Pha,f=e["Pha.Elements"],b=e["Pha.Util"],y=e["UI.Icons"],D=e["UI.Template"];t.view=e=>{var t=p.scoreFn(m.scoregame)(e),S=t>1?"s":"",F=d.show(d.showInt)(t)+" case"+S+" restante"+S,P=[g.text("A chaque tour de ce jeu, tu peux déplacer une pile de jetons vers une case adjacente"),f.br,g.text("qui contient au moins autant de jetons"),f.br,g.text("Le but est de finir la partie avec le moins de cases contenant des piles de jetons.")],C=l.viewOn(e)(p._nbRows(s.strongForget)),I=l.viewOn(e)(p._position(s.strongForget)),M=D.card("Jeu des jetons")([y.iconSizesGroup(m.withcore)(e)([new v.Tuple(2,2),new v.Tuple(4,4),new v.Tuple(5,5),new v.Tuple(6,6)])(!0),y.icongroup("Options")([y.iundo(m.withcore)(e),y.iredo(m.withcore)(e),y.ireset(m.withcore)(e),y.irules(m.withcore)(e)]),y.iconBestScore(m.withcore)(m.scoregame)(e)]),x=l.viewOn(e)(p._nbColumns(s.strongForget)),A=e=>t=>n=>{var a=h.coords(x)(e);return f.div(c.append(c.semigroupArray)([g.class_("jetons-peg"),g["class'"]("small")(x>=8),g.style("background-color")(b.rgbColor(255)(i.floor(255*(1-w.sqrt(i.toNumber(t)/i.toNumber(C*x|0)))))(0)),g.style("left")(b.pc((.15+i.toNumber(a.col))/i.toNumber(x))),g.style("top")(b.pc((.15+i.toNumber(a.row))/i.toNumber(C))),g.style("width")(b.pc(.7/i.toNumber(x))),g.style("height")(b.pc(.7/i.toNumber(C))),g.style("box-shadow")(d.show(d.showInt)(2*t|0)+"px "+d.show(d.showInt)(2*t|0)+"px 5px 0px #656565")])(n))([f.span([])([g.text(d.show(d.showInt)(t))])])},_=D.incDecGrid(m.withcore)(m.jetonsGame)(e)([f.div(c.append(c.semigroupArray)([g.class_("ui-board")])(c.append(c.semigroupArray)(D.dndBoardProps(m.withcore)(m.withdnd))(D.gridStyle(C)(x)(3))))(a.concat([a.mapWithIndex(t=>n=>g.when(0!==n)(a=>A(t)(n)(c.append(c.semigroupArray)([g.key(d.show(d.showInt)(t))])(D.dndItemProps(o.eqInt)(m.withdnd)(m.jetonsGame)({currentDragged:l.viewOn(e)(m._dragged(s.strongForget)),draggable:!0,droppable:!0,id:t})(e)))))(I),[g.maybeN(n.apply(u.applyMaybe)(r.map(u.functorMaybe)(e=>t=>f.div(c.append(c.semigroupArray)([g["class'"]("ui-cursor jetons-cursor")(!0)])(D.cursorStyle(e)(C)(x)(.6)))([]))(l.viewOn(e)(p._pointer(s.strongForget))))(l.viewOn(e)(m._dragged(s.strongForget))))]]))]);return D.template(h.precord()())(m.withcore)(m.jetonsGame)({config:M,board:_,rules:P,winTitle:F,scoreDialog:t=>D.bestScoreDialog(m.withcore)(m.scoregame)(e)(e=>[f.div([g["class'"]("ui-flex-center jetons-bestscore-grid-container")(!0)])([f.div(c.append(c.semigroupArray)(D.gridStyle(C)(x)(3))([g["class'"]("ui-board")(!0)]))(a.mapWithIndex(e=>t=>g.when(0!==t)(n=>A(e)(t)([g.key(d.show(d.showInt)(e))])))(e))])])})(e)}})(PS),(e=>{"use strict";e["Game.Jetons"]=e["Game.Jetons"]||{};var t=e["Game.Jetons"],n=e["Data.Function"],a=e["Data.Maybe"],o=e["Game.Core"],r=e["Game.Jetons.Model"],i=e["Game.Jetons.View"],l={init:new a.Just(o.core(r.withcore)(o.Init.value)),view:i.view,onKeydown:n.const(a.Nothing.value)};t.game=l})(PS),function(e){"use strict";e["Game.Labete.Model"]=e["Game.Labete.Model"]||{};var t,n,a=e["Game.Labete.Model"],o=e["Control.Applicative"],r=e["Control.Bind"],i=e["Control.Category"],l=e["Data.Array"],s=e["Data.Eq"],u=e["Data.EuclideanRing"],c=e["Data.Foldable"],d=e["Data.Functor"],v=e["Data.HeytingAlgebra"],p=e["Data.Lens.Getter"],m=e["Data.Lens.Index"],h=e["Data.Lens.Internal.Forget"],w=e["Data.Lens.Internal.Wander"],g=e["Data.Lens.Iso"],f=e["Data.Lens.Lens"],b=e["Data.Lens.Setter"],y=e["Data.Maybe"],D=e["Data.Ord"],S=e["Data.Profunctor"],F=e["Data.Profunctor.Strong"],P=e["Data.Show"],C=e["Data.String.Common"],I=e["Data.Tuple"],M=e["Game.Common"],x=e["Game.Core"],A=e["Lib.Util"],_=e["Pha.Action"],G=e.Run,T=(()=>{function e(){}return e.value=new e,e})(),O=(()=>{function e(){}return e.value=new e,e})(),E=(()=>{function e(){}return e.value=new e,e})(),N=(()=>{function e(){}return e.value=new e,e})(),R=(()=>{function e(){}return e.value=new e,e})(),L=(()=>{function e(){}return e.value=new e,e})(),q=(()=>{function e(){}return e.value=new e,e})(),k=(()=>{function e(){}return e.value=new e,e})(),U=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),B=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),J=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),W=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),z=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),j=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),V=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),H=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),Q=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),K=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),Z=e=>e,X=new x.MsgWithCore(U.create),Y=[{row:0,col:0},{row:0,col:1},{row:1,col:1}],$=[{row:0,col:0},{row:0,col:1},{row:0,col:-1}],ee=[{row:0,col:0},{row:0,col:1}],te=new P.Show(e=>{if(e instanceof T)return"standard";if(e instanceof O)return"cylinder";if(e instanceof E)return"torus";throw new Error("Failed pattern match at Game.Labete.Model (line 15, column 1 - line 18, column 32): "+[e.constructor.name])}),ne=new P.Show(e=>{if(e instanceof N)return"type1";if(e instanceof R)return"type2";if(e instanceof L)return"type3";if(e instanceof q)return"type4";if(e instanceof k)return"custom";throw new Error("Failed pattern match at Game.Labete.Model (line 35, column 1 - line 40, column 32): "+[e.constructor.name])}),ae=d.map(d.functorArray)(e=>({row:0|-e.col,col:e.row})),oe=x.genState([])(e=>({position:e.position,history:e.history,redoHistory:e.redoHistory,dialog:e.dialog,turn:e.turn,nbRows:5,nbColumns:5,customSize:e.customSize,mode:e.mode,help:e.help,locked:e.locked,showWin:e.showWin,scores:e.scores,pointer:e.pointer}))({beast:[ee],beastType:N.value,mode:T.value,startSquare:y.Nothing.value,startPointer:y.Nothing.value,squareColors:[],selectedColor:0}),re=new s.Eq(e=>t=>e instanceof T&&t instanceof T||(e instanceof O&&t instanceof O||e instanceof E&&t instanceof E)),ie=new s.Eq(e=>t=>e instanceof N&&t instanceof N||(e instanceof R&&t instanceof R||(e instanceof L&&t instanceof L||(e instanceof q&&t instanceof q||e instanceof k&&t instanceof k)))),le=e=>{var t=ae(e),n=ae(t);return[e,t,n,ae(n)]},se=e=>{var t=x._ext(e),n=g.iso(e=>e)(Z)(e.Profunctor0());return e=>t(n(e))},ue=e=>{var t=se(e),n=f.lens(e=>e.mode)(e=>t=>({mode:t,beast:e.beast,beastType:e.beastType,selectedColor:e.selectedColor,squareColors:e.squareColors,startPointer:e.startPointer,startSquare:e.startSquare}))(e);return e=>t(n(e))},ce=e=>{var t=se(e),n=f.lens(e=>e.selectedColor)(e=>t=>({selectedColor:t,beast:e.beast,beastType:e.beastType,mode:e.mode,squareColors:e.squareColors,startPointer:e.startPointer,startSquare:e.startSquare}))(e);return e=>t(n(e))},de=e=>{var t=se(e),n=f.lens(e=>e.squareColors)(e=>t=>({squareColors:t,beast:e.beast,beastType:e.beastType,mode:e.mode,selectedColor:e.selectedColor,startPointer:e.startPointer,startSquare:e.startSquare}))(e);return e=>t(n(e))},ve=e=>{var t=se(e),n=f.lens(e=>e.startPointer)(e=>t=>({startPointer:t,beast:e.beast,beastType:e.beastType,mode:e.mode,selectedColor:e.selectedColor,squareColors:e.squareColors,startSquare:e.startSquare}))(e);return e=>t(n(e))},pe=e=>{var t=se(e),n=f.lens(e=>e.startSquare)(e=>t=>({startSquare:t,beast:e.beast,beastType:e.beastType,mode:e.mode,selectedColor:e.selectedColor,squareColors:e.squareColors,startPointer:e.startPointer}))(e);return e=>t(n(e))},me=e=>{var t=se(e),n=f.lens(e=>e.beastType)(e=>t=>({beastType:t,beast:e.beast,mode:e.mode,selectedColor:e.selectedColor,squareColors:e.squareColors,startPointer:e.startPointer,startSquare:e.startSquare}))(e);return e=>t(n(e))},he=e=>{var t=se(e),n=f.lens(e=>e.beast)(e=>t=>({beast:t,beastType:e.beastType,mode:e.mode,selectedColor:e.selectedColor,squareColors:e.squareColors,startPointer:e.startPointer,startSquare:e.startSquare}))(e);return e=>t(n(e))},we=e=>{var t=p.viewOn(e)(x._nbRows(h.strongForget)),n=p.viewOn(e)(x._nbColumns(h.strongForget)),a=c.all(c.foldableArray)(v.heytingAlgebraBoolean)(a=>a.row>=0&&a.row<t&&a.col>=0&&a.col<n&&s.eq(y.eqMaybe(s.eqBoolean))(l.index(p.viewOn(e)(x._position(h.strongForget)))((a.row*n|0)+a.col|0))(new y.Just(!1)));return l.filter(a)(d.mapFlipped(d.functorArray)((e=>t=>l.concatMap(r.composeKleisli(r.bindArray)(le)((e=>t=>n=>A.tabulate2(e)(t)(e=>t=>(e=>t=>d.map(d.functorArray)(n=>({row:n.row+e|0,col:n.col+t|0})))(e)(t)(n)))(e)(t))))(t)(n)(p.viewOn(e)(he(h.strongForget))))((e=>t=>n=>d.map(d.functorArray)(a=>{if(n instanceof T)return{row:a.row,col:a.col};if(n instanceof O)return{row:a.row,col:u.mod(u.euclideanRingInt)(a.col)(t)};if(n instanceof E)return{row:u.mod(u.euclideanRingInt)(a.row)(e),col:u.mod(u.euclideanRingInt)(a.col)(t)};throw new Error("Failed pattern match at Game.Labete.Model (line 109, column 24 - line 112, column 83): "+[n.constructor.name])}))(t)(n)(p.viewOn(e)(ue(h.strongForget)))))},ge=new x.ScoreGame(()=>fe,e=>s.eq(ie)(p.viewOn(e)(me(h.strongForget)))(k.value),e=>x.Minimize.value,(t=l.filter(i.identity(i.categoryFn)),n=p.view(x._position(h.strongForget)),e=>l.length(t(n(e)))),e=>C.joinWith("-")([P.show(P.showInt)(p.viewOn(e)(x._nbColumns(h.strongForget))),P.show(P.showInt)(p.viewOn(e)(x._nbRows(h.strongForget))),P.show(te)(p.viewOn(e)(ue(h.strongForget))),P.show(ne)(p.viewOn(e)(me(h.strongForget)))])),fe=new x.Game(e=>o.pure(G.applicativeRun)(y.Nothing.value),e=>o.pure(G.applicativeRun)(l.replicate(p.viewOn(e)(x._nbRows(h.strongForget))*p.viewOn(e)(x._nbColumns(h.strongForget))|0)(!1)),e=>l.null(we(e)),e=>o.pure(G.applicativeRun)(b.set(de(F.strongFn))(l.replicate(p.viewOn(e)(x._nbRows(h.strongForget))*p.viewOn(e)(x._nbColumns(h.strongForget))|0)(0))(b.set(he(F.strongFn))((e=>{var t=p.viewOn(e)(me(h.strongForget));if(t instanceof N)return[ee];if(t instanceof R)return[$];if(t instanceof L)return[Y];if(t instanceof q)return[$,Y];if(t instanceof k)return l.take(1)(p.viewOn(e)(he(h.strongForget)));throw new Error("Failed pattern match at Game.Labete.Model (line 142, column 21 - line 147, column 42): "+[t.constructor.name])})(e))(e))),e=>t=>l.modifyAt(t)(v.not(v.heytingAlgebraBoolean))(p.viewOn(e)(x._position(h.strongForget))),e=>new x.SizeLimit(2,2,9,9),x["updateScore'"](ge)(x.ShowWinOnNewRecord.value));a.StandardMode=T,a.CylinderMode=O,a.TorusMode=E,a.Type1=N,a.Type2=R,a.Type3=L,a.Type4=q,a.CustomBeast=k,a._beast=he,a._beastType=me,a._mode=ue,a._selectedColor=ce,a._squareColors=de,a._startPointer=ve,a.istate=oe,a.nonTrappedBeastOnGrid=e=>{var t=p.viewOn(e)(x._nbRows(h.strongForget)),n=p.viewOn(e)(x._nbColumns(h.strongForget));return c.foldr(c.foldableArray)(e=>b.set(m.ix(m.indexArray)((e.row*n|0)+e.col|0)(w.wanderFunction))(!0))(l.replicate(t*n|0)(!1))(y.fromMaybe([])((e=>l.index(e)(u.mod(u.euclideanRingInt)(28921)(l.length(e))))(we(e))))},a.SetMode=B,a.SetHelp=J,a.SetBeast=W,a.Play=z,a.StartZone=V,a.StartZone2=H,a.FinishZone=Q,a.FlipCustomBeast=K,a.update=e=>{if(e instanceof U)return x.coreUpdate(fe)(e.value0);if(e instanceof B)return x.newGame(fe)(b.set(ue(F.strongFn))(e.value0));if(e instanceof J)return _.setState(b.set(x._help(F.strongFn))(e.value0));if(e instanceof W)return x.newGame(fe)((t=b.set(me(F.strongFn))(e.value0),n=(()=>{if(s.eq(ie)(e.value0)(k.value)){var t=b.set(x._dialog(F.strongFn))(x.CustomDialog.value),n=b.over(he(F.strongFn))(l.take(1));return e=>t(n(e))}return i.identity(i.categoryFn)})(),e=>t(n(e))));var t,n,a,o,r,g;if(e instanceof j)return _.setState(b.over(ce(F.strongFn))(t=>u.mod(u.euclideanRingInt)(t+e.value0|0)(9)));if(e instanceof V)return _.setState(b.set(pe(F.strongFn))(new y.Just(e.value0)));if(e instanceof H)return _.setState(b.set(ve(F.strongFn))(new y.Just(e.value0)));if(e instanceof Q)return _.setState(t=>{var n=p.viewOn(t)(pe(h.strongForget));if(n instanceof y.Nothing)return t;if(n instanceof y.Just){var a=A.coords(p.viewOn(t)(x._nbColumns(h.strongForget)))(e.value0),o=A.coords(p.viewOn(t)(x._nbColumns(h.strongForget)))(n.value0);return b.set(ve(F.strongFn))(y.Nothing.value)(b.set(pe(F.strongFn))(y.Nothing.value)(b.set(de(F.strongFn))((e=>t=>l.updateAtIndices(c.foldableArray)(d.mapFlipped(d.functorArray)((e=>t=>A.tabulate2(A.abs(t.row1-t.row2|0)+1|0)(A.abs(t.col1-t.col2|0)+1|0)(n=>a=>(((n+D.min(D.ordInt)(t.row1)(t.row2)|0)*e|0)+a|0)+D.min(D.ordInt)(t.col1)(t.col2)|0))(p.viewOn(e)(x._nbColumns(h.strongForget)))(t))(t=>new I.Tuple(t,p.viewOn(e)(ce(h.strongForget)))))(p.viewOn(e)(de(h.strongForget))))(t)({row1:a.row,col1:a.col,row2:o.row,col2:o.col}))(t)))}throw new Error("Failed pattern match at Game.Labete.Model (line 200, column 49 - line 207, column 44): "+[n.constructor.name])});if(e instanceof K)return x.newGame(fe)(b.over((a=he(F.strongFn),o=m.ix(m.indexArray)(0)(w.wanderFunction),r=M._isoCustom(S.profunctorFn),g=m.ix(m.indexArray)(e.value0)(w.wanderFunction),e=>a(o(r(g(e))))))(v.not(v.heytingAlgebraBoolean)));if(e instanceof z)return x.playA(fe)(e.value0);throw new Error("Failed pattern match at Game.Labete.Model (line 182, column 1 - line 182, column 35): "+[e.constructor.name])},a.onKeyDown=e=>"o"===e?new y.Just(new j(-1)):"p"===e?new y.Just(new j(1)):y.Nothing.value,a.eqMode=re,a.eqBt=ie,a.labeteGame=fe,a.scoregameLabete=ge,a.withcore=X}(PS),(e=>{"use strict";e["Game.Labete.View"]=e["Game.Labete.View"]||{};var t=e["Game.Labete.View"],n=e["Control.Applicative"],a=e["Control.Bind"],o=e["Control.Monad.Except.Trans"],r=e["Data.Array"],i=e["Data.Functor"],l=e["Data.Identity"],s=e["Data.Lens.Getter"],u=e["Data.Lens.Index"],c=e["Data.Lens.Internal.Forget"],d=e["Data.Maybe"],v=e["Data.Monoid"],p=e["Data.Ord"],m=e["Data.Semigroup"],h=e["Data.Show"],w=e["Data.Tuple"],g=e["Game.Common"],f=e["Game.Core"],b=e["Game.Labete.Model"],y=e["Lib.Util"],D=e.Math,S=e.Pha,F=e["Pha.Elements"],P=e["Pha.Events"],C=e["Pha.Events.Decoder"],I=e["Pha.Svg"],M=e["Pha.Util"],x=e["UI.Icon"],A=e["UI.Icons"],_=e["UI.Template"],G=[b.StandardMode.value,b.CylinderMode.value,b.TorusMode.value],T=e=>A.iconbutton(y.precord()())(e)({icon:new x.IconSymbol("#help"),tooltip:new d.Just("Aide"),selected:s.viewOn(e)(f._help(c.strongForget))})([P.onpointerdown(new b.SetHelp(!0)),P.onpointerup(new b.SetHelp(!1)),P.onpointerleave(new b.SetHelp(!1))]),O=["#5aa02c","blue","red","yellow","magenta","cyan","orange","darkgreen","grey"],E=e=>t=>I.g(m.append(m.semigroupArray)([I.transform(M.translate(h.show(h.showInt)(50*e.col|0))(h.show(h.showInt)(50*e.row|0)))])(t))([I.use("#grass")([I.width("50"),I.height("50"),I.fill(d.fromMaybe("")(r.index(O)(e.color)))]),I.rect([I.width("51"),I.height("51"),I.stroke("black"),I.strokeWidth("0.5"),I.fill("transparent")]),I.use("#paw")([I.x_("5"),I.y_("5"),I.width("40"),I.height("40"),S.class_("labete-beast"),S["class'"]("visible")(e.hasBeast)]),S.when(e.hasTrap)(e=>I.use("#trap")([I.x_("5"),I.y_("5"),I.width("40"),I.height("40")]))]);t.view=e=>{var t="Record: "+h.show(h.showInt)(f.scoreFn(b.scoregameLabete)(e))+" pièges",N=[S.text("Place le moins de pièges possible pour empécher la bête d'abimer ta belle pelouse!"),F.br,S.text("Tu peux choisir de jouer avec des bêtes de différentes formes comme celles préfinies dans 'Forme de la bête'"),F.br,S.text("Dans le dernier choix, la bête peut prendre soit une ou l'autre des formes indiquées."),F.br,S.text("Le plateau de jeu peut prendre une grille, un cylindre ou un tore")],R=s.viewOn(e)(f._nbRows(c.strongForget)),L=b.nonTrappedBeastOnGrid(e),q=e=>I.use("#trap")(m.append(m.semigroupArray)(_.svgCursorStyle(e))([S.key("cursor"),I.x_("-20"),I.y_("-20"),I.width("40"),I.height("40"),S.attr("opacity")("0.7"),S.attr("pointer-events")("none")])),k=s.viewOn(e)(f._nbColumns(c.strongForget)),U=F.div(m.append(m.semigroupArray)(_.gridStyle(R)(k)(5))(m.append(m.semigroupArray)(_.trackPointer(b.withcore))([S.class_("ui-board"),P["on'"]("pointerdown")(e=>a.bind(o.bindExceptT(l.monadIdentity))(C.shiftKey(e))(t=>t?i.map(o.functorExceptT(l.functorIdentity))(i.map(i.functorFn)(d.Just.create)(b.StartZone2.create))(g.pointerDecoder(e)):n.pure(o.applicativeExceptT(l.monadIdentity))(d.Nothing.value)))])))([I.svg([I.viewBox(0)(0)(50*k|0)(50*R|0)])(m.append(m.semigroupArray)(y.map3(s.viewOn(e)(f._position(c.strongForget)))(L)(s.viewOn(e)(b._squareColors(c.strongForget)))(t=>n=>a=>r=>{var u,v,p=y.coords(k)(t);return E({color:r,row:p.row,col:p.col,hasTrap:n,hasBeast:a&&s.viewOn(e)(f._help(c.strongForget))})([S.key(h.show(h.showInt)(t)),P["on'"]("click")((v=i.map(o.functorExceptT(l.functorIdentity))(e=>e?d.Nothing.value:new d.Just(new b.Play(t))),e=>v(C.shiftKey(e)))),P.onpointerup(new b.FinishZone(t)),P["on'"]("pointerdown")((u=i.map(o.functorExceptT(l.functorIdentity))(e=>e?new d.Just(new b.StartZone(t)):d.Nothing.value),e=>u(C.shiftKey(e))))])}))([S.maybeN((()=>{var t=s.viewOn(e)(b._startPointer(c.strongForget));if(t instanceof d.Nothing)return i.map(d.functorMaybe)(q)(s.viewOn(e)(f._pointer(c.strongForget)));if(t instanceof d.Just)return i.map(d.functorMaybe)((e=>t=>n=>I.rect([I.x_(M.pc(p.min(p.ordNumber)(t.x)(n.x))),I.y_(M.pc(p.min(p.ordNumber)(t.y)(n.y))),I.width(M.pc(D.abs(n.x-t.x))),I.height(M.pc(D.abs(n.y-t.y))),S.key("zone"),I.stroke("black"),I.fill(d.fromMaybe("")(r.index(O)(e))),S.attr("pointer-events")("none"),S.attr("opacity")("0.4")]))(s.viewOn(e)(b._selectedColor(c.strongForget)))(t.value0))(s.viewOn(e)(f._pointer(c.strongForget)));throw new Error("Failed pattern match at Game.Labete.View (line 119, column 26 - line 121, column 81): "+[t.constructor.name])})())]))]),B=_.incDecGrid(b.withcore)(b.labeteGame)(e)([U,S.when(s.viewOn(e)(b._selectedColor(c.strongForget))>0)(t=>F.div([S.class_("labete-color"),S.style("background-color")(d.fromMaybe("")(r.index(O)(s.viewOn(e)(b._selectedColor(c.strongForget)))))])([]))]),J=[b.Type1.value,b.Type2.value,b.Type3.value,b.Type4.value,b.CustomBeast.value],W=_.card("La bête")([A.iconSelectGroup(A.defa)(b.eqBt)(e)("Forme de la bête")(J)(s.viewOn(e)(b._beastType(c.strongForget)))(b.SetBeast.create)(e=>{if(e instanceof b.Type1)return e=>({icon:new x.IconSymbol("#beast1"),selected:e.selected,tooltip:e.tooltip,round:e.round,large:e.large,hidden:e.hidden,disabled:e.disabled,style:e.style});if(e instanceof b.Type2)return e=>({icon:new x.IconSymbol("#beast2"),selected:e.selected,tooltip:e.tooltip,round:e.round,large:e.large,hidden:e.hidden,disabled:e.disabled,style:e.style});if(e instanceof b.Type3)return e=>({icon:new x.IconSymbol("#beast3"),selected:e.selected,tooltip:e.tooltip,round:e.round,large:e.large,hidden:e.hidden,disabled:e.disabled,style:e.style});if(e instanceof b.Type4)return e=>({icon:new x.IconSymbol("#beast23"),selected:e.selected,tooltip:e.tooltip,round:e.round,large:e.large,hidden:e.hidden,disabled:e.disabled,style:e.style});if(e instanceof b.CustomBeast)return e=>({icon:new x.IconSymbol("#customize"),selected:e.selected,tooltip:e.tooltip,round:e.round,large:e.large,hidden:e.hidden,disabled:e.disabled,style:e.style});throw new Error("Failed pattern match at Game.Labete.View (line 67, column 94 - line 72, column 65): "+[e.constructor.name])}),A.iconSelectGroup(A.defa)(b.eqMode)(e)("Type de la grille")(G)(s.viewOn(e)(b._mode(c.strongForget)))(b.SetMode.create)(e=>{if(e instanceof b.StandardMode)return e=>({icon:new x.IconSymbol("#grid-normal"),selected:e.selected,tooltip:new d.Just("Normale"),round:e.round,large:e.large,hidden:e.hidden,disabled:e.disabled,style:e.style});if(e instanceof b.CylinderMode)return e=>({icon:new x.IconSymbol("#grid-cylinder"),selected:e.selected,tooltip:new d.Just("Cylindrique"),round:e.round,large:e.large,hidden:e.hidden,disabled:e.disabled,style:e.style});if(e instanceof b.TorusMode)return e=>({icon:new x.IconSymbol("#grid-torus"),selected:e.selected,tooltip:new d.Just("Torique"),round:e.round,large:e.large,hidden:e.hidden,disabled:e.disabled,style:e.style});throw new Error("Failed pattern match at Game.Labete.View (line 73, column 84 - line 76, column 90): "+[e.constructor.name])}),A.iconSizesGroup(b.withcore)(e)([new w.Tuple(3,3),new w.Tuple(5,5),new w.Tuple(6,6)])(!0),A.icongroup("Options")([T(e),A.ireset(b.withcore)(e),A.irules(b.withcore)(e)]),A.iconBestScore(b.withcore)(b.scoregameLabete)(e)]);return _.template(y.precord()())(b.withcore)(b.labeteGame)({config:W,board:B,rules:N,winTitle:t,customDialog:t=>{return _.dialog(b.withcore)("Personnalise ta bête")([F.div([S.class_("labete-custombeast-grid-container")])([I.svg([I.viewBox(0)(0)(250)(250)])(r.mapWithIndex(e=>t=>{var n=y.coords(5)(e);return E({row:n.row,col:n.col,hasBeast:t,hasTrap:!1,color:0})([S.key(h.show(h.showInt)(e)),P.onclick(new b.FlipCustomBeast(e))])})(s.viewOn(e)((n=b._beast(c.strongForget),a=u.ix(u.indexArray)(0)(c.wanderForget(v.monoidArray)),o=g._isoCustom(c.profunctorForget),e=>n(a(o(e)))))))])]);var n,a,o},scoreDialog:t=>_.bestScoreDialog(b.withcore)(b.scoregameLabete)(e)(e=>[F.div([S.class_("ui-flex-center labete-bestscore-grid-container")])([F.div(m.append(m.semigroupArray)(_.gridStyle(R)(k)(5))([S.class_("ui-board")]))([I.svg([I.viewBox(0)(0)(50*k|0)(50*R|0)])(r.mapWithIndex(e=>t=>{var n=y.coords(k)(e);return E({color:0,row:n.row,col:n.col,hasTrap:t,hasBeast:!1})([S.key(h.show(h.showInt)(e))])})(e))])])])})(e)}})(PS),(e=>{"use strict";e["Game.Labete"]=e["Game.Labete"]||{};var t=e["Game.Labete"],n=e["Data.Maybe"],a=e["Game.Core"],o=e["Game.Labete.Model"],r=e["Game.Labete.View"],i={init:new n.Just(a.core(o.withcore)(a.Init.value)),view:r.view,onKeydown:o.onKeyDown};t.game=i})(PS),function(e){"use strict";e["Game.Nim.Model"]=e["Game.Nim.Model"]||{};var t,n,a,o=e["Game.Nim.Model"],r=e["Control.Applicative"],i=e["Control.Bind"],l=e["Data.Array"],s=e["Data.Eq"],u=e["Data.Foldable"],c=e["Data.HeytingAlgebra"],d=e["Data.Int.Bits"],v=e["Data.Lens.Getter"],p=e["Data.Lens.Internal.Forget"],m=e["Data.Lens.Iso"],h=e["Data.Lens.Lens"],w=e["Data.Lens.Setter"],g=e["Data.Maybe"],f=e["Data.Ord"],b=e["Data.Profunctor.Strong"],y=e["Data.Traversable"],D=e["Data.Tuple"],S=e["Game.Core"],F=e["Lib.Util"],P=e["Pha.Effects.Random"],C=e.Run,I=function(){function e(e,t){this.value0=e,this.value1=t}return e.create=t=>n=>new e(t,n),e}(),M=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),x=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),A=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),_=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),G=e=>e,T=new S.MsgWithCore(M.create),O=S.genState([])(e=>({position:e.position,history:e.history,redoHistory:e.redoHistory,dialog:e.dialog,turn:e.turn,nbRows:e.nbRows,nbColumns:e.nbColumns,customSize:e.customSize,mode:S.ExpertMode.value,help:e.help,locked:e.locked,showWin:e.showWin,scores:e.scores,pointer:e.pointer}))({length:10,nbPiles:4}),E=e=>t=>{var n=l.index(v.viewOn(e)(S._position(p.strongForget)))(t.value0);if(n instanceof g.Nothing)return!1;if(n instanceof g.Just)return t.value1!==n.value0.value0&&t.value1!==n.value0.value1&&(s.eq(S.eqTurn)(v.viewOn(e)(S._turn(p.strongForget)))(S.Turn1.value)?t.value1<n.value0.value1:t.value1>n.value0.value0);throw new Error("Failed pattern match at Game.Nim.Model (line 34, column 5 - line 36, column 105): "+[n.constructor.name])},N=e=>{var t=S._ext(e),n=m.iso(e=>e)(G)(e.Profunctor0());return e=>t(n(e))},R=e=>{var t=N(e),n=h.lens(e=>e.length)(e=>t=>({length:t,nbPiles:e.nbPiles}))(e);return e=>t(n(e))},L=e=>{var t=N(e),n=h.lens(e=>e.nbPiles)(e=>t=>({nbPiles:t,length:e.length}))(e);return e=>t(n(e))},q=new S.TwoPlayersGame(()=>k,(t=s.eq(s.eqInt)(0),n=u.foldr(u.foldableArray)(e=>d.xor((D.snd(e)-D.fst(e)|0)-1|0))(0),a=v.view(S._position(p.strongForget)),e=>t(n(a(e)))),e=>l.sortWith(f.ordInt)(t=>g.maybe(0)(n=>{return s.eq(S.eqTurn)(v.viewOn(e)(S._turn(p.strongForget)))(S.Turn1.value)?D.fst(n)-t.value1|0:t.value1-D.snd(n)|0})(l.index(v.viewOn(e)(S._position(p.strongForget)))(t.value0)))(l.filter(E(e))(F.tabulate2(v.viewOn(e)(L(p.strongForget)))(v.viewOn(e)(R(p.strongForget)))(I.create)))),k=new S.Game(S["computerMove'"](q),e=>y.sequence(y.traversableArray)(C.applicativeRun)(l.replicate(v.viewOn(e)(L(p.strongForget)))(5===v.viewOn(e)(R(p.strongForget))?r.pure(C.applicativeRun)(new D.Tuple(0,4)):i.bind(C.bindRun)(P.randomInt(5))(e=>i.bind(C.bindRun)(P.randomInt(5))(t=>r.pure(C.applicativeRun)(new D.Tuple(e,t+5|0)))))),e=>u.all(u.foldableArray)(c.heytingAlgebraBoolean)(t=>1==(t.value1-t.value0|0)&&t.value0===(s.eq(S.eqTurn)(v.viewOn(e)(S._turn(p.strongForget)))(S.Turn2.value)?v.viewOn(e)(R(p.strongForget))-2|0:0))(v.viewOn(e)(S._position(p.strongForget))),S.defaultOnNewGame,e=>t=>{return E(e)(t)?l.modifyAt(t.value0)(n=>{return s.eq(S.eqTurn)(v.viewOn(e)(S._turn(p.strongForget)))(S.Turn1.value)?new D.Tuple(t.value1,n.value1):new D.Tuple(n.value0,t.value1)})(v.viewOn(e)(S._position(p.strongForget))):g.Nothing.value},S.defaultSizeLimit,e=>new D.Tuple(e,!0));o.Move=I,o.istate=O,o._length=R,o._nbPiles=L,o.SetNbPiles=x,o.SetLength=A,o.Play=_,o.update=e=>{if(e instanceof M)return S.coreUpdate(k)(e.value0);if(e instanceof x)return S.newGame(k)(w.set(L(b.strongFn))(e.value0));if(e instanceof A)return S.newGame(k)(w.set(R(b.strongFn))(e.value0));if(e instanceof _)return S.playA(k)(e.value0);throw new Error("Failed pattern match at Game.Nim.Model (line 75, column 1 - line 75, column 35): "+[e.constructor.name])},o.nimGame=k,o.withcore=T}(PS),(e=>{"use strict";e["Game.Nim.View"]=e["Game.Nim.View"]||{};var t=e["Game.Nim.View"],n=e["Control.Category"],a=e["Data.Array"],o=e["Data.Eq"],r=e["Data.Function"],i=e["Data.Functor"],l=e["Data.Lens.Getter"],s=e["Data.Lens.Internal.Forget"],u=e["Data.Show"],c=e["Data.Tuple"],d=e["Game.Core"],v=e["Game.Nim.Model"],p=e["Lib.Util"],m=e.Pha,h=e["Pha.Elements"],w=e["Pha.Events"],g=e["Pha.Svg"],f=e["Pha.Util"],b=e["UI.Icons"],y=e["UI.Template"],D=e=>u.show(u.showInt)(e)+"px";t.view=e=>{var t="Les "+(o.eq(d.eqTurn)(l.viewOn(e)(d._turn(s.strongForget)))(d.Turn2.value)?"bleu":"rouge")+"s gagnent",S=[m.text("Essaie de bloquer ton adversaire"),h.br,m.text("A chaque tour, tu peux déplacer un de tes jetons vers la gauche ou vers la droite"),h.br,m.text("d'autant de cases que tu veux mais tu ne peux pas sauter par dessus le jeton adversaire."),h.br,m.text("Tu es obligé de déplacer un jeton d'au moins une case, tu ne peux pas passer ton tour."),h.br,m.text("Tu gagnes la partie si ton adversaire n'a aucun mouvement possible.")],F=l.viewOn(e)(v._nbPiles(s.strongForget)),P=l.viewOn(e)(v._length(s.strongForget)),C=y.card("Poker Nim")([b.iconSelectGroup(b.defint)(o.eqInt)(e)("Nombre de rangées")([1,2,3,4,5])(F)(v.SetNbPiles.create)(r.const(n.identity(n.categoryFn))),b.iconSelectGroup(b.defint)(o.eqInt)(e)("Taille des rangées")([10,5])(P)(v.SetLength.create)(r.const(n.identity(n.categoryFn))),b.icons2Players(v.withcore)(v.nimGame)(e),b.icongroup("Options")(i.mapFlipped(i.functorArray)([b.iundo(v.withcore),b.iredo(v.withcore),b.ireset(v.withcore),b.irules(v.withcore)])(t=>t(e)))]),I=h.div([m.class_("ui-board nim-board")])([g.svg([g.viewBox(0)(0)(100)(100)])(a.concat(a.mapWithIndex(t=>n=>a.concat([[g.rect([g.x_(5===P?"25":"0"),g.y_(u.show(u.showInt)(10+(19*t|0)|0)),g.width(5===P?"50":"100"),g.height("10"),m.key("pile"+u.show(u.showInt)(t)),g.fill("snow")])],p.tabulate(P)(n=>g.rect([g.x_("-2.5"),g.y_("-2.5"),g.width("5"),g.height("5"),m.key("base-"+u.show(u.showInt)(t)+"-"+u.show(u.showInt)(n)),g.fill("gray"),w.onclick(new v.Play(new v.Move(t,n))),m.style("transform")(f.translate(D((5===P?30:5)+(10*n|0)|0))(D(15+(19*t|0)|0))+" rotate(45deg)"),m.style("cursor")(d.canPlay(v.nimGame)(e)(new v.Move(t,n))?"pointer":"not-allowed")])),a.mapWithIndex(e=>n=>g.use("#meeple")([m.key("p-"+u.show(u.showInt)(t)+"-"+u.show(u.showInt)(e)),g.width("8"),g.height("8"),m.class_("nim-player"),g.fill(0===e?"blue":"red"),m.style("transform")(f.translate(D((5===P?26:1)+(10*n|0)|0))(D(11+(19*t|0)|0)))]))([c.fst(n),c.snd(n)])]))(l.viewOn(e)(d._position(s.strongForget))))),h.span([m.class_("nim-turn-message")])([m.text(d.isLevelFinished(v.nimGame)(e)?"Partie finie":o.eq(d.eqTurn)(l.viewOn(e)(d._turn(s.strongForget)))(d.Turn1.value)?"Tour du joueur bleu":"Tour du joueur rouge")])]);return y.template(p.precord()())(v.withcore)(v.nimGame)({config:C,board:I,rules:S,winTitle:t})(e)}})(PS),(e=>{"use strict";e["Game.Nim"]=e["Game.Nim"]||{};var t=e["Game.Nim"],n=e["Data.Function"],a=e["Data.Maybe"],o=e["Game.Core"],r=e["Game.Nim.Model"],i=e["Game.Nim.View"],l={init:new a.Just(o.core(r.withcore)(o.Init.value)),view:i.view,onKeydown:n.const(a.Nothing.value)};t.game=l})(PS),function(e){"use strict";e["Game.Noirblanc.Model"]=e["Game.Noirblanc.Model"]||{};var t=e["Game.Noirblanc.Model"],n=e["Control.Applicative"],a=e["Control.Apply"],o=e["Control.Bind"],r=e["Control.Category"],i=e["Data.Array"],l=e["Data.EuclideanRing"],s=e["Data.Foldable"],u=e["Data.HeytingAlgebra"],c=e["Data.Lens.Getter"],d=e["Data.Lens.Index"],v=e["Data.Lens.Internal.Forget"],p=e["Data.Lens.Internal.Wander"],m=e["Data.Lens.Iso"],h=e["Data.Lens.Lens"],w=e["Data.Lens.Setter"],g=e["Data.Maybe"],f=e["Data.Ord"],b=e["Data.Profunctor.Strong"],y=e["Data.Traversable"],D=e["Data.Tuple"],S=e["Game.Core"],F=e["Lib.KonamiCode"],P=e["Lib.Util"],C=e["Pha.Action"],I=e["Pha.Effects.Random"],M=e.Run,x=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),A=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),_=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),G=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),T=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),O=e=>e,E=new S.MsgWithCore(x.create),N=[new D.Tuple(3,3),new D.Tuple(4,4),new D.Tuple(2,10),new D.Tuple(3,10),new D.Tuple(5,5),new D.Tuple(8,8),new D.Tuple(8,8)],R=S.genState({light:[],played:[]})(r.identity(r.categoryFn))({level:0,mode:0,maxLevels:[0,1,1,0],keySequence:[]}),L=e=>{var t=S._ext(e),n=m.iso(e=>e)(O)(e.Profunctor0());return e=>t(n(e))},q=e=>{var t=L(e),n=h.lens(e=>e.level)(e=>t=>({level:t,keySequence:e.keySequence,maxLevels:e.maxLevels,mode:e.mode}))(e);return e=>t(n(e))},k=e=>{var t=L(e),n=h.lens(e=>e.maxLevels)(e=>t=>({maxLevels:t,keySequence:e.keySequence,level:e.level,mode:e.mode}))(e);return e=>t(n(e))},U=e=>{var t=L(e),n=h.lens(e=>e.mode)(e=>t=>({mode:t,keySequence:e.keySequence,level:e.level,maxLevels:e.maxLevels}))(e);return e=>t(n(e))},B=e=>t=>i.mapWithIndex(n=>a=>a!==(e=>t=>n=>{var a=c.viewOn(e)(U(v.strongForget)),o=P.dCoords(c.viewOn(e)(S._nbColumns(v.strongForget)))(t)(n);return 1==((o.row*o.row|0)+(o.col*o.col|0)|0)||0===l.mod(l.euclideanRingInt)(a)(3)&&t===n||a>=2&&t!==n&&0==(o.row*o.col|0)})(e)(t)(n)),J=new S.Game(e=>n.pure(M.applicativeRun)(g.Nothing.value),e=>{var t=c.viewOn(e)(S._nbRows(v.strongForget))*c.viewOn(e)(S._nbColumns(v.strongForget))|0;return o.bind(M.bindRun)(c.viewOn(e)(q(v.strongForget))>=6?(e=>{var t=c.viewOn(e)(S._nbRows(v.strongForget))*c.viewOn(e)(S._nbColumns(v.strongForget))|0;return o.bind(M.bindRun)(I.randomInt(t+1|0))(a=>o.bind(M.bindRun)(y.sequence(y.traversableArray)(M.applicativeRun)(i.replicate(a)(I.randomInt(t))))(a=>n.pure(M.applicativeRun)(s.foldr(s.foldableArray)(B(e))(i.replicate(t)(!0))(a))))})(e):n.pure(M.applicativeRun)(i.replicate(t)(!0)))(e=>n.pure(M.applicativeRun)({light:e,played:i.replicate(t)(!1)}))},e=>s.all(s.foldableArray)(u.heytingAlgebraBoolean)(u.not(u.heytingAlgebraBoolean))(c.viewOn(e)(S._position(v.strongForget)).light),e=>{var t=g.fromMaybe(new D.Tuple(8,8))(i.index(N)(c.viewOn(e)(q(v.strongForget))));return n.pure(M.applicativeRun)(w.set(S._nbColumns(b.strongFn))(t.value1)(w.set(S._nbRows(b.strongFn))(t.value0)(e)))},e=>t=>{return g.Just.create(w.over((n=(e=>h.lens(e=>e.played)(e=>t=>({played:t,light:e.light}))(e))(b.strongFn),a=d.ix(d.indexArray)(t)(p.wanderFunction),e=>n(a(e))))(u.not(u.heytingAlgebraBoolean))(w.over((e=>h.lens(e=>e.light)(e=>t=>({light:t,played:e.played}))(e))(b.strongFn))(B(e)(t))(c.viewOn(e)(S._position(v.strongForget)))));var n,a},e=>new S.SizeLimit(3,3,10,10),e=>new D.Tuple(e,!0)),W=o.bind(M.bindRun)(C.getState)(e=>{var t,a,r,i=c.viewOn(e)(U(v.strongForget));return n.when(M.applicativeRun)(S.isLevelFinished(J)(e))((r=c.viewOn(e)(q(v.strongForget))>=4?6:c.viewOn(e)(q(v.strongForget))+(0===i||3===i?1:2)|0,o.discard(o.discardUnit)(M.bindRun)(C.setState(w.set((t=k(b.strongFn),a=d.ix(d.indexArray)(i)(p.wanderFunction),e=>t(a(e))))(r)))(()=>S.newGame(J)(w.over(q(b.strongFn))(e=>f.min(f.ordInt)(e+1|0)(6))))))});t.istate=R,t._mode=U,t._level=q,t._maxLevels=k,t.SelectMode=A,t.SelectLevel=_,t.Play=G,t.update=e=>{if(e instanceof x)return S.coreUpdate(J)(e.value0);if(e instanceof A)return S.newGame(J)((t=w.set(U(b.strongFn))(e.value0),n=w.set(q(b.strongFn))(0),e=>t(n(e))));var t,n;if(e instanceof _)return S.newGame(J)(w.set(q(b.strongFn))(e.value0));if(e instanceof G)return a.applySecond(M.applyRun)(S.playA(J)(e.value0))(W);if(e instanceof T)return F.konamiCode(e=>(e=>{var t=L(e),n=h.lens(e=>e.keySequence)(e=>t=>({keySequence:t,level:e.level,maxLevels:e.maxLevels,mode:e.mode}))(e);return e=>t(n(e))})(e))(C.setState(w.set(k(b.strongFn))([6,6,6,6])))(e.value0);throw new Error("Failed pattern match at Game.Noirblanc.Model (line 102, column 1 - line 102, column 35): "+[e.constructor.name])},t.onKeyDown=e=>g.Just.create(T.create(e)),t.noirblancGame=J,t.withcore=E}(PS),(e=>{"use strict";e["Game.Noirblanc.View"]=e["Game.Noirblanc.View"]||{};var t=e["Game.Noirblanc.View"],n=e["Data.Array"],a=e["Data.Eq"],o=e["Data.Int"],r=e["Data.Lens.Getter"],i=e["Data.Lens.Internal.Forget"],l=e["Data.Maybe"],s=e["Data.Ord"],u=e["Data.Semigroup"],c=e["Data.Show"],d=e["Game.Core"],v=e["Game.Noirblanc.Model"],p=e["Lib.Util"],m=e.Pha,h=e["Pha.Elements"],w=e["Pha.Events"],g=e["Pha.Svg"],f=e["Pha.Util"],b=e["UI.Icon"],y=e["UI.Icons"],D=e["UI.Template"];t.view=e=>{var t=[m.text("blablahblah")],S=r.viewOn(e)(d._nbRows(i.strongForget)),F=r.viewOn(e)(d._position(i.strongForget)),P=D.card("Tout noir tout blanc")([y.iconSelectGroup(y.defint)(a.eqInt)(e)("Mode jeu")([0,1,2,3])(r.viewOn(e)(v._mode(i.strongForget)))(v.SelectMode.create)(e=>t=>({icon:b.IconSymbol.create("#lo-mode"+c.show(c.showInt)(e+1|0)),selected:t.selected,tooltip:t.tooltip,round:t.round,large:t.large,hidden:t.hidden,disabled:t.disabled,style:t.style})),y.iconSelectGroup(y.defint)(a.eqInt)(e)("Difficulté")([0,1,2,3,4,5,6])(r.viewOn(e)(v._level(i.strongForget)))(v.SelectLevel.create)(t=>(e=>t=>n=>t?{icon:new b.IconSymbol("#locked"),selected:n.selected,tooltip:new l.Just("Difficulté non débloquée"),round:n.round,large:n.large,hidden:n.hidden,disabled:!0,style:n.style}:0===e?{icon:new b.IconText("3x3"),selected:n.selected,tooltip:n.tooltip,round:n.round,large:n.large,hidden:n.hidden,disabled:n.disabled,style:n.style}:1===e?{icon:new b.IconText("4x4"),selected:n.selected,tooltip:n.tooltip,round:n.round,large:n.large,hidden:n.hidden,disabled:n.disabled,style:n.style}:2===e?{icon:new b.IconText("2x10"),selected:n.selected,tooltip:n.tooltip,round:n.round,large:n.large,hidden:n.hidden,disabled:n.disabled,style:n.style}:3===e?{icon:new b.IconText("3x10"),selected:n.selected,tooltip:n.tooltip,round:n.round,large:n.large,hidden:n.hidden,disabled:n.disabled,style:n.style}:4===e?{icon:new b.IconText("5x5"),selected:n.selected,tooltip:n.tooltip,round:n.round,large:n.large,hidden:n.hidden,disabled:n.disabled,style:n.style}:5===e?{icon:new b.IconText("NxM"),selected:n.selected,tooltip:new l.Just("Dimensions personnalisées"),round:n.round,large:n.large,hidden:n.hidden,disabled:n.disabled,style:n.style}:{icon:new b.IconSymbol("#lo-rand"),selected:n.selected,tooltip:new l.Just("Grille aléatoire"),round:n.round,large:n.large,hidden:n.hidden,disabled:n.disabled,style:n.style})(t)(s.greaterThan(l.ordMaybe(s.ordInt))(new l.Just(t))(n.index(r.viewOn(e)(v._maxLevels(i.strongForget)))(r.viewOn(e)(v._mode(i.strongForget)))))),y.icongroup("Options")([y.ihelp(v.withcore)(e),y.ireset(v.withcore)(e),y.irules(v.withcore)(e)])]),C=r.viewOn(e)(d._nbColumns(i.strongForget)),I=h.div(u.append(u.semigroupArray)([m.class_("ui-board")])(D.gridStyle(S)(C)(4)))(p.map2(F.light)(F.played)(t=>n=>a=>{var l=p.coords(C)(t);return(e=>t=>n=>h.div(u.append(u.semigroupArray)([m.class_("noirblanc-square")])(n))([h.div([m.class_("noirblanc-square-inner"),m["class'"]("blanc")(e)])([h.div([m.class_("noirblanc-square-blanc")])((()=>t?[g.svg([g.width("100%"),g.height("100%"),m.class_("ui-absolute noirblanc-cross")])([g.use("#cross")([])])]:[])()),h.div([m.class_("noirblanc-square-noir")])((()=>t?[g.svg([g.width("100%"),g.height("100%"),m.class_("ui-absolute noirblanc-cross")])([g.use("#cross")([])])]:[])())])]))(n)(r.viewOn(e)(d._help(i.strongForget))&&a)([m.key(c.show(c.showInt)(t)),m.style("height")(f.pc(.86/o.toNumber(S))),m.style("width")(f.pc(.86/o.toNumber(C))),m.style("left")(f.pc((o.toNumber(l.col)+.07)/o.toNumber(C))),m.style("top")(f.pc((o.toNumber(l.row)+.07)/o.toNumber(S))),w.onclick(new v.Play(t))])})),M=D.incDecGrid(v.withcore)(v.noirblancGame)(e)([I]);return D.template(p.precord()())(v.withcore)(v.noirblancGame)({config:P,board:M,rules:t,winTitle:"GAGNÉ"})(e)}})(PS),(e=>{"use strict";e["Game.Noirblanc"]=e["Game.Noirblanc"]||{};var t=e["Game.Noirblanc"],n=e["Data.Maybe"],a=e["Game.Core"],o=e["Game.Noirblanc.Model"],r=e["Game.Noirblanc.View"],i={init:new n.Just(a.core(o.withcore)(a.Init.value)),view:r.view,onKeydown:o.onKeyDown};t.game=i})(PS),function(e){"use strict";e["Game.Paths.Model"]=e["Game.Paths.Model"]||{};var t=e["Game.Paths.Model"],n=e["Control.Applicative"],a=e["Control.Bind"],o=e["Data.Array"],r=e["Data.Array.NonEmpty"],i=e["Data.Eq"],l=e["Data.Foldable"],s=e["Data.Function"],u=e["Data.Functor"],c=e["Data.Lens.Getter"],d=e["Data.Lens.Internal.Forget"],v=e["Data.Lens.Iso"],p=e["Data.Lens.Lens"],m=e["Data.Lens.Setter"],h=e["Data.Maybe"],w=e["Data.Ord"],g=e["Data.Profunctor.Strong"],f=e["Data.Semigroup"],b=e["Data.Tuple"],y=e["Game.Core"],D=e["Lib.Util"],S=e["Pha.Action"],F=e["Pha.Effects.Random"],P=e.Run,C=(()=>{function e(){}return e.value=new e,e})(),I=(()=>{function e(){}return e.value=new e,e})(),M=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),x=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),A=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),_=e=>e,G=new y.MsgWithCore(M.create),T=y.genState([])(e=>({position:e.position,history:e.history,redoHistory:e.redoHistory,dialog:e.dialog,turn:e.turn,nbRows:4,nbColumns:6,customSize:e.customSize,mode:e.mode,help:e.help,locked:e.locked,showWin:e.showWin,scores:e.scores,pointer:e.pointer}))({exit:h.Nothing.value,mode:C.value}),O=new i.Eq(e=>t=>e instanceof C&&t instanceof C||e instanceof I&&t instanceof I),E=e=>{var t=y._ext(e),n=v.iso(e=>e)(_)(e.Profunctor0());return e=>t(n(e))},N=e=>{var t=E(e),n=p.lens(e=>e.mode)(e=>t=>({mode:t,exit:e.exit}))(e);return e=>t(n(e))},R=e=>{var t=E(e),n=p.lens(e=>e.exit)(e=>t=>({exit:t,mode:e.mode}))(e);return e=>t(n(e))},L=new y.Game(e=>n.pure(P.applicativeRun)(h.Nothing.value),e=>n.pure(P.applicativeRun)((()=>{var t=c.viewOn(e)(R(d.strongForget));if(t instanceof h.Nothing)return[];if(t instanceof h.Just)return[t.value0];throw new Error("Failed pattern match at Game.Paths.Model (line 71, column 36 - line 73, column 28): "+[t.constructor.name])})()),e=>o.length(c.viewOn(e)(y._position(d.strongForget)))===((c.viewOn(e)(y._nbColumns(d.strongForget))*c.viewOn(e)(y._nbRows(d.strongForget))|0)+(i.eq(h.eqMaybe(i.eqInt))(c.viewOn(e)(R(d.strongForget)))(o.head(c.viewOn(e)(y._position(d.strongForget))))?1:0)|0),e=>u.map(P.functorRun)(s.flip(m.set(R(g.strongFn)))(e))(i.eq(O)(c.viewOn(e)(N(d.strongForget)))(C.value)?u.mapFlipped(P.functorRun)(F.randomInt(c.viewOn(e)(y._nbRows(d.strongForget))*c.viewOn(e)(y._nbColumns(d.strongForget))|0))(h.Just.create):n.pure(P.applicativeRun)(h.Nothing.value)),e=>t=>{var s=o.last(c.viewOn(e)(y._position(d.strongForget)));if(s instanceof h.Nothing)return i.eq(O)(c.viewOn(e)(N(d.strongForget)))(I.value)?new h.Just([t]):h.Nothing.value;if(s instanceof h.Just)return a.bind(h.bindMaybe)((e=>t=>n=>{var a=D.dCoords(e)(t)(n);return 0===a.row?new h.Just(t<n?D.rangeStep(t+1|0)(n)(1):D.rangeStep(t-1|0)(n)(-1)):0===a.col?new h.Just(t<n?D.rangeStep(t+e|0)(n)(e):D.rangeStep(t-e|0)(n)(0|-e)):h.Nothing.value})(c.viewOn(e)(y._nbColumns(d.strongForget)))(s.value0)(t))(t=>{return!o.null(t)&&(e=>t=>h.fromMaybe(!0)(a.bind(h.bindMaybe)(c.viewOn(e)(R(d.strongForget)))(s=>a.bind(h.bindMaybe)(r.fromArray(t))(u=>{var v=r.init(u);return a.bind(h.bindMaybe)(r.fromArray(v))(a=>{var p=r.tail(a),m=r.head(u),g=r.last(u);return n.pure(h.applicativeMaybe)(o.length(o.nub(w.ordInt)(v))===o.length(v)&&!l.elem(l.foldableArray)(i.eqInt)(s)(p)&&!l.elem(l.foldableArray)(i.eqInt)(g)(p)&&(m!==g||o.length(t)===((c.viewOn(e)(y._nbRows(d.strongForget))*c.viewOn(e)(y._nbColumns(d.strongForget))|0)+(m===s?1:0)|0)&&g===s))})}))))(e)(f.append(f.semigroupArray)(c.viewOn(e)(y._position(d.strongForget)))(t))?new h.Just(f.append(f.semigroupArray)(c.viewOn(e)(y._position(d.strongForget)))(t)):h.Nothing.value});throw new Error("Failed pattern match at Game.Paths.Model (line 59, column 9 - line 66, column 28): "+[s.constructor.name])},e=>new y.SizeLimit(2,2,9,9),e=>new b.Tuple(e,!0));t.Mode1=C,t.Mode2=I,t.istate=T,t._exit=R,t._mode=N,t.SelectVertex=x,t.SelectMode=A,t.update=e=>{if(e instanceof M)return y.coreUpdate(L)(e.value0);if(e instanceof x)return a.bind(P.bindRun)(S.getState)(t=>{return o.null(c.viewOn(t)(y._position(d.strongForget)))?S.setState(m.set(y._position(g.strongFn))([e.value0])):h.isNothing(c.viewOn(t)(R(d.strongForget)))?S.setState(m.set(R(g.strongFn))(new h.Just(e.value0))):y.playA(L)(e.value0)});if(e instanceof A)return y.newGame(L)(m.set(N(g.strongFn))(e.value0));throw new Error("Failed pattern match at Game.Paths.Model (line 88, column 1 - line 88, column 35): "+[e.constructor.name])},t.eqMode=O,t.pathGame=L,t.withcore=G}(PS),(e=>{"use strict";e["Game.Paths.View"]=e["Game.Paths.View"]||{};var t=e["Game.Paths.View"],n=e["Data.Array"],a=e["Data.Eq"],o=e["Data.Foldable"],r=e["Data.Functor"],i=e["Data.Int"],l=e["Data.Lens.Getter"],s=e["Data.Lens.Internal.Forget"],u=e["Data.Maybe"],c=e["Data.Semigroup"],d=e["Data.Show"],v=e["Data.String.Common"],p=e["Data.Tuple"],m=e["Game.Core"],h=e["Game.Paths.Model"],w=e["Lib.Util"],g=e.Pha,f=e["Pha.Elements"],b=e["Pha.Events"],y=e["Pha.Svg"],D=e["Pha.Util"],S=e["UI.Icon"],F=e["UI.Icons"],P=e["UI.Template"];t.view=e=>{var t=[f.p([])([g.text("Après de moultes péripéties dans le temple maudit de Berge, le professeur Hamilton Jones se retrouve dans la dernière salle"),f.br,g.text("Pour sortir de celle-ci, il doit s'enfuir par une porte au dessous de lui."),f.br,g.text("Celle ci ne peut être ouverte qu'en marchant sur chacune des dalles dans la salle.")]),f.p([])([g.text("Malheusement, ces dalles sont piégées, le piège se déclenchant peu de temps après avoir marché dessus."),f.br,g.text("Donc, Hamilton ne peut pas remarcher sur une dalle sur laquelle il a déjà été."),f.br,g.text("N'ayant plus l'aisance de sa jeunesse, Hamilton ne peut se déplacer que d'une dalle à la fois et ne peut le faire en diagonale.")]),f.p([])([g.text("Trouve un parcours pour résoudre l'énigme. Ca semble facile? Mais, cela est-il possible pour toutes les tailles de grille")]),f.p([])([g.text("Dans le deuxième mode de jeu, tu peux choisir la position de départ d'Hamilton ainsi que celle de la porte."),f.br,g.text("Tu remarqueras qu'il n'y a pas toujours de solution."),f.br,g.text("Trouve des critères sur les positions d'Hamilton et de la porte pour qu'une solution soit possible.")])],C=l.viewOn(e)(m._nbRows(s.strongForget)),I=l.viewOn(e)(m._position(s.strongForget)),M=P.card("Chemins")([F.iconSelectGroup(F.defa)(h.eqMode)(e)("Mode de jeu")([h.Mode1.value,h.Mode2.value])(l.viewOn(e)(h._mode(s.strongForget)))(h.SelectMode.create)(e=>{if(e instanceof h.Mode1)return e=>({icon:new S.IconSymbol("#paths-mode0"),selected:e.selected,tooltip:new u.Just("Mode 1"),round:e.round,large:e.large,hidden:e.hidden,disabled:e.disabled,style:e.style});if(e instanceof h.Mode2)return e=>({icon:new S.IconSymbol("#paths-mode1"),selected:e.selected,tooltip:new u.Just("Mode 2"),round:e.round,large:e.large,hidden:e.hidden,disabled:e.disabled,style:e.style});throw new Error("Failed pattern match at Game.Paths.View (line 53, column 86 - line 55, column 82): "+[e.constructor.name])}),F.iconSizesGroup(h.withcore)(e)([new p.Tuple(4,6),new p.Tuple(5,5),new p.Tuple(3,8)])(!0),F.icongroup("Options")(r.mapFlipped(r.functorArray)([F.ihelp(h.withcore),F.iundo(h.withcore),F.iredo(h.withcore),F.ireset(h.withcore),F.irules(h.withcore)])(t=>t(e)))]),x=l.viewOn(e)(m._nbColumns(s.strongForget)),A=v.joinWith(" ")(n.concat(n.mapWithIndex(e=>t=>{var n=w.coords(x)(t);return[0===e?"M":"L",d.show(d.showInt)(50+(100*n.col|0)|0),d.show(d.showInt)(50+(100*n.row|0)|0)]})(I))),_=f.div(c.append(c.semigroupArray)(P.gridStyle(C)(x)(5))(P.trackPointer(h.withcore)))([y.svg([y.viewBox(0)(0)(100*x|0)(100*C|0)])(c.append(c.semigroupArray)(w.tabulate(C*x|0)(t=>{var r=w.coords(x)(t);return(e=>t=>{var n=[y.x_(d.show(d.showNumber)(e.x)),y.y_(d.show(d.showNumber)(e.y)),y.width("100"),y.height("100")];return y.g(c.append(c.semigroupArray)([g["class'"]("paths-darken")(e.darken)])(t))([y.use("#paths-background")(n),g.when(e.door)(e=>y.use("#paths-door")(n)),y.use("#paths-trap")(c.append(c.semigroupArray)(n)([g.class_("paths-trap"),g["class'"]("visible")(e.trap&&!e.door)]))])})({darken:l.viewOn(e)(m._help(s.strongForget))&&i.even(r.row+r.col|0),trap:o.elem(o.foldableArray)(a.eqInt)(t)(I)&&a.notEq(u.eqMaybe(a.eqInt))(new u.Just(t))(n.last(I)),door:a.eq(u.eqMaybe(a.eqInt))(l.viewOn(e)(h._exit(s.strongForget)))(new u.Just(t)),x:i.toNumber(100*r.col|0),y:i.toNumber(100*r.row|0)})([g.key(d.show(d.showInt)(t)),b.onclick(new h.SelectVertex(t))])}))([y.path(A)([g.class_("paths-path")]),g.maybe(n.last(I))(e=>{var t=w.coords(x)(e);return y.use("#meeplehat")([g.key("hero"),y.width("80"),y.height("80"),g.class_("paths-hero"),g.style("transform")(D.translate(D.pc((i.toNumber(t.col)+.1)/i.toNumber(x)))(D.pc((i.toNumber(t.row)+.1)/i.toNumber(C))))])}),g.maybe(l.viewOn(e)(m._pointer(s.strongForget)))(t=>{return n.null(I)?(e=>y.use(" #meeplehat")(c.append(c.semigroupArray)([g.key("chero"),y.x_("-40"),y.y_("-40"),y.width("80"),y.height("80"),g.attr("opacity")("0.6"),g.attr("pointer-events")("none")])(P.svgCursorStyle(e))))(t):u.isNothing(l.viewOn(e)(h._exit(s.strongForget)))?(e=>y.use(" #paths-door")(c.append(c.semigroupArray)([g.key("cdoor"),y.x_("-50"),y.y_("-50"),y.width("100"),y.height("100"),g.attr("opacity")("0.6"),g.attr("pointer-events")("none")])(P.svgCursorStyle(e))))(t):g.emptyNode})]))]),G=P.incDecGrid(h.withcore)(h.pathGame)(e)([_]);return P.template(w.precord()())(h.withcore)(h.pathGame)({config:M,board:G,rules:t})(e)}})(PS),(e=>{"use strict";e["Game.Paths"]=e["Game.Paths"]||{};var t=e["Game.Paths"],n=e["Data.Function"],a=e["Data.Maybe"],o=e["Game.Core"],r=e["Game.Paths.Model"],i=e["Game.Paths.View"],l={init:new a.Just(o.core(r.withcore)(o.Init.value)),view:i.view,onKeydown:n.const(a.Nothing.value)};t.game=l})(PS),function(e){"use strict";e["Game.Queens.Model"]=e["Game.Queens.Model"]||{};var t,n,a=e["Game.Queens.Model"],o=e["Control.Applicative"],r=e["Control.Category"],i=e["Data.Array"],l=e["Data.Array.NonEmpty"],s=e["Data.Array.NonEmpty.Internal"],u=e["Data.Eq"],c=e["Data.Foldable"],d=e["Data.HeytingAlgebra"],v=e["Data.Lens.Getter"],p=e["Data.Lens.Index"],m=e["Data.Lens.Internal.Forget"],h=e["Data.Lens.Internal.Wander"],w=e["Data.Lens.Iso"],g=e["Data.Lens.Lens"],f=e["Data.Lens.Setter"],b=e["Data.Maybe"],y=e["Data.Profunctor.Strong"],D=e["Data.Show"],S=e["Data.String.Common"],F=e["Data.Tuple"],P=e["Game.Core"],C=e["Lib.Util"],I=e["Pha.Action"],M=e.Run,x=(()=>{function e(){}return e.value=new e,e})(),A=(()=>{function e(){}return e.value=new e,e})(),_=(()=>{function e(){}return e.value=new e,e})(),G=(()=>{function e(){}return e.value=new e,e})(),T=(()=>{function e(){}return e.value=new e,e})(),O=(()=>{function e(){}return e.value=new e,e})(),E=(()=>{function e(){}return e.value=new e,e})(),N=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),R=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),L=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),q=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),k=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),U=(()=>{function e(){}return e.value=new e,e})(),B=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),J=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),W=(()=>{function e(){}return e.value=new e,e})(),z=e=>e,j=new P.MsgWithCore(N.create),V=e=>{return 0===e?0:e>0?1:-1},H=new D.Show(e=>e instanceof T?"queen":e instanceof _?"king":e instanceof x?"rook":e instanceof A?"bishop":e instanceof G?"knight":"custom"),Q=[x.value,A.value,_.value,G.value,T.value],K=P.genState([])(e=>({position:e.position,history:e.history,redoHistory:e.redoHistory,dialog:e.dialog,turn:e.turn,nbRows:8,nbColumns:8,customSize:e.customSize,mode:e.mode,help:e.help,locked:e.locked,showWin:e.showWin,scores:e.scores,pointer:e.pointer}))({selectedPiece:T.value,selectedSquare:b.Nothing.value,allowedPieces:l.singleton(x.value),multiPieces:!1,customLocalMoves:i.replicate(25)(!1),customDirections:i.replicate(9)(!1)}),Z=new u.Eq(e=>t=>e instanceof x&&t instanceof x||(e instanceof A&&t instanceof A||(e instanceof _&&t instanceof _||(e instanceof G&&t instanceof G||(e instanceof T&&t instanceof T||(e instanceof O&&t instanceof O||e instanceof E&&t instanceof E)))))),X=e=>{var t=P._ext(e),n=w.iso(e=>e)(z)(e.Profunctor0());return e=>t(n(e))},Y=e=>{var t=X(e),n=g.lens(e=>e.multiPieces)(e=>t=>({multiPieces:t,allowedPieces:e.allowedPieces,customDirections:e.customDirections,customLocalMoves:e.customLocalMoves,selectedPiece:e.selectedPiece,selectedSquare:e.selectedSquare}))(e);return e=>t(n(e))},$=e=>{var t=X(e),n=g.lens(e=>e.selectedPiece)(e=>t=>({selectedPiece:t,allowedPieces:e.allowedPieces,customDirections:e.customDirections,customLocalMoves:e.customLocalMoves,multiPieces:e.multiPieces,selectedSquare:e.selectedSquare}))(e);return e=>t(n(e))},ee=e=>{var t=X(e),n=g.lens(e=>e.selectedSquare)(e=>t=>({selectedSquare:t,allowedPieces:e.allowedPieces,customDirections:e.customDirections,customLocalMoves:e.customLocalMoves,multiPieces:e.multiPieces,selectedPiece:e.selectedPiece}))(e);return e=>t(n(e))},te=e=>{var t=X(e),n=g.lens(e=>e.customLocalMoves)(e=>t=>({customLocalMoves:t,allowedPieces:e.allowedPieces,customDirections:e.customDirections,multiPieces:e.multiPieces,selectedPiece:e.selectedPiece,selectedSquare:e.selectedSquare}))(e);return e=>t(n(e))},ne=e=>{var t=X(e),n=g.lens(e=>e.customDirections)(e=>t=>({customDirections:t,allowedPieces:e.allowedPieces,customLocalMoves:e.customLocalMoves,multiPieces:e.multiPieces,selectedPiece:e.selectedPiece,selectedSquare:e.selectedSquare}))(e);return e=>t(n(e))},ae=e=>t=>n=>C.tabulate(v.viewOn(e)(P._nbRows(m.strongForget))*v.viewOn(e)(P._nbColumns(m.strongForget))|0)((e=>t=>n=>a=>{var o=C.dCoords(v.viewOn(e)(P._nbColumns(m.strongForget)))(a)(n);return u.notEq(Z)(t)(O.value)?n!==a&&(e=>t=>n=>e instanceof T?0==((((t*t|0)-(n*n|0)|0)*t|0)*n|0):e instanceof _?((t*t|0)+(n*n|0)|0)<=2:e instanceof x?0==(t*n|0):e instanceof A?0==((t*t|0)-(n*n|0)|0):e instanceof G&&5==((t*t|0)+(n*n|0)|0))(t)(o.row)(o.col):0==((((o.row*o.row|0)-(o.col*o.col|0)|0)*o.row|0)*o.col|0)&&u.eq(b.eqMaybe(u.eqBoolean))(i.index(v.viewOn(e)(ne(m.strongForget)))(4+((3*V(o.row)|0)+V(o.col)|0)|0))(new b.Just(!0))||((o.row*o.row|0)+(o.col*o.col|0)|0)<=8&&u.eq(b.eqMaybe(u.eqBoolean))(i.index(v.viewOn(e)(te(m.strongForget)))(12+((5*o.row|0)+o.col|0)|0))(new b.Just(!0))})(e)(t)(n)),oe=e=>c.foldr(c.foldableArray)(t=>{return u.eq(Z)(t.value1)(E.value)?r.identity(r.categoryFn):i.zipWith(d.disj(d.heytingAlgebraBoolean))(ae(e)(t.value1)(t.value0))})(i.replicate(v.viewOn(e)(P._nbRows(m.strongForget))*v.viewOn(e)(P._nbColumns(m.strongForget))|0)(!1))(i.mapWithIndex(F.Tuple.create)(v.viewOn(e)(P._position(m.strongForget)))),re=e=>{var t=X(e),n=g.lens(e=>e.allowedPieces)(e=>t=>({allowedPieces:t,customDirections:e.customDirections,customLocalMoves:e.customLocalMoves,multiPieces:e.multiPieces,selectedPiece:e.selectedPiece,selectedSquare:e.selectedSquare}))(e);return e=>t(n(e))},ie=new P.ScoreGame(()=>le,e=>v.viewOn(e)(Y(m.strongForget))||u.eq(Z)(l.head(v.viewOn(e)(re(m.strongForget))))(O.value),e=>P.Maximize.value,(t=i.filter(e=>u.notEq(Z)(e)(E.value)),n=v.view(P._position(m.strongForget)),e=>i.length(t(n(e)))),e=>S.joinWith("-")([D.show(D.showInt)(v.viewOn(e)(P._nbRows(m.strongForget))),D.show(D.showInt)(v.viewOn(e)(P._nbColumns(m.strongForget))),D.show(H)(l.head(v.viewOn(e)(re(m.strongForget))))])),le=new P.Game(e=>o.pure(M.applicativeRun)(b.Nothing.value),e=>o.pure(M.applicativeRun)(i.replicate(v.viewOn(e)(P._nbRows(m.strongForget))*v.viewOn(e)(P._nbColumns(m.strongForget))|0)(E.value)),e=>c.and(c.foldableArray)(d.heytingAlgebraBoolean)(C.map2(oe(e))(v.viewOn(e)(P._position(m.strongForget)))(e=>e=>t=>!e||u.eq(Z)(t)(E.value))),e=>o.pure(M.applicativeRun)(f.set($(y.strongFn))(l.head(v.viewOn(e)(re(m.strongForget))))(e)),e=>t=>{var n=v.viewOn(e)($(m.strongForget));return i.modifyAt(t)(e=>{return u.eq(Z)(e)(n)?E.value:n})(v.viewOn(e)(P._position(m.strongForget)))},e=>new P.SizeLimit(3,3,9,9),P["updateScore'"](ie)(P.NeverShowWin.value));a.piecesList=Q,a.Rook=x,a.Bishop=A,a.King=_,a.Knight=G,a.Queen=T,a.Custom=O,a.Empty=E,a.istate=K,a._selectedPiece=$,a._selectedSquare=ee,a._allowedPieces=re,a._multiPieces=Y,a._customLocalMoves=te,a._customDirections=ne,a.capturableSquares=oe,a.attackedBySelected=e=>{var t=v.viewOn(e)(ee(m.strongForget));if(t instanceof b.Nothing)return i.replicate(v.viewOn(e)(P._nbRows(m.strongForget))*v.viewOn(e)(P._nbColumns(m.strongForget))|0)(!1);if(t instanceof b.Just)return ae(e)(v.viewOn(e)($(m.strongForget)))(t.value0);throw new Error("Failed pattern match at Game.Queens.Model (line 98, column 28 - line 100, column 65): "+[t.constructor.name])},a.Play=R,a.SelectPiece=L,a.SelectSquare=q,a.SelectAllowedPiece=k,a.ToggleMultiPieces=U,a.FlipDirection=B,a.FlipLocalMove=J,a.Customize=W,a.update=e=>{if(e instanceof N)return P.coreUpdate(le)(e.value0);if(e instanceof R)return P.playA(le)(e.value0);if(e instanceof L)return I.setState(f.set($(y.strongFn))(e.value0));if(e instanceof q)return I.setState(f.set(ee(y.strongFn))(e.value0));if(e instanceof k)return P.newGame(le)(t=>f.over(re(y.strongFn))((e=>t=>n=>{if(!t)return l.singleton(e);if(t){var a=i.filter(t=>u.eq(Z)(t)(e)!==c.elem(s.foldableNonEmptyArray)(Z)(t)(n))(Q);return b.fromMaybe(n)(l.fromArray(a))}throw new Error("Failed pattern match at Game.Queens.Model (line 102, column 1 - line 102, column 91): "+[e.constructor.name,t.constructor.name,n.constructor.name])})(e.value0)(v.viewOn(t)(Y(m.strongForget))))(t));if(e instanceof U)return I.setState(f.over(Y(y.strongFn))(d.not(d.heytingAlgebraBoolean)));if(e instanceof B)return P.newGame(le)(f.over((t=ne(y.strongFn),n=p.ix(p.indexArray)(e.value0)(h.wanderFunction),e=>t(n(e))))(d.not(d.heytingAlgebraBoolean)));var t,n,a,o,r,w,g;if(e instanceof J)return P.newGame(le)(f.over((a=te(y.strongFn),o=p.ix(p.indexArray)(e.value0)(h.wanderFunction),e=>a(o(e))))(d.not(d.heytingAlgebraBoolean)));if(e instanceof W)return P.newGame(le)((r=f.set(re(y.strongFn))(l.singleton(O.value)),w=f.set(P._dialog(y.strongFn))(P.CustomDialog.value),g=f.set(Y(y.strongFn))(!1),e=>r(w(g(e)))));throw new Error("Failed pattern match at Game.Queens.Model (line 132, column 1 - line 132, column 35): "+[e.constructor.name])},a.eqPiece=Z,a.showPiece=H,a.queensGame=le,a.queensScoreGame=ie,a.withcore=j}(PS),(e=>{"use strict";e["Game.Queens.View"]=e["Game.Queens.View"]||{};var t=e["Game.Queens.View"],n=e["Data.Array"],a=e["Data.Array.NonEmpty"],o=e["Data.Array.NonEmpty.Internal"],r=e["Data.Eq"],i=e["Data.Functor"],l=e["Data.Int"],s=e["Data.Lens.Getter"],u=e["Data.Lens.Internal.Forget"],c=e["Data.Maybe"],d=e["Data.Semigroup"],v=e["Data.Show"],p=e["Data.Tuple"],m=e["Game.Core"],h=e["Game.Queens.Model"],w=e["Lib.Util"],g=e.Pha,f=e["Pha.Elements"],b=e["Pha.Events"],y=e["Pha.Svg"],D=e["Pha.Util"],S=e["UI.Icon"],F=e["UI.Icons"],P=e["UI.Template"],C=e=>e instanceof h.Queen?"Reine":e instanceof h.King?"Roi":e instanceof h.Rook?"Tour":e instanceof h.Bishop?"Fou":e instanceof h.Knight?"Cavalier":"Pièce personnalisée",I=e=>t=>f.div(d.append(d.semigroupArray)(t)([g.class_("queens-square"),g["class'"]("queens-square-capturable")(e.capturable),g["class'"]("queens-square-nonavailable")(e.nonavailable),g["class'"]("queens-square-selected")(e.selected)]))(r.eq(h.eqPiece)(e.piece)(h.Empty.value)?[]:[y.svg([y.width("100%"),y.height("100%"),g.class_("queens-piece")])([y.use("#piece-"+v.show(h.showPiece)(e.piece))([y.x_("10%"),y.y_("10%"),y.width("80%"),y.height("80%")])])]);t.view=e=>{var t=[g.text("Place le plus de pièces possible sur ta grille sans qu'aucune ne soit menacée par une autre pièce."),f.br,g.text("Tu peux choisir de jouer avec différentes pièces comme celles du jeu d'échecs.")],M=s.viewOn(e)(m._nbRows(u.strongForget)),x=s.viewOn(e)(m._position(u.strongForget)),A=f.div([g.class_("ui-flex-center gutter2 queens-pieceselector")])(i.mapFlipped(i.functorArray)(a.toArray(s.viewOn(e)(h._allowedPieces(u.strongForget))))(t=>{var n=v.show(h.showPiece)(t);return F.iconbutton(w.precord()())(e)({selected:r.eq(h.eqPiece)(t)(s.viewOn(e)(h._selectedPiece(u.strongForget))),icon:S.IconSymbol.create("#piece-"+n)})([g.key(n),b.onclick(new h.SelectPiece(t))])})),_=P.card("Les reines")([F.iconSizesGroup(h.withcore)(e)([new p.Tuple(4,4),new p.Tuple(5,5),new p.Tuple(7,7),new p.Tuple(8,8)])(!0),F.iconSelectGroupM(F.defa)(h.eqPiece)(o.foldableNonEmptyArray)(e)("Pièces disponibles")(h.piecesList)(s.viewOn(e)(h._allowedPieces(u.strongForget)))(h.SelectAllowedPiece.create)(e=>t=>({icon:S.IconSymbol.create("#piece-"+v.show(h.showPiece)(e)),selected:t.selected,tooltip:c.Just.create(C(e)),round:t.round,large:t.large,hidden:t.hidden,disabled:t.disabled,style:t.style})),F.icongroup("Options")(d.append(d.semigroupArray)([F.iconbutton(w.precord()())(e)({icon:new S.IconSymbol("#customize"),selected:r.eq(h.eqPiece)(a.head(s.viewOn(e)(h._allowedPieces(u.strongForget))))(h.Custom.value),tooltip:new c.Just("Crée ta propre propre pièce")})([b.onclick(h.Customize.value)]),F.iconbutton(w.precord()())(e)({icon:new S.IconSymbol("#piece-mix"),selected:s.viewOn(e)(h._multiPieces(u.strongForget)),tooltip:new c.Just("Mode mixte")})([b.onclick(h.ToggleMultiPieces.value)])])([F.ihelp(h.withcore)(e),F.ireset(h.withcore)(e),F.irules(h.withcore)(e)])),F.iconBestScore(h.withcore)(h.queensScoreGame)(e)]),G=s.viewOn(e)(m._nbColumns(u.strongForget)),T=f.div(d.append(d.semigroupArray)([g.class_("ui-board")])(d.append(d.semigroupArray)(P.gridStyle(M)(G)(5))(P.trackPointer(h.withcore))))(n.concat([w.map3(x)(h.attackedBySelected(e))(h.capturableSquares(e))(t=>n=>a=>o=>I({piece:n,selected:a||r.eq(c.eqMaybe(r.eqInt))(s.viewOn(e)(h._selectedSquare(u.strongForget)))(new c.Just(t)),nonavailable:s.viewOn(e)(m._help(u.strongForget))&&(r.notEq(h.eqPiece)(n)(h.Empty.value)||o),capturable:o})([g.style("width")(D.pc(1/l.toNumber(G))),g.style("height")(D.pc(1/l.toNumber(M))),b.onclick(new h.Play(t)),b.onpointerenter(new h.SelectSquare(new c.Just(t))),b.onpointerleave(new h.SelectSquare(c.Nothing.value))])),[g.maybe(s.viewOn(e)(m._pointer(u.strongForget)))(t=>f.div(d.append(d.semigroupArray)([g.class_("ui-cursor")])(P.cursorStyle(t)(M)(G)(.8)))([y.svg([y.width("100%"),y.height("100%")])([y.use("#piece-"+v.show(h.showPiece)(s.viewOn(e)(h._selectedPiece(u.strongForget))))([])])]))]])),O=f.div([])([A,P.incDecGrid(h.withcore)(h.queensGame)(e)([T])]),E=[45,90,135,0,0,180,-45,-90,-135];return P.template(w.precord()())(h.withcore)(h.queensGame)({config:_,board:O,rules:t,customDialog:t=>P.dialog(h.withcore)("Personnalise ta pièce")([f.div([g.class_("flex queens-custompiece")])([f.div([g.class_("queens-grid queens-custompiece-grid")])(n.mapWithIndex(e=>t=>I({piece:12===e?h.Custom.value:h.Empty.value,selected:t,capturable:!1,nonavailable:!1})([g.key(v.show(v.showInt)(e)),g.style("width")("20%"),g.style("height")("20%"),b["onclick'"](12!==e?new c.Just(new h.FlipLocalMove(e)):c.Nothing.value)]))(s.viewOn(e)(h._customLocalMoves(u.strongForget)))),f.div([g.class_("flex queens-custompiece-directions")])(w.map2(s.viewOn(e)(h._customDirections(u.strongForget)))(E)(t=>n=>a=>F.iconbutton(w.precord()())(e)({selected:n,icon:4===t?S.IconNone.value:new S.IconSymbol("#arrow"),style:[new p.Tuple("transform","rotate("+v.show(v.showInt)(a)+"deg)")]})([g.key(v.show(v.showInt)(t)),b["onclick'"](4!==t?new c.Just(new h.FlipDirection(t)):c.Nothing.value)])))])]),scoreDialog:t=>P.bestScoreDialog(h.withcore)(h.queensScoreGame)(e)(e=>[f.div([g.class_("ui-flex-center queens-bestscore-container")])([f.div(d.append(d.semigroupArray)(P.gridStyle(M)(G)(5))([g.class_("ui-board queens-grid")]))(i.mapFlipped(i.functorArray)(e)(e=>I({piece:e,capturable:!1,selected:!1,nonavailable:!1})([g.style("width")(D.pc(1/l.toNumber(G))),g.style("height")(D.pc(1/l.toNumber(M)))])))])])})(e)}})(PS),(e=>{"use strict";e["Game.Queens"]=e["Game.Queens"]||{};var t=e["Game.Queens"],n=e["Data.Function"],a=e["Data.Maybe"],o=e["Game.Core"],r=e["Game.Queens.Model"],i=e["Game.Queens.View"],l={init:new a.Just(o.core(r.withcore)(o.Init.value)),view:i.view,onKeydown:n.const(a.Nothing.value)};t.game=l})(PS),function(e){"use strict";e["Game.Roue.Model"]=e["Game.Roue.Model"]||{};var t,n,a=e["Game.Roue.Model"],o=e["Control.Applicative"],r=e["Control.Bind"],i=e["Control.Category"],l=e["Control.Monad.Rec.Class"],s=e["Data.Array"],u=e["Data.Eq"],c=e["Data.EuclideanRing"],d=e["Data.Foldable"],v=e["Data.Function"],p=e["Data.HeytingAlgebra"],m=e["Data.Lens.Getter"],h=e["Data.Lens.Index"],w=e["Data.Lens.Internal.Forget"],g=e["Data.Lens.Internal.Wander"],f=e["Data.Lens.Iso"],b=e["Data.Lens.Lens"],y=e["Data.Lens.Setter"],D=e["Data.Maybe"],S=e["Data.Profunctor.Strong"],F=e["Data.Semiring"],P=e["Data.Tuple"],C=e["Data.Unit"],I=e["Game.Core"],M=e["Lib.Util"],x=e["Pha.Action"],A=e["Pha.Effects.Delay"],_=e.Run,G=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),T=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),O=(()=>{function e(){}return e.value=new e,e})(),E=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),N=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),R=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),L=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),q=(()=>{function e(){}return e.value=new e,e})(),k=e=>e,U=new I.MsgWithDnd(N.create),B=new I.MsgWithCore(E.create),J=I.genState([])(i.identity(i.categoryFn))({rotation:0,size:5,dragged:D.Nothing.value}),W=new u.Eq(e=>t=>e instanceof G&&t instanceof G?e.value0===t.value0:e instanceof T&&t instanceof T?e.value0===t.value0:e instanceof O&&t instanceof O),z=e=>{var t=I._ext(e),n=f.iso(e=>e)(k)(e.Profunctor0());return e=>t(n(e))},j=e=>{var t=z(e),n=b.lens(e=>e.rotation)(e=>t=>({rotation:t,dragged:e.dragged,size:e.size}))(e);return e=>t(n(e))},V=e=>{var t=m.viewOn(e)(j(w.strongForget)),n=s.length(m.viewOn(e)(I._position(w.strongForget)));return s.mapWithIndex(e=>a=>{if(a instanceof D.Nothing)return!1;if(a instanceof D.Just)return c.mod(c.euclideanRingInt)(e+t|0)(n)===a.value0;throw new Error("Failed pattern match at Game.Roue.Model (line 44, column 47 - line 46, column 43): "+[a.constructor.name])})(m.viewOn(e)(I._position(w.strongForget)))},H=e=>1===s.length(s.filter(i.identity(i.categoryFn))(V(e))),Q=e=>H(e)&&d.all(d.foldableArray)(p.heytingAlgebraBoolean)(D.isJust)(m.viewOn(e)(I._position(w.strongForget))),K=e=>y.addOver(F.semiringInt)(j(S.strongFn))(e),Z=e=>{var t=z(e),n=b.lens(e=>e.size)(e=>t=>({size:t,dragged:e.dragged,rotation:e.rotation}))(e);return e=>t(n(e))},X=new I.Game(e=>o.pure(_.applicativeRun)(D.Nothing.value),e=>o.pure(_.applicativeRun)(s.replicate(m.viewOn(e)(Z(w.strongForget)))(D.Nothing.value)),e=>!1,(t=o.pure(_.applicativeRun),n=y.set(j(S.strongFn))(0),e=>t(n(e))),e=>t=>{return(()=>t.from instanceof G&&t.to instanceof T?s.updateAt(t.to.value0)(new D.Just(t.from.value0)):t.from instanceof T&&t.to instanceof T?M.swap(t.from.value0)(t.to.value0):t.from instanceof T&&t.to instanceof O?s.updateAt(t.from.value0)(D.Nothing.value):v.const(D.Nothing.value))()(m.viewOn(e)(I._position(w.strongForget)))},I.defaultSizeLimit,e=>new P.Tuple(e,!0)),Y=e=>{var t=z(e),n=b.lens(e=>e.dragged)(e=>t=>({dragged:t,rotation:e.rotation,size:e.size}))(e);return e=>t(n(e))};a.Panel=G,a.Wheel=T,a.istate=J,a._rotation=j,a._size=Z,a._dragged=Y,a.aligned=V,a["validRotation'"]=H,a.validRotation=Q,a.Rotate=R,a.SetSize=L,a.Check=q,a.update=e=>{if(e instanceof E)return I.coreUpdate(X)(e.value0);if(e instanceof N&&e.value0 instanceof I.DropOnBoard)return x.setState(e=>{var t,n,a=y.set(Y(S.strongFn))(D.Nothing.value)(e),o=m.viewOn(e)(Y(w.strongForget));return o instanceof D.Just&&o.value0 instanceof T?y.set((t=I._position(S.strongFn),n=h.ix(h.indexArray)(o.value0.value0)(g.wanderFunction),e=>t(n(e))))(D.Nothing.value)(a):a});if(e instanceof N)return I.dndUpdate(W)(X)(e=>Y(e))(e.value0);if(e instanceof R)return x.setState(K(e.value0));if(e instanceof L)return I.newGame(X)(y.set(Z(S.strongFn))(e.value0));if(e instanceof q){var t=e=>0===e?r.discard(r.discardUnit)(_.bindRun)(x.setState(y.set(I._showWin(S.strongFn))(!0)))(()=>r.discard(r.discardUnit)(_.bindRun)(A.delay(1e3))(()=>r.discard(r.discardUnit)(_.bindRun)(x.setState(y.set(I._showWin(S.strongFn))(!1)))(()=>o.pure(_.applicativeRun)(new l.Done(C.unit))))):r.bind(_.bindRun)(x.getState)(t=>{return!Q(t)?o.pure(_.applicativeRun)(new l.Done(C.unit)):r.discard(r.discardUnit)(_.bindRun)(x.setState(K(1)))(()=>r.discard(r.discardUnit)(_.bindRun)(A.delay(600))(()=>o.pure(_.applicativeRun)(new l.Loop(e-1|0))))});return I.lockAction(r.bind(_.bindRun)(x.getState)(e=>l.tailRecM(_.monadRecRun)(t)(m.viewOn(e)(Z(w.strongForget)))))}throw new Error("Failed pattern match at Game.Roue.Model (line 86, column 1 - line 86, column 35): "+[e.constructor.name])},a.eqLoc=W,a.roueGame=X,a.withcore=B,a.withdnd=U}(PS),(e=>{"use strict";e["Game.Roue.View"]=e["Game.Roue.View"]||{};var t=e["Game.Roue.View"],n=e["Control.Apply"],a=e["Control.Bind"],o=e["Control.Category"],r=e["Data.Array"],i=e["Data.Eq"],l=e["Data.Foldable"],s=e["Data.Function"],u=e["Data.Functor"],c=e["Data.Int"],d=e["Data.Lens.Getter"],v=e["Data.Lens.Internal.Forget"],p=e["Data.Maybe"],m=e["Data.Semigroup"],h=e["Data.Show"],w=e["Data.String.Common"],g=e["Game.Core"],f=e["Game.Roue.Model"],b=e["Lib.Util"],y=e.Math,D=e.Pha,S=e["Pha.Attributes"],F=e["Pha.Elements"],P=e["Pha.Events"],C=e["Pha.Svg"],I=e["Pha.Util"],M=e["UI.Icons"],x=e["UI.Template"],A=e=>t=>n=>a=>({x:e+n*y.cos(a),y:t+n*y.sin(a)}),_=e=>t=>n=>a=>o=>{var r=A(e)(t)(n)(a),i=A(e)(t)(n)(o);return w.joinWith(" ")(["M",h.show(h.showNumber)(e),h.show(h.showNumber)(t),"L",h.show(h.showNumber)(i.x),h.show(h.showNumber)(i.y),"A",h.show(h.showNumber)(n),h.show(h.showNumber)(n),"0 0 0",h.show(h.showNumber)(r.x),h.show(h.showNumber)(r.y),"L",h.show(h.showNumber)(e),h.show(h.showNumber)(t)])},G=e=>t=>F.div([D["class'"]("ui-cursor roue-select-color roue-cursor")(!0),D.style("left")(I.pc(e.x)),D.style("top")(I.pc(e.y)),D.style("background-color")(t)])([]),T=["blue","red","magenta","orange","brown","cyan","gray","black"],O=e=>F.div([D["class'"]("roue-inner")(!0)])([C.svg([C.viewBox(0)(0)(100)(100)])(r.mapWithIndex(t=>n=>C.path(_(50)(50)(50)(2*y.pi*(c.toNumber(t)-.5)/c.toNumber(e))(2*y.pi*(c.toNumber(t)+.5)/c.toNumber(e)))([C.fill(n),C.stroke("black")]))(r.take(e)(T)))]);t.view=e=>{var t=f.validRotation(e),w=d.viewOn(e)(f._size(v.strongForget)),A=[D.text("blah blah")],E=d.viewOn(e)(g._position(v.strongForget)),N=F.div([D["class'"]("roue-outer")(!0),D.style("transform")("rotate("+h.show(h.showNumber)(360*c.toNumber(d.viewOn(e)(f._rotation(v.strongForget)))/c.toNumber(w))+"deg)")])(m.append(m.semigroupArray)([C.svg([D.key("svg"),C.viewBox(0)(0)(100)(100)])(b.map2(E)(f.aligned(e))(t=>n=>a=>C.path(_(50)(50)(50)(2*y.pi*(c.toNumber(t)-.5)/c.toNumber(w))(2*y.pi*(c.toNumber(t)+.5)/c.toNumber(w)))(m.append(m.semigroupArray)([D["class'"]("roue-wheel-part")(!0),C.fill(a?f["validRotation'"](e)?"lightgreen":"#F5B7B1":"#F0B27A")])(x.dndItemProps(f.eqLoc)(f.withdnd)(f.roueGame)({currentDragged:d.viewOn(e)(f._dragged(v.strongForget)),draggable:p.isJust(n),droppable:!0,id:new f.Wheel(t)})(e)))))])(r.catMaybes(r.mapWithIndex(e=>t=>u.mapFlipped(p.functorMaybe)(t)(t=>F.div([D.class_("roue-outer-piece"),D.key(h.show(h.showInt)(e)),D.style("left")(I.pc(.44+.4*y.cos(2*c.toNumber(e)*y.pi/c.toNumber(w)))),D.style("top")(I.pc(.44+.4*y.sin(2*c.toNumber(e)*y.pi/c.toNumber(w)))),D.style("background-color")(p.fromMaybe("")(r.index(T)(t)))])([])))(E)))),R=a.bind(p.bindMaybe)(d.viewOn(e)(f._dragged(v.strongForget)))(e=>{var t=(()=>e instanceof f.Panel?e.value0:e instanceof f.Wheel?p.fromMaybe(-1)(a.join(p.bindMaybe)(r.index(E)(e.value0))):-1)();return r.index(T)(t)}),L=x.card("Roue des couleurs")([M.iconSelectGroup(M.defint)(i.eqInt)(e)("Nombre de couleurs")([4,5,6,7,8])(w)(f.SetSize.create)(s.const(o.identity(o.categoryFn))),M.icongroup("Options")([M.ireset(f.withcore)(e),M.irules(f.withcore)(e)])]),q=F.div(m.append(m.semigroupArray)(x.dndBoardProps(f.withcore)(f.withdnd))([D.class_("roue-board")]))([F.div([D.class_("roue-buttons")])(r.concat([[F.button([D.class_("ui-button ui-button-primary roue-button"),S.disabled(d.viewOn(e)(g._locked(v.strongForget))),P.onclick(new f.Rotate(-1))])([D.text("↶")])],r.mapWithIndex(t=>n=>F.div(m.append(m.semigroupArray)([D.class_("roue-select-color ui-flex-center"),D.style("background-color")(n)])(x.dndItemProps(f.eqLoc)(f.withdnd)(f.roueGame)({currentDragged:d.viewOn(e)(f._dragged(v.strongForget)),draggable:!0,droppable:!1,id:new f.Panel(t)})(e)))([D.when(l.elem(l.foldableArray)(p.eqMaybe(i.eqInt))(new p.Just(t))(E))(e=>F.span([])([D.text("✓")]))]))(r.take(w)(T)),[F.button([D.class_("ui-button ui-button-primary roue-button"),S.disabled(d.viewOn(e)(g._locked(v.strongForget))),P.onclick(new f.Rotate(1))])([D.text("↷")])]])),F.div([D.class_("roue-roue")])([N,O(w),F.button([D.class_("ui-button ui-button-primary roue-validate"),S.disabled(!t||d.viewOn(e)(g._locked(v.strongForget))),P.onclick(f.Check.value)])([D.text("Valider")]),F.div([D.class_("roue-valid-rotation")])([(()=>t?F.span([D.class_("valid")])([D.text("✓")]):F.span([D.class_("invalid")])([D.text("✗")]))()])]),D.maybeN(n.apply(p.applyMaybe)(u.map(p.functorMaybe)(G)(d.viewOn(e)(g._pointer(v.strongForget))))(R))]);return x.template(b.precord()())(f.withcore)(f.roueGame)({config:L,board:q,rules:A,winTitle:"GAGNÉ"})(e)}})(PS),(e=>{"use strict";e["Game.Roue"]=e["Game.Roue"]||{};var t=e["Game.Roue"],n=e["Data.Function"],a=e["Data.Maybe"],o=e["Game.Core"],r=e["Game.Roue.Model"],i=e["Game.Roue.View"],l={init:new a.Just(o.core(r.withcore)(o.Init.value)),view:i.view,onKeydown:n.const(a.Nothing.value)};t.game=l})(PS),function(e){"use strict";e["Game.Sansmot.Model"]=e["Game.Sansmot.Model"]||{};var t=e["Game.Sansmot.Model"],n=e["Control.Bind"],a=e["Control.Monad"],o=e["Data.Foldable"],r=e["Data.Functor"],i=e["Data.Lens.At"],l=e["Data.Lens.Getter"],s=e["Data.Lens.Internal.Forget"],u=e["Data.Lens.Lens"],c=e["Data.Lens.Setter"],d=e["Data.Map.Internal"],v=e["Data.Maybe"],p=e["Data.Ord"],m=e["Data.Profunctor.Strong"],h=e["Pha.Action"],w=e["Pha.Effects.Delay"],g=e.Run,f=(()=>{function e(){}return e.value=new e,e})(),b=(()=>{function e(){}return e.value=new e,e})(),y=function(){function e(e,t,n){this.value0=e,this.value1=t,this.value2=n}return e.create=t=>n=>a=>new e(t,n,a),e}(),D=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),S=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),F=[new y(500,"a",1),new y(200,"a",2),new y(600,"b",1),new y(200,"b",2),new y(600,"c",1),new y(200,"c",2),new y(600,"d",1),new y(200,"d",2),new y(600,"e",1)],P={anim:d.empty,locked:!1,page:b.value},C=[new y(700,"a",1),new y(700,"b",1),new y(700,"c",1),new y(700,"d",1),new y(600,"e",1)],I=e=>u.lens(e=>e.locked)(e=>t=>({locked:t,anim:e.anim,page:e.page}))(e),M=e=>u.lens(e=>e.anim)(e=>t=>({anim:t,locked:e.locked,page:e.page}))(e);t.PythaPage=f,t.CarollPage=b,t.pythaAnimation=F,t.carollAnimation=C,t.istate=P,t.SetPage=D,t.Animate=S,t.update=e=>{if(e instanceof D)return a.unlessM(g.monadRun)(r.map(g.functorRun)(l.view(I(s.strongForget)))(h.getState))(h.setState((t=c.set((e=>u.lens(e=>e.page)(e=>t=>({page:t,anim:e.anim,locked:e.locked}))(e))(m.strongFn))(e.value0),f=c.set(M(m.strongFn))(d.empty),e=>t(f(e)))));var t,f,b,y;if(e instanceof S)return a.unlessM(g.monadRun)(r.map(g.functorRun)(l.view(I(s.strongForget)))(h.getState))(n.discard(n.discardUnit)(g.bindRun)(h.setState((b=c.set(I(m.strongFn))(!0),y=c.set(M(m.strongFn))(d.empty),e=>b(y(e)))))(()=>n.discard(n.discardUnit)(g.bindRun)(o.for_(g.applicativeRun)(o.foldableArray)(e.value0)(e=>n.discard(n.discardUnit)(g.bindRun)(w.delay(e.value0))(()=>n.bind(g.bindRun)(h.getState)(t=>{return h.setState(c.set((n=M(m.strongFn),a=i.at(i.atMap(p.ordString))(e.value1)(m.strongFn),e=>n(a(e))))(new v.Just(e.value2)));var n,a}))))(()=>h.setState(c.set(I(m.strongFn))(!1)))));throw new Error("Failed pattern match at Game.Sansmot.Model (line 59, column 1 - line 59, column 35): "+[e.constructor.name])}}(PS),(e=>{"use strict";e["Game.Sansmot.View"]=e["Game.Sansmot.View"]||{};var t=e["Game.Sansmot.View"],n=e["Control.Bind"],a=e["Data.Array"],o=e["Data.Foldable"],r=e["Data.Int"],i=e["Data.Lens.At"],l=e["Data.Lens.Getter"],s=e["Data.Lens.Internal.Forget"],u=e["Data.Map.Internal"],c=e["Data.Maybe"],d=e["Data.Ord"],v=e["Data.Semigroup"],p=e["Data.Show"],m=e["Data.Tuple"],h=e["Game.Sansmot.Model"],w=e["Lib.Util"],g=e.Pha,f=e["Pha.Elements"],b=e["Pha.Events"],y=e["Pha.Svg"],D=e["Pha.Util"],S=e=>t=>n=>a=>o=>y.line(v.append(v.semigroupArray)([g.attr("x1")(p.show(p.showInt)(e)),g.attr("x2")(p.show(p.showInt)(n)),g.attr("y1")(p.show(p.showInt)(t)),g.attr("y2")(p.show(p.showInt)(a))])(o)),F=[g.style("transform")("translate(0px, 0px)")],P=e=>t=>n=>[g.style("transform")(D.translate(D.pc(r.toNumber(n.translation.value0)/e))(D.pc(r.toNumber(n.translation.value1)/t))),g.style("transition")("transform linear "+p.show(p.showInt)(n.duration)+"ms")],C=u.fromFoldable(d.ordString)(o.foldableArray)([new m.Tuple("a",[[y.opacity("0")],F,P(700)(300)({translation:new m.Tuple(400,-100),rotation:0,duration:600})]),new m.Tuple("b",[[y.opacity("0")],F,P(700)(300)({translation:new m.Tuple(600,0),rotation:0,duration:600})]),new m.Tuple("c",[[y.opacity("0")],F,P(700)(300)({translation:new m.Tuple(400,0),rotation:0,duration:600})]),new m.Tuple("d",[[y.opacity("0")],F,P(700)(300)({translation:new m.Tuple(300,200),rotation:0,duration:600})]),new m.Tuple("e",[[y.opacity("0")],[]])]),I=u.fromFoldable(d.ordString)(o.foldableArray)([new m.Tuple("a",[F,P(1370)(270)({translation:new m.Tuple(300,150),rotation:0,duration:600})]),new m.Tuple("b",[F,P(1370)(270)({translation:new m.Tuple(550,50),rotation:0,duration:600})]),new m.Tuple("c",[F,P(1370)(270)({translation:new m.Tuple(700,0),rotation:0,duration:600})]),new m.Tuple("d",[F,P(1370)(270)({translation:new m.Tuple(950,-100),rotation:0,duration:600})]),new m.Tuple("e",[[y.opacity("0")],[]])]),M=e=>{var t=t=>{var o=c.fromMaybe(0)(l.viewOn(e.anim)(i.at(i.atMap(d.ordString))(t)(s.strongForget)));return c.fromMaybe([])(n.bind(c.bindMaybe)(l.viewOn(C)(i.at(i.atMap(d.ordString))(t)(s.strongForget)))(e=>a.index(e)(o)))};return y.svg([g.class_("sansmot-svg"),y.viewBox(0)(0)(700)(300),g.style("width")("84vmin"),g.style("height")("36vmin")])([y.path("M 0 300 h 300 v -300 h -300 Z L 100 100 M 0 100 h 300 l -200 -100 v 300")([y.fill("transparent"),y.stroke("#000")]),y.path("M 400 300 h 300 v -300 h -300 Z M 400 200 l 200 100 l 100 -200 l -200 -100 l -100 200")([y.fill("transparent"),y.stroke("#000")]),y.path("M 0 300 v -200 h 100 Z")(v.append(v.semigroupArray)([y.fill("blue"),y.stroke("#000")])(t("a"))),y.path("M 0 300 h 100 v -200 Z")(v.append(v.semigroupArray)([y.fill("yellow"),y.stroke("#000")])(t("b"))),y.path("M 100 0 h 200 v 100 Z")(v.append(v.semigroupArray)([y.fill("#00FF00"),y.stroke("#000")])(t("c"))),y.path("M 100 0 v 100 h 200 Z")(v.append(v.semigroupArray)([y.fill("red"),y.stroke("#000")])(t("d"))),y.path("M 0 300 v -200 h 100 Z")(v.append(v.semigroupArray)([y.fill("blue"),y.stroke("#000")])(t("e"))),y.path("M 0 300 h 100 v -200 Z")(v.append(v.semigroupArray)([y.fill("yellow"),y.stroke("#000")])(t("e"))),y.path("M 100 0 h 200 v 100 Z")(v.append(v.semigroupArray)([y.fill("#00FF00"),y.stroke("#000")])(t("e"))),y.path("M 100 0 v 100 h 200 0 Z")(v.append(v.semigroupArray)([y.fill("red"),y.stroke("#000")])(t("e"))),y["text'"]("a")(v.append(v.semigroupArray)([y.x_("5"),y.y_("55"),g.style("font-size")("20")])(t("e"))),y["text'"]("a")(v.append(v.semigroupArray)([y.x_("46"),y.y_("12"),g.style("font-size")("20")])(t("e"))),y["text'"]("b")(v.append(v.semigroupArray)([y.x_("105"),y.y_("210"),g.style("font-size")("20")])(t("e"))),y["text'"]("b")(v.append(v.semigroupArray)([y.x_("198"),y.y_("210"),g.style("font-size")("20")])(t("e"))),y["text'"]("c")(v.append(v.semigroupArray)([y.x_("450"),y.y_("98"),g.style("font-size")("20")])(t("e"))),y["text'"]("c")(v.append(v.semigroupArray)([y.x_("595"),y.y_("80"),g.style("font-size")("20")])(t("e")))])},x=e=>{var t=t=>{var o=c.fromMaybe(0)(l.viewOn(e.anim)(i.at(i.atMap(d.ordString))(t)(s.strongForget)));return c.fromMaybe([])(n.bind(c.bindMaybe)(l.viewOn(I)(i.at(i.atMap(d.ordString))(t)(s.strongForget)))(e=>a.index(e)(o)))};return y.svg([g.class_("sansmot-svg"),y.viewBox(-10)(-10)(1370)(270),y.width("90vw"),y.height("19vw")])(a.concat([[y.path("M 400 100 h 250 v -100 Z")(v.append(v.semigroupArray)([y.fill("orange")])(t("a"))),y.path("M 400 200 h 150 v -50 h 100 v -50 h -250 Z")(v.append(v.semigroupArray)([y.fill("red")])(t("b"))),y.path("M 400 250 h 250 v -100 h -100 v 50 h -150 Z")(v.append(v.semigroupArray)([y.fill("blue")])(t("c"))),y.path("M 0 250 h 400 v -150 Z")(v.append(v.semigroupArray)([y.fill("green")])(t("d"))),y.path("M 400 100 h 250 v -100 Z")(v.append(v.semigroupArray)([y.fill("orange")])(t("e"))),y.path("M 400 200 h 150 v -50 h 100 v -50 h -250 Z")(v.append(v.semigroupArray)([y.fill("red")])(t("e"))),y.path("M 400 250 h 250 v -100 h -100 v 50 h -150 Z")(v.append(v.semigroupArray)([y.fill("blue")])(t("e"))),y.path("M 0 250 h 400 v -150 Z")(v.append(v.semigroupArray)([y.fill("green")])(t("e")))],w.tabulate(28)(e=>S(50*e|0)(-10)(50*e|0)(260)([g.class_("sansmot-grid")])),w.tabulate(6)(e=>S(-10)(50*e|0)(1360)(50*e|0)([g.class_("sansmot-grid")]))]))};t.view=e=>{return f.div([g.class_("sansmot-main")])([f.div([g.class_("sansmot-menu")])([f.div([g.class_("sansmot-pagelink"),b.onclick(new h.SetPage(h.PythaPage.value))])([g.text("1")]),f.div([g.class_("sansmot-pagelink"),b.onclick(new h.SetPage(h.CarollPage.value))])([g.text("2")])]),(t=>{if(t instanceof h.PythaPage)return f.div([g.key("pytha")])([f.h1([g.class_("sansmot-title")])([g.text("Preuve sans mot")]),f.h2([g.class_("sansmot-h2")])([g.text("Que raconte le théorème de Pythagore ?")]),f.p([g.class_("sansmot-center")])([y.svg([g.class_("sansmot-svg"),y.viewBox(0)(-100)(200)(250),y.width("20vmin"),y.height("25vmin")])([y.path("M 50 50 h 100 v 100 h -100 Z")([y.fill("yellow"),y.stroke("black")]),y.path("M 0 0 h 50 v 50 h -50 Z")([y.fill("yellow"),y.stroke("black")]),y.path("M 50 0 l 100 50 l 50 -100 l -100 -50 Z")([y.fill("#00ff00"),y.stroke("black")]),y["text'"]("a²")([y.x_("90"),y.y_("105"),g.attr("font-size")("35")]),y["text'"]("b²")([y.x_("18"),y.y_("35"),g.attr("font-size")("35")]),y["text'"]("c²")([y.x_("110"),y.y_("-10"),g.attr("font-size")("35")])])]),f.h2([g.class_("sansmot-h2")])([g.text("Preuve sans mot due à un auteur chinois inconnu qui vivait vers 200 avant J.-C.")]),f.p([g.class_("sansmot-center")])([M(e)]),f.p([g.class_("sansmot-center sansmot-link"),b.onclick(new h.Animate(h.pythaAnimation))])([g.text("Lancer l'animation")])]);if(t instanceof h.CarollPage)return f.div([g.key("caroll")])([f.h1([g.class_("sansmot-title")])([g.text("Preuve sans mot")]),f.h2([g.class_("sansmot-h2")])([g.text("Où est passé le carré manquant ?")]),f.p([g.class_("sansmot-center")])([x(e)]),f.p([g.class_("sansmot-center sansmot-link"),b.onclick(new h.Animate(h.carollAnimation))])([g.text("Lancer l'animation")])]);throw new Error("Failed pattern match at Game.Sansmot.View (line 105, column 5 - line 126, column 6): "+[t.constructor.name])})(e.page)])}})(PS),(e=>{"use strict";e["Game.Sansmot"]=e["Game.Sansmot"]||{};var t=e["Game.Sansmot"],n=e["Data.Function"],a=e["Data.Maybe"],o=e["Game.Sansmot.View"],r={init:a.Nothing.value,view:o.view,onKeydown:n.const(a.Nothing.value)};t.game=r})(PS),function(e){"use strict";e["Game.Solitaire.Model"]=e["Game.Solitaire.Model"]||{};var t,n,a,o,r=e["Game.Solitaire.Model"],i=e["Control.Applicative"],l=e["Control.Bind"],s=e["Control.Category"],u=e["Data.Array"],c=e["Data.Eq"],d=e["Data.EuclideanRing"],v=e["Data.Foldable"],p=e["Data.FoldableWithIndex"],m=e["Data.Functor"],h=e["Data.HeytingAlgebra"],w=e["Data.Lens.Getter"],g=e["Data.Lens.Index"],f=e["Data.Lens.Internal.Forget"],b=e["Data.Lens.Internal.Wander"],y=e["Data.Lens.Iso"],D=e["Data.Lens.Lens"],S=e["Data.Lens.Setter"],F=e["Data.Maybe"],P=e["Data.Ord"],C=e["Data.Profunctor.Strong"],I=e["Data.Semigroup"],M=e["Data.Show"],x=e["Data.String.Common"],A=e["Data.Traversable"],_=e["Data.Tuple"],G=e["Game.Core"],T=e["Lib.Util"],O=e["Pha.Action"],E=e["Pha.Effects.Random"],N=e.Run,R=(()=>{function e(){}return e.value=new e,e})(),L=(()=>{function e(){}return e.value=new e,e})(),q=(()=>{function e(){}return e.value=new e,e})(),k=(()=>{function e(){}return e.value=new e,e})(),U=(()=>{function e(){}return e.value=new e,e})(),B=e=>e,J=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),W=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),z=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),j=new G.MsgWithDnd(W.create),V=new G.MsgWithCore(J.create),H=new M.Show(e=>{if(e instanceof R)return"french";if(e instanceof L)return"english";if(e instanceof q)return"circle";if(e instanceof k)return"grid3";if(e instanceof U)return"random";throw new Error("Failed pattern match at Game.Solitaire.Model (line 19, column 1 - line 24, column 32): "+[e.constructor.name])}),Q=G.genState([])(e=>({position:e.position,history:e.history,redoHistory:e.redoHistory,dialog:e.dialog,turn:e.turn,nbRows:5,nbColumns:1,customSize:e.customSize,mode:e.mode,help:e.help,locked:e.locked,showWin:e.showWin,scores:e.scores,pointer:e.pointer}))({board:q.value,holes:[],dragged:F.Nothing.value,help:0}),K=e=>t=>n=>a=>{var o=T.tabulate2(e)(t)(a);return{holes:o,position:i.pure(N.applicativeRun)(S.set(g.ix(g.indexArray)(n)(b.wanderFunction))(!1)(o)),customSize:!1}},Z=new c.Eq(e=>t=>e instanceof R&&t instanceof R||(e instanceof L&&t instanceof L||(e instanceof q&&t instanceof q||(e instanceof k&&t instanceof k||e instanceof U&&t instanceof U)))),X=e=>{var t=G._ext(e),n=y.iso(e=>e)(B)(e.Profunctor0());return e=>t(n(e))},Y=e=>{var t=X(e),n=D.lens(e=>e.help)(e=>t=>({help:t,board:e.board,dragged:e.dragged,holes:e.holes}))(e);return e=>t(n(e))},$=e=>{var t=X(e),n=D.lens(e=>e.holes)(e=>t=>({holes:t,board:e.board,dragged:e.dragged,help:e.help}))(e);return e=>t(n(e))},ee=e=>{var t=X(e),n=D.lens(e=>e.dragged)(e=>t=>({dragged:t,board:e.board,help:e.help,holes:e.holes}))(e);return e=>t(n(e))},te=e=>{var t=X(e),n=D.lens(e=>e.board)(e=>t=>({board:t,dragged:e.dragged,help:e.help,holes:e.holes}))(e);return e=>t(n(e))},ne=new G.ScoreGame(()=>ae,e=>c.eq(Z)(w.viewOn(e)(te(f.strongForget)))(U.value),e=>G.Minimize.value,(t=u.filter(s.identity(s.categoryFn)),n=w.view(G._position(f.strongForget)),e=>u.length(t(n(e)))),e=>x.joinWith("-")([M.show(H)(w.viewOn(e)(te(f.strongForget))),M.show(M.showInt)(w.viewOn(e)(G._nbRows(f.strongForget))),M.show(M.showInt)(w.viewOn(e)(G._nbColumns(f.strongForget)))])),ae=new G.Game(e=>i.pure(N.applicativeRun)(F.Nothing.value),(a=i.pure(N.applicativeRun),o=w.view(G._position(f.strongForget)),e=>a(o(e))),e=>p.allWithIndex(p.foldableWithIndexArray)(h.heytingAlgebraBoolean)(t=>n=>v.all(v.foldableArray)(h.heytingAlgebraBoolean)(n=>h.not(h.heytingAlgebraFunction(h.heytingAlgebraFunction(h.heytingAlgebraBoolean)))(G.canPlay(ae))(e)({from:t,to:t+n|0}))([2,-2,2*w.viewOn(e)(G._nbColumns(f.strongForget))|0,-2*w.viewOn(e)(G._nbColumns(f.strongForget))|0,w.viewOn(e)(G._nbRows(f.strongForget))-2|0]))(w.viewOn(e)(G._position(f.strongForget))),e=>{var t=w.viewOn(e)(G._nbRows(f.strongForget)),n=w.viewOn(e)(G._nbColumns(f.strongForget)),a=(()=>{var a=w.viewOn(e)(te(f.strongForget));if(a instanceof L)return K(7)(7)(24)(e=>t=>P.min(P.ordInt)(e)(6-e|0)>=2||P.min(P.ordInt)(t)(6-t|0)>=2);if(a instanceof R)return K(7)(7)(24)(e=>t=>(P.min(P.ordInt)(e)(6-e|0)+P.min(P.ordInt)(t)(6-t|0)|0)>=2);if(a instanceof q)return{holes:u.replicate(t)(!0),position:m.mapFlipped(N.functorRun)(E.randomInt(t))(e=>T.tabulate(t)(t=>t!==e)),customSize:!0};if(a instanceof k)return{holes:u.replicate(3*w.viewOn(e)(G._nbColumns(f.strongForget))|0)(!0),position:i.pure(N.applicativeRun)(T.tabulate(3*w.viewOn(e)(G._nbColumns(f.strongForget))|0)(e=>e<(2*n|0))),customSize:!0};if(a instanceof U)return{holes:u.replicate(3*w.viewOn(e)(G._nbColumns(f.strongForget))|0)(!0),position:m.mapFlipped(N.functorRun)(A.sequence(A.traversableArray)(N.applicativeRun)(u.replicate(n)(E.randomBool)))(e=>I.append(I.semigroupArray)(e)(I.append(I.semigroupArray)(u.replicate(n)(!0))(m.mapFlipped(m.functorArray)(e)(h.not(h.heytingAlgebraBoolean))))),customSize:!0};throw new Error("Failed pattern match at Game.Solitaire.Model (line 110, column 13 - line 128, column 18): "+[a.constructor.name])})();return m.mapFlipped(N.functorRun)(a.position)(t=>S.set(G._customSize(C.strongFn))(a.customSize)(S.set(G._position(C.strongFn))(t)(S.set($(C.strongFn))(a.holes)(e))))},e=>t=>{var n=w.viewOn(e)(G._position(f.strongForget));return l.bind(F.bindMaybe)((e=>t=>{var n=w.viewOn(e)(G._nbRows(f.strongForget));return c.eq(Z)(w.viewOn(e)(te(f.strongForget)))(q.value)?l.bind(F.bindMaybe)((e=>t=>n=>{return 2==(e-t|0)||2==(t-e|0)?F.Just.create(d.div(d.euclideanRingInt)(e+t|0)(2)):2===d.mod(d.euclideanRingInt)(t-e|0)(n)?F.Just.create(d.mod(d.euclideanRingInt)(e+1|0)(n)):2===d.mod(d.euclideanRingInt)(e-t|0)(n)?F.Just.create(d.mod(d.euclideanRingInt)(t+1|0)(n)):F.Nothing.value})(t.from)(t.to)(n))(t=>i.pure(F.applicativeMaybe)(4===n&&F.maybe(!1)(h.not(h.heytingAlgebraBoolean))(u.index(w.viewOn(e)(G._position(f.strongForget)))(t))?d.mod(d.euclideanRingInt)(t+2|0)(4):t)):(e=>t=>{var n=T.dCoords(w.viewOn(e)(G._nbColumns(f.strongForget)))(t.from)(t.to);return 4==((n.row*n.row|0)+(n.col*n.col|0)|0)?F.Just.create(d.div(d.euclideanRingInt)(t.from+t.to|0)(2)):F.Nothing.value})(e)(t)})(e)(t))(a=>l.bind(F.bindMaybe)(u.index(n)(t.from))(o=>l.bind(F.bindMaybe)(u.index(n)(a))(r=>l.bind(F.bindMaybe)(u.index(n)(t.to))(i=>l.bind(F.bindMaybe)(u.index(w.viewOn(e)($(f.strongForget)))(t.to))(e=>{return o&&r&&e&&!i?F.Just.create(u.updateAtIndices(v.foldableArray)([new _.Tuple(t.from,!1),new _.Tuple(a,!1),new _.Tuple(t.to,!0)])(n)):F.Nothing.value})))))},e=>{var t=w.viewOn(e)(te(f.strongForget));return t instanceof q?new G.SizeLimit(3,1,12,1):t instanceof k?new G.SizeLimit(3,1,3,9):t instanceof U?new G.SizeLimit(3,1,3,9):new G.SizeLimit(7,7,7,7)},G["updateScore'"](ne)(G.AlwaysShowWin.value));r.FrenchBoard=R,r.EnglishBoard=L,r.CircleBoard=q,r.Grid3Board=k,r.RandomBoard=U,r.istate=Q,r._board=te,r._holes=$,r._dragged=ee,r._help=Y,r.SetBoard=z,r.update=e=>{if(e instanceof J&&e.value0 instanceof G.ToggleHelp)return O.setState(S.over(Y(C.strongFn))(e=>d.mod(d.euclideanRingInt)(e+1|0)(3)));if(e instanceof J)return G.coreUpdate(ae)(e.value0);if(e instanceof W)return G.dndUpdate(c.eqInt)(ae)(e=>ee(e))(e.value0);if(e instanceof z)return G.newGame(ae)(t=>{var n=S.set(te(C.strongFn))(e.value0)(t);return e.value0 instanceof q?S.set(G._nbColumns(C.strongFn))(1)(S.set(G._nbRows(C.strongFn))(6)(n)):e.value0 instanceof k?S.set(G._nbColumns(C.strongFn))(5)(S.set(G._nbRows(C.strongFn))(3)(n)):e.value0 instanceof U?S.set(G._nbColumns(C.strongFn))(5)(S.set(G._nbRows(C.strongFn))(3)(n)):S.set(G._nbColumns(C.strongFn))(7)(S.set(G._nbRows(C.strongFn))(7)(n))});throw new Error("Failed pattern match at Game.Solitaire.Model (line 149, column 1 - line 149, column 35): "+[e.constructor.name])},r.boardMode=Z,r.solitaireGame=ae,r.scoregame=ne,r.withcore=V,r.withdnd=j}(PS),(e=>{"use strict";e["Game.Solitaire.View"]=e["Game.Solitaire.View"]||{};var t=e["Game.Solitaire.View"],n=e["Control.Apply"],a=e["Data.Array"],o=e["Data.Eq"],r=e["Data.EuclideanRing"],i=e["Data.Functor"],l=e["Data.Int"],s=e["Data.Lens.Getter"],u=e["Data.Lens.Internal.Forget"],c=e["Data.Maybe"],d=e["Data.Semigroup"],v=e["Data.Show"],p=e["Game.Core"],m=e["Game.Solitaire.Model"],h=e["Lib.Util"],w=e.Math,g=e.Pha,f=e["Pha.Elements"],b=e["Pha.Svg"],y=e["Pha.Util"],D=e["UI.Icon"],S=e["UI.Icons"],F=e["UI.Template"],P=e=>t=>n=>{var a=r.mod(r.euclideanRingInt)(r.mod(r.euclideanRingInt)(e)(t)+(n*r.div(r.euclideanRingInt)(e)(t)|0)|0)(3);return 0===a?"red":1===a?"blue":"green"},C=e=>t=>b.circle(d.append(d.semigroupArray)([b.r("20"),g.attr("pointer-events")("none"),b.fill("url(#soli-peg)")])(F.svgCursorStyle(e)));t.view=e=>{var t,r=[g.text("Jeu du solitaire"),f.br,g.text("blah blah")],I=s.viewOn(e)(p._nbRows(u.strongForget)),M=p.scoreFn(m.scoregame)(e),x=M>1?"s":"",A=v.show(v.showInt)(M)+" jeton"+x+" restant"+x,_=o.eq(m.boardMode)(s.viewOn(e)(m._board(u.strongForget)))(m.CircleBoard.value),G=(t=[m.CircleBoard.value,m.Grid3Board.value,m.RandomBoard.value,m.EnglishBoard.value,m.FrenchBoard.value],F.card("Jeu du solitaire")([S.iconSelectGroup(S.defa)(m.boardMode)(e)("Plateau")(t)(s.viewOn(e)(m._board(u.strongForget)))(m.SetBoard.create)(e=>t=>{if(e instanceof m.CircleBoard)return{icon:new D.IconSymbol("#circle"),selected:t.selected,tooltip:new c.Just("Cercle"),round:t.round,large:t.large,hidden:t.hidden,disabled:t.disabled,style:t.style};if(e instanceof m.Grid3Board)return{icon:new D.IconText("3xN"),selected:t.selected,tooltip:new c.Just("3xN"),round:t.round,large:t.large,hidden:t.hidden,disabled:t.disabled,style:t.style};if(e instanceof m.RandomBoard)return{icon:new D.IconSymbol("#shuffle"),selected:t.selected,tooltip:new c.Just("Aléatoire"),round:t.round,large:t.large,hidden:t.hidden,disabled:t.disabled,style:t.style};if(e instanceof m.EnglishBoard)return{icon:new D.IconSymbol("#tea"),selected:t.selected,tooltip:new c.Just("Anglais"),round:t.round,large:t.large,hidden:t.hidden,disabled:t.disabled,style:t.style};if(e instanceof m.FrenchBoard)return{icon:new D.IconSymbol("#bread"),selected:t.selected,tooltip:new c.Just("Français"),round:t.round,large:t.large,hidden:t.hidden,disabled:t.disabled,style:t.style};throw new Error("Failed pattern match at Game.Solitaire.View (line 44, column 87 - line 49, column 91): "+[e.constructor.name])}),S.icongroup("Options")(i.mapFlipped(i.functorArray)([S.ihelp(m.withcore),S.iundo(m.withcore),S.iredo(m.withcore),S.ireset(m.withcore),S.irules(m.withcore)])(t=>t(e))),S.iconBestScore(m.withcore)(m.scoregame)(e)])),T=s.viewOn(e)(p._nbColumns(u.strongForget)),O=e=>{var t=h.coords(T)(e);return _?y.translate(y.px(125+90*w.sin(2*w.pi*l.toNumber(e)/l.toNumber(I))))(y.px(125+90*w.cos(2*w.pi*l.toNumber(e)/l.toNumber(I)))):y.translate(y.px(50*l.toNumber(t.col)+25))(y.px(50*l.toNumber(t.row)+25))},E=f.div(d.append(d.semigroupArray)([g["class'"]("ui-board")(!0)])(d.append(d.semigroupArray)(F.dndBoardProps(m.withcore)(m.withdnd))((()=>_?[g.style("width")("100%"),g.style("height")("100%")]:F.gridStyle(I)(T)(5))())))([b.svg([(()=>_?b.viewBox(0)(0)(250)(250):b.viewBox(0)(0)(50*T|0)(50*I|0))()])(a.concat([[g.when(_)(e=>b.circle([b.cx("125"),b.cy("125"),b.r("90"),b.stroke("grey"),b.fill("transparent"),b.strokeWidth("5")]))],a.concat(a.mapWithIndex(t=>n=>{return!n?[]:[g.when(s.viewOn(e)(m._help(u.strongForget))>0&&!_)(n=>b.rect([b.x_("-25.0"),b.y_("-25"),b.width("50"),b.height("50"),g.key("rect"+v.show(v.showInt)(t)),b.fill(P(t)(T)(s.viewOn(e)(m._help(u.strongForget)))),g.style("transform")(O(t))])),b.circle(d.append(d.semigroupArray)([g.key("h"+v.show(v.showInt)(t)),b.r("17"),b.fill("url(#soli-hole)"),g["class'"]("solitaire-hole")(!0),g.style("transform")(O(t))])(F.dndItemProps(o.eqInt)(m.withdnd)(m.solitaireGame)({currentDragged:s.viewOn(e)(m._dragged(u.strongForget)),draggable:!1,droppable:!0,id:t})(e)))]})(s.viewOn(e)(m._holes(u.strongForget)))),a.mapWithIndex(t=>n=>g.when(n)(n=>b.circle(d.append(d.semigroupArray)([b.r("20"),g.key("p"+v.show(v.showInt)(t)),b.fill("url(#soli-peg)"),g["class'"]("solitaire-peg")(!0),g.style("transform")(O(t))])(F.dndItemProps(o.eqInt)(m.withdnd)(m.solitaireGame)({draggable:!0,droppable:!1,currentDragged:s.viewOn(e)(m._dragged(u.strongForget)),id:t})(e)))))(s.viewOn(e)(p._position(u.strongForget))),[g.maybeN(n.apply(c.applyMaybe)(i.map(c.functorMaybe)(C)(s.viewOn(e)(p._pointer(u.strongForget))))(s.viewOn(e)(m._dragged(u.strongForget))))]]))]),N=F.incDecGrid(m.withcore)(m.solitaireGame)(e)([E]);return F.template(h.precord()())(m.withcore)(m.solitaireGame)({config:G,board:N,rules:r,winTitle:A,scoreDialog:t=>F.bestScoreDialog(m.withcore)(m.scoregame)(e)(t=>[f.div([g["class'"]("ui-flex-center solitaire-scoredialog")(!0)])([f.div(d.append(d.semigroupArray)([g["class'"]("ui-board")(!0)])((()=>_?[g.style("width")("100%"),g.style("height")("100%")]:F.gridStyle(I)(T)(5))()))([b.svg([(()=>_?b.viewBox(0)(0)(250)(250):b.viewBox(0)(0)(50*T|0)(50*I|0))()])(a.concat([[g.when(_)(e=>b.circle([b.cx("125"),b.cy("125"),b.r("90"),b.stroke("grey"),b.fill("transparent"),b.strokeWidth("5")]))],a.mapWithIndex(e=>t=>g.when(t)(t=>b.circle([g.key("h"+v.show(v.showInt)(e)),b.r("17"),b.fill("url(#soli-hole)"),g.class_("solitaire-hole"),g.style("transform")(O(e))])))(s.viewOn(e)(m._holes(u.strongForget))),a.mapWithIndex(e=>t=>g.when(t)(t=>b.circle([g.key("p"+v.show(v.showInt)(e)),b.r("20"),b.fill("url(#soli-peg)"),g.class_("solitaire-peg"),g.style("transform")(O(e))])))(t)]))])])])})(e)}})(PS),(e=>{"use strict";e["Game.Solitaire"]=e["Game.Solitaire"]||{};var t=e["Game.Solitaire"],n=e["Data.Function"],a=e["Data.Maybe"],o=e["Game.Core"],r=e["Game.Solitaire.Model"],i=e["Game.Solitaire.View"],l={init:new a.Just(o.core(r.withcore)(o.Init.value)),view:i.view,onKeydown:n.const(a.Nothing.value)};t.game=l})(PS),function(e){"use strict";e["Game.Tiling.Model"]=e["Game.Tiling.Model"]||{};var t,n,a=e["Game.Tiling.Model"],o=e["Control.Applicative"],r=e["Control.Category"],i=e["Data.Array"],l=e["Data.Eq"],s=e["Data.EuclideanRing"],u=e["Data.Foldable"],c=e["Data.Function"],d=e["Data.Functor"],v=e["Data.HeytingAlgebra"],p=e["Data.Lens.Getter"],m=e["Data.Lens.Index"],h=e["Data.Lens.Internal.Forget"],w=e["Data.Lens.Internal.Wander"],g=e["Data.Lens.Iso"],f=e["Data.Lens.Lens"],b=e["Data.Lens.Setter"],y=e["Data.Maybe"],D=e["Data.Ord"],S=e["Data.Profunctor"],F=e["Data.Profunctor.Strong"],P=e["Data.Show"],C=e["Data.Tuple"],I=e["Game.Common"],M=e["Game.Core"],x=e["Lib.Util"],A=e["Pha.Action"],_=e.Run,G=(()=>{function e(){}return e.value=new e,e})(),T=(()=>{function e(){}return e.value=new e,e})(),O=(()=>{function e(){}return e.value=new e,e})(),E=(()=>{function e(){}return e.value=new e,e})(),N=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),R=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),L=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),q=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),k=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),U=(()=>{function e(){}return e.value=new e,e})(),B=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),J=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),W=e=>e,z=new M.MsgWithCore(N.create),j=e=>i.catMaybes(i.mapWithIndex(e=>t=>{return-1===t?new y.Just(e):y.Nothing.value})(p.viewOn(e)(M._position(h.strongForget)))),V=new P.Show(e=>{if(e instanceof G)return"beast1";if(e instanceof T)return"beast2";if(e instanceof O)return"beast3";if(e instanceof E)return"customize";throw new Error("Failed pattern match at Game.Tiling.Model (line 17, column 1 - line 21, column 34): "+[e.constructor.name])}),H=d.map(d.functorArray)(e=>({row:e.col,col:0|-e.row})),Q=M.genState([])(e=>({position:e.position,history:e.history,redoHistory:e.redoHistory,dialog:e.dialog,turn:e.turn,nbRows:5,nbColumns:5,customSize:e.customSize,mode:e.mode,help:e.help,locked:e.locked,showWin:e.showWin,scores:e.scores,pointer:e.pointer}))({rotation:0,tileType:G.value,tile:[],nbSinks:0,hoverSquare:y.Nothing.value}),K=new l.Eq(e=>t=>e instanceof G&&t instanceof G||(e instanceof T&&t instanceof T||(e instanceof O&&t instanceof O||e instanceof E&&t instanceof E))),Z=e=>{var t=M._ext(e),n=g.iso(e=>e)(W)(e.Profunctor0());return e=>t(n(e))},X=e=>{var t=Z(e),n=f.lens(e=>e.hoverSquare)(e=>t=>({hoverSquare:t,nbSinks:e.nbSinks,rotation:e.rotation,tile:e.tile,tileType:e.tileType}))(e);return e=>t(n(e))},Y=e=>{var t=Z(e),n=f.lens(e=>e.nbSinks)(e=>t=>({nbSinks:t,hoverSquare:e.hoverSquare,rotation:e.rotation,tile:e.tile,tileType:e.tileType}))(e);return e=>t(n(e))},$=e=>{var t=Z(e),n=f.lens(e=>e.rotation)(e=>t=>({rotation:t,hoverSquare:e.hoverSquare,nbSinks:e.nbSinks,tile:e.tile,tileType:e.tileType}))(e);return e=>t(n(e))},ee=e=>{var t=Z(e),n=f.lens(e=>e.tile)(e=>t=>({tile:t,hoverSquare:e.hoverSquare,nbSinks:e.nbSinks,rotation:e.rotation,tileType:e.tileType}))(e);return e=>t(n(e))},te=e=>{var t=Z(e),n=f.lens(e=>e.tileType)(e=>t=>({tileType:t,hoverSquare:e.hoverSquare,nbSinks:e.nbSinks,rotation:e.rotation,tile:e.tile}))(e);return e=>t(n(e))},ne=new M.Game(e=>o.pure(_.applicativeRun)(y.Nothing.value),e=>o.pure(_.applicativeRun)(i.replicate(p.viewOn(e)(M._nbRows(h.strongForget))*p.viewOn(e)(M._nbColumns(h.strongForget))|0)(0)),(t=u.all(u.foldableArray)(v.heytingAlgebraBoolean)(e=>0!==e),n=p.view(M._position(h.strongForget)),e=>t(n(e))),e=>o.pure(_.applicativeRun)(b.set($(F.strongFn))(0)(b.set(ee(F.strongFn))((e=>{var t=p.viewOn(e)(te(h.strongForget));if(t instanceof G)return[{row:0,col:0},{row:0,col:1}];if(t instanceof T)return[{row:0,col:0},{row:0,col:1},{row:0,col:-1}];if(t instanceof O)return[{row:0,col:0},{row:0,col:1},{row:1,col:0}];if(t instanceof E)return p.viewOn(e)(ee(h.strongForget));throw new Error("Failed pattern match at Game.Tiling.Model (line 70, column 17 - line 74, column 31): "+[t.constructor.name])})(e))(e))),e=>t=>{var n=(e=>t=>{var n=p.viewOn(e)(M._nbColumns(h.strongForget));return d.mapFlipped(d.functorArray)((e=>d.map(d.functorArray)(t=>({row:t.row+e.row|0,col:t.col+e.col|0})))(x.coords(n)(t))((e=>t=>{var n,a=e,o=!1;function r(e,n){if(0===e)return o=!0,n;a=e-1|0,t=H(n)}for(;!o;)n=r(a,t);return n})(s.mod(s.euclideanRingInt)(p.viewOn(e)($(h.strongForget)))(4))(p.viewOn(e)(ee(h.strongForget)))))(e=>{return 0<=e.col&&e.col<n?(e.row*n|0)+e.col|0:-1})})(e)(t),a=p.viewOn(e)(M._position(h.strongForget));if((e=>u.all(u.foldableArray)(v.heytingAlgebraBoolean)(t=>l.eq(y.eqMaybe(l.eqInt))(i.index(p.viewOn(e)(M._position(h.strongForget)))(t))(new y.Just(0))))(e)(n)){var o=u.foldr(u.foldableArray)(D.max(D.ordInt))(0)(a)+1|0;return y.Just.create(i.updateAtIndices(u.foldableArray)(d.mapFlipped(d.functorArray)(n)(e=>new C.Tuple(e,o)))(a))}return D.greaterThan(y.ordMaybe(D.ordInt))(i.index(p.viewOn(e)(M._position(h.strongForget)))(t))(new y.Just(0))?y.Just.create(d.mapFlipped(d.functorArray)(a)(e=>{return l.eq(y.eqMaybe(l.eqInt))(new y.Just(e))(i.index(a)(t))?0:e})):y.Nothing.value},c.const(new M.SizeLimit(3,3,10,10)),e=>new C.Tuple(e,!0));a.Type1=G,a.Type2=T,a.Type3=O,a.CustomTile=E,a.istate=Q,a._rotation=$,a._tile=ee,a._tileType=te,a._nbSinks=Y,a.sinks=j,a.inConflict=e=>{var t=p.viewOn(e)(X(h.strongForget));if(t instanceof y.Nothing)return!1;if(t instanceof y.Just)return l.notEq(y.eqMaybe(l.eqInt))(i.index(p.viewOn(e)(M._position(h.strongForget)))(t.value0))(new y.Just(0))||!M.canPlay(ne)(e)(t.value0);throw new Error("Failed pattern match at Game.Tiling.Model (line 95, column 20 - line 97, column 77): "+[t.constructor.name])},a.needSinks=e=>i.length(j(e))<p.viewOn(e)(Y(h.strongForget)),a.Play=R,a.PutSink=L,a.SetNbSinks=q,a.SetTile=k,a.Rotate=U,a.SetHoverSquare=B,a.FlipTile=J,a.update=e=>{if(e instanceof N)return M.coreUpdate(ne)(e.value0);if(e instanceof R)return M.playA(ne)(e.value0);if(e instanceof L)return A.setState(b.set((t=M._position(F.strongFn),n=m.ix(m.indexArray)(e.value0)(w.wanderFunction),e=>t(n(e))))(-1));var t,n,a,o,i,s,u;if(e instanceof q)return M.newGame(ne)(b.set(Y(F.strongFn))(e.value0));if(e instanceof k)return M.newGame(ne)((a=l.eq(K)(e.value0)(E.value)?b.set(M._dialog(F.strongFn))(M.CustomDialog.value):r.identity(r.categoryFn),o=b.set(te(F.strongFn))(e.value0),e=>a(o(e))));if(e instanceof U)return A.setState(b.over($(F.strongFn))(e=>e+1|0));if(e instanceof B)return A.setState(b.set(X(F.strongFn))(e.value0));if(e instanceof J)return M.newGame(ne)(b.over((i=ee(F.strongFn),s=I._isoCustom(S.profunctorFn),u=m.ix(m.indexArray)(e.value0)(w.wanderFunction),e=>i(s(u(e)))))(v.not(v.heytingAlgebraBoolean)));throw new Error("Failed pattern match at Game.Tiling.Model (line 129, column 1 - line 129, column 35): "+[e.constructor.name])},a.onKeyDown=e=>" "===e?new y.Just(U.value):y.Nothing.value,a.eqTileType=K,a.showTileType=V,a.tilingGame=ne,a.withcore=z}(PS),(e=>{"use strict";e["Game.Tiling.View"]=e["Game.Tiling.View"]||{};var t=e["Game.Tiling.View"],n=e["Control.Category"],a=e["Data.Array"],o=e["Data.Eq"],r=e["Data.Function"],i=e["Data.Functor"],l=e["Data.Int"],s=e["Data.Lens.Getter"],u=e["Data.Lens.Internal.Forget"],c=e["Data.Maybe"],d=e["Data.Semigroup"],v=e["Data.Show"],p=e["Data.Tuple"],m=e["Game.Common"],h=e["Game.Core"],w=e["Game.Tiling.Model"],g=e["Lib.Util"],f=e.Pha,b=e["Pha.Elements"],y=e["Pha.Events"],D=e["Pha.Svg"],S=e["Pha.Util"],F=e["UI.Icon"],P=e["UI.Icons"],C=e["UI.Template"],I=e=>t=>D.g(d.append(d.semigroupArray)([f["class'"]("tiling-darken")(e.isDark),D.transform(S.translate(v.show(v.showInt)(50*e.col|0))(v.show(v.showInt)(50*e.row|0)))])(t))([D.rect([D.width("50"),D.height("50"),f.key("conc"),D.fill("url(#concrete)")]),f.when(e.hasBlock)(e=>D.use("#tile2")([D.width("50"),D.height("50"),f.key("tile")])),f.when(e.hasSink)(e=>D.use("#sink")([D.width("50"),D.height("50"),f.key("sink")]))]);t.view=e=>{var t=t=>D.g(C.svgCursorStyle(t))([D.g([f["class'"]("tiling-cursor")(!0),f.style("transform")("rotate("+v.show(v.showInt)(90*s.viewOn(e)(w._rotation(u.strongForget))|0)+"deg)")])(i.mapFlipped(i.functorArray)(s.viewOn(e)(w._tile(u.strongForget)))(t=>D.use("#tile2")([D.x_(v.show(v.showNumber)(50*l.toNumber(t.col)-25)),D.y_(v.show(v.showNumber)(50*l.toNumber(t.row)-25)),D.width("50"),D.height("50"),f.attr("pointer-events")("none"),f.attr("opacity")(w.inConflict(e)?"0.3":"0.8")])))]),M=e=>D.use("#sink")(d.append(d.semigroupArray)([D.x_("-25"),D.y_("-25"),D.width("50"),D.height("50"),f.attr("pointer-events")("none")])(C.svgCursorStyle(e))),x=[f.text("blah blah")],A=s.viewOn(e)(h._nbRows(u.strongForget)),_=s.viewOn(e)(h._position(u.strongForget)),G=C.card("Carrelage")([P.iconSizesGroup(w.withcore)(e)([new p.Tuple(4,5),new p.Tuple(5,5),new p.Tuple(5,6),new p.Tuple(7,7)])(!0),P.iconSelectGroup(P.defa)(w.eqTileType)(e)("Motif du pavé")([w.Type1.value,w.Type2.value,w.Type3.value,w.CustomTile.value])(s.viewOn(e)(w._tileType(u.strongForget)))(w.SetTile.create)(e=>t=>({icon:new F.IconSymbol("#"+v.show(w.showTileType)(e)),selected:t.selected,tooltip:t.tooltip,round:t.round,large:t.large,hidden:t.hidden,disabled:t.disabled,style:t.style})),P.iconSelectGroup(P.defint)(o.eqInt)(e)("Nombre d'éviers")([0,1,2])(s.viewOn(e)(w._nbSinks(u.strongForget)))(w.SetNbSinks.create)(r.const(n.identity(n.categoryFn))),P.icongroup("Options")([P.ihelp(w.withcore)(e),P.ireset(w.withcore)(e),P.irules(w.withcore)(e)])]),T=s.viewOn(e)(h._nbColumns(u.strongForget)),O=e=>t=>o.notEq(c.eqMaybe(o.eqInt))(a.index(_)(e))(a.index(_)(e+t|0)),E=b.div(d.append(d.semigroupArray)(C.gridStyle(A)(T)(5))(d.append(d.semigroupArray)(C.trackPointer(w.withcore))([f["class'"]("ui-board")(!0),y.oncontextmenu(w.Rotate.value)])))([D.svg([D.viewBox(0)(0)(50*T|0)(50*A|0)])(d.append(d.semigroupArray)(a.mapWithIndex(t=>n=>{var a=g.coords(T)(t);return I({isDark:s.viewOn(e)(h._help(u.strongForget))&&l.even(a.row+a.col|0),hasBlock:n>0,hasSink:-1===n,row:a.row,col:a.col})([y.onclick(w.needSinks(e)?new w.PutSink(t):new w.Play(t)),y.onpointerenter(new w.SetHoverSquare(new c.Just(t))),y.onpointerleave(new w.SetHoverSquare(c.Nothing.value))])})(_))(d.append(d.semigroupArray)(a.mapWithIndex(e=>t=>{var n=g.coords(T)(e);return D.g([D.transform(S.translate(v.show(v.showInt)(50*n.col|0))(v.show(v.showInt)(50*n.row|0)))])([f.when(t>0&&O(e)(-1))(e=>D.line([D.x1("0"),D.y1("0"),D.x2("0"),D.y2("50"),D.stroke("#000"),D.strokeWidth("2")])),f.when(t>0&&O(e)(1))(e=>D.line([D.x1("50"),D.y1("0"),D.x2("50"),D.y2("50"),D.stroke("#000"),D.strokeWidth("2")])),f.when(t>0&&O(e)(0|-T))(e=>D.line([D.x1("0"),D.y1("0"),D.x2("50"),D.y2("0"),D.stroke("#000"),D.strokeWidth("2")])),f.when(t>0&&O(e)(T))(e=>D.line([D.x1("0"),D.y1("50"),D.x2("50"),D.y2("50"),D.stroke("#000"),D.strokeWidth("2")]))])})(_))([f.maybe(s.viewOn(e)(h._pointer(u.strongForget)))(a.length(w.sinks(e))<s.viewOn(e)(w._nbSinks(u.strongForget))?M:t)])))]),N=C.incDecGrid(w.withcore)(w.tilingGame)(e)([E]);return C.template(g.precord()())(w.withcore)(w.tilingGame)({config:G,board:N,rules:x,winTitle:"GAGNÉ",customDialog:t=>{return C.dialog(w.withcore)("Personnalise ta tuile")([b.div([f["class'"]("tiling-customtile-grid-container")(!0)])([b.div([f["class'"]("tiling-grid")(!0)])([D.svg([D.viewBox(0)(0)(250)(250)])(a.mapWithIndex(e=>t=>{var n=g.coords(5)(e);return I({hasBlock:t,row:n.row,col:n.col,hasSink:!1,isDark:!1})([f.key(v.show(v.showInt)(e)),y.onclick(new w.FlipTile(e))])})(s.viewOn(e)((n=w._tile(u.strongForget),o=m._isoCustom(u.profunctorForget),e=>n(o(e))))))])])]);var n,o}})(e)}})(PS),(e=>{"use strict";e["Game.Tiling"]=e["Game.Tiling"]||{};var t=e["Game.Tiling"],n=e["Data.Maybe"],a=e["Game.Core"],o=e["Game.Tiling.Model"],r=e["Game.Tiling.View"],i={init:new n.Just(a.core(o.withcore)(a.Init.value)),view:r.view,onKeydown:o.onKeyDown};t.game=i})(PS),function(e){"use strict";e["Game.Tricolor.Model"]=e["Game.Tricolor.Model"]||{};var t=e["Game.Tricolor.Model"],n=e["Control.Applicative"],a=e["Control.Category"],o=e["Data.Array"],r=e["Data.Eq"],i=e["Data.EuclideanRing"],l=e["Data.Foldable"],s=e["Data.HeytingAlgebra"],u=e["Data.Lens.Getter"],c=e["Data.Lens.Internal.Forget"],d=e["Data.Lens.Iso"],v=e["Data.Lens.Lens"],p=e["Data.Lens.Setter"],m=e["Data.Maybe"],h=e["Data.Ord"],w=e["Data.Profunctor.Strong"],g=e["Data.Traversable"],f=e["Data.Tuple"],b=e["Game.Core"],y=e["Lib.Util"],D=e["Pha.Action"],S=e["Pha.Effects.Random"],F=e.Run,P=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),C=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),I=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),M=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),x=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),A=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),_=e=>e,G=new b.MsgWithCore(P.create),T=b.genState([])(a.identity(a.categoryFn))({size:5,nbColors:2,range:1,hoverCell:m.Nothing.value}),O=e=>{var t=b._ext(e),n=d.iso(e=>e)(_)(e.Profunctor0());return e=>t(n(e))},E=e=>{var t=O(e),n=v.lens(e=>e.hoverCell)(e=>t=>({hoverCell:t,nbColors:e.nbColors,range:e.range,size:e.size}))(e);return e=>t(n(e))},N=e=>{var t=O(e),n=v.lens(e=>e.nbColors)(e=>t=>({nbColors:t,hoverCell:e.hoverCell,range:e.range,size:e.size}))(e);return e=>t(n(e))},R=e=>{var t=O(e),n=v.lens(e=>e.range)(e=>t=>({range:t,hoverCell:e.hoverCell,nbColors:e.nbColors,size:e.size}))(e);return e=>t(n(e))},L=e=>{var t=O(e),n=v.lens(e=>e.size)(e=>t=>({size:t,hoverCell:e.hoverCell,nbColors:e.nbColors,range:e.range}))(e);return e=>t(n(e))},q=e=>t=>n=>{var a=y.abs(t-n|0);return h.min(h.ordInt)(a)(u.viewOn(e)(L(c.strongForget))-a|0)<=u.viewOn(e)(R(c.strongForget))},k=new b.Game(e=>n.pure(F.applicativeRun)(m.Nothing.value),e=>g.sequence(g.traversableArray)(F.applicativeRun)(o.replicate(u.viewOn(e)(L(c.strongForget)))(S.randomInt(u.viewOn(e)(N(c.strongForget))))),e=>l.all(l.foldableArray)(s.heytingAlgebraBoolean)(r.eq(r.eqInt)(0))(u.viewOn(e)(b._position(c.strongForget))),n.pure(F.applicativeRun),e=>t=>m.Just.create(o.mapWithIndex(n=>a=>{return q(e)(t)(n)?i.mod(i.euclideanRingInt)(a+1|0)(u.viewOn(e)(N(c.strongForget))):a})(u.viewOn(e)(b._position(c.strongForget)))),b.defaultSizeLimit,e=>new f.Tuple(e,!0));t._size=L,t._nbColors=N,t._range=R,t._hoverCell=E,t.istate=T,t.inRange=q,t.Play=C,t.SetSize=I,t.SetNbColors=M,t.SetRange=x,t.SetHoverCell=A,t.update=e=>{if(e instanceof P)return b.coreUpdate(k)(e.value0);if(e instanceof C)return b.playA(k)(e.value0);if(e instanceof I)return b.newGame(k)(p.set(L(w.strongFn))(e.value0));if(e instanceof M)return b.newGame(k)(p.set(N(w.strongFn))(e.value0));if(e instanceof x)return b.newGame(k)(p.set(R(w.strongFn))(e.value0));if(e instanceof A)return D.setState(p.set(E(w.strongFn))(e.value0));throw new Error("Failed pattern match at Game.Tricolor.Model (line 58, column 1 - line 58, column 35): "+[e.constructor.name])},t.tricolorGame=k,t.withcore=G}(PS),(e=>{"use strict";e["Game.Tricolor.View"]=e["Game.Tricolor.View"]||{};var t=e["Game.Tricolor.View"],n=e["Control.Category"],a=e["Data.Array"],o=e["Data.Eq"],r=e["Data.Function"],i=e["Data.Functor"],l=e["Data.Int"],s=e["Data.Lens.Getter"],u=e["Data.Lens.Internal.Forget"],c=e["Data.Maybe"],d=e["Data.Show"],v=e["Game.Core"],p=e["Game.Tricolor.Model"],m=e["Lib.Util"],h=e.Math,w=e.Pha,g=e["Pha.Elements"],f=e["Pha.Events"],b=e["Pha.Svg"],y=e["Pha.Util"],D=e["UI.Icons"],S=e["UI.Template"],F=e=>t=>{var n=.45+.35*h.sin(2*l.toNumber(e)*h.pi/l.toNumber(t)),a=.5+.35*h.cos(2*l.toNumber(e)*h.pi/l.toNumber(t));return y.translate(y.pc(a))(y.pc(n))},P=["green","yellow","red","magenta","blue"];t.view=e=>{var t=s.viewOn(e)(p._size(u.strongForget)),l=[w.text("blah blah blah blah")],h=s.viewOn(e)(p._nbColors(u.strongForget)),y=v.isLevelFinished(p.tricolorGame)(e),C=S.card("Feux tricolores")([D.iconSelectGroup(D.defint)(o.eqInt)(e)("Nombre de lumières")([4,5,6,7,8])(t)(p.SetSize.create)(r.const(n.identity(n.categoryFn))),D.iconSelectGroup(D.defint)(o.eqInt)(e)("Nombre de couleurs")([2,3,4,5])(h)(p.SetNbColors.create)(r.const(n.identity(n.categoryFn))),D.iconSelectGroup(D.defint)(o.eqInt)(e)("Portée")([1,2,3])(s.viewOn(e)(p._range(u.strongForget)))(p.SetRange.create)(r.const(n.identity(n.categoryFn))),D.icongroup("Options")(i.mapFlipped(i.functorArray)([D.iundo(p.withcore),D.iredo(p.withcore),D.ireset(p.withcore),D.irules(p.withcore)])(t=>t(e)))]),I=g.div([w.class_("ui-board tricolor-board")])([b.svg([b.viewBox(0)(0)(100)(100)])(a.concat([a.mapWithIndex(n=>r=>b.circle([b.r("7.5"),w.class_("tricolor-cell"),w["class'"]("finished")(y),b.stroke(o.eq(c.eqMaybe(o.eqBoolean))(i.map(c.functorMaybe)(p.inRange(e)(n))(s.viewOn(e)(p._hoverCell(u.strongForget))))(new c.Just(!0))?"lightgreen":"black"),w.key("b"+d.show(d.showInt)(n)),w.style("fill")((()=>y?"":c.fromMaybe("")(a.index(P)(r)))()),w.style("transform")(F(n)(t)),f.onclick(new p.Play(n)),f.onpointerenter(new p.SetHoverCell(new c.Just(n))),f.onpointerleave(new p.SetHoverCell(c.Nothing.value))]))(s.viewOn(e)(v._position(u.strongForget))),a.concat(a.mapWithIndex(e=>t=>[b.circle([b.cx(d.show(d.showInt)(95+(15*(e-h|0)|0)|0)),b.cy("95"),b.r("3"),w.key("c"+d.show(d.showInt)(e)),b.fill(t)]),b["text'"]("➡")([b.cx(d.show(d.showInt)(99+(15*(e-h|0)|0)|0)),b.cy("97"),w.key("t"+d.show(d.showInt)(e)),w.attr("font-size")("7")])])(a.take(h)(P))),[b.circle([b.cx("95"),b.cy("95"),b.r("3"),w.key("fc"),b.fill("green")])]]))]);return S.template(m.precord()())(p.withcore)(p.tricolorGame)({config:C,board:I,rules:l})(e)}})(PS),(e=>{"use strict";e["Game.Tricolor"]=e["Game.Tricolor"]||{};var t=e["Game.Tricolor"],n=e["Data.Function"],a=e["Data.Maybe"],o=e["Game.Core"],r=e["Game.Tricolor.Model"],i=e["Game.Tricolor.View"],l={init:new a.Just(o.core(r.withcore)(o.Init.value)),view:i.view,onKeydown:n.const(a.Nothing.value)};t.game=l})(PS),function(e){"use strict";e["Game.Valise.Model"]=e["Game.Valise.Model"]||{};var t=e["Game.Valise.Model"],n=e["Control.Bind"],a=e["Control.Category"],o=e["Data.Function"],r=e["Data.HeytingAlgebra"],i=e["Data.Lens.At"],l=e["Data.Lens.Lens"],s=e["Data.Lens.Setter"],u=e["Data.Map.Internal"],c=e["Data.Maybe"],d=e["Data.Ord"],v=e["Data.Profunctor.Strong"],p=e["Pha.Action"],m=e["Pha.Effects.Delay"],h=e.Run,w=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),g=(()=>{function e(){}return e.value=new e,e})(),f=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),b=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),y={isOpen:!1,help:"",helpVisible:!1,drag:c.Nothing.value,positions:u.empty,isSwitchOn:!1},D=p.setState(e=>y),S=n.discard(n.discardUnit)(h.bindRun)(m.delay(1500))(()=>p.setState(e=>({isOpen:!0,drag:e.drag,help:e.help,helpVisible:e.helpVisible,isSwitchOn:e.isSwitchOn,positions:e.positions}))),F=e=>l.lens(e=>e.positions)(e=>t=>({positions:t,drag:e.drag,help:e.help,helpVisible:e.helpVisible,isOpen:e.isOpen,isSwitchOn:e.isSwitchOn}))(e);t.istate=y,t._positions=F,t.enterA=S,t.leaveA=D,t.ShowHelp=w,t.ToggleSwitch=g,t.SetDrag=f,t.MoveObject=b,t.update=e=>{if(e instanceof w)return p.setState((t=s.set((e=>l.lens(e=>e.helpVisible)(e=>t=>({helpVisible:t,drag:e.drag,help:e.help,isOpen:e.isOpen,isSwitchOn:e.isSwitchOn,positions:e.positions}))(e))(v.strongFn))(""!==e.value0),n=s.over((e=>l.lens(e=>e.help)(e=>t=>({help:t,drag:e.drag,helpVisible:e.helpVisible,isOpen:e.isOpen,isSwitchOn:e.isSwitchOn,positions:e.positions}))(e))(v.strongFn))(""===e.value0?a.identity(a.categoryFn):o.const(e.value0)),e=>t(n(e))));var t,n;if(e instanceof g)return p.setState(s.over((e=>l.lens(e=>e.isSwitchOn)(e=>t=>({isSwitchOn:t,drag:e.drag,help:e.help,helpVisible:e.helpVisible,isOpen:e.isOpen,positions:e.positions}))(e))(v.strongFn))(r.not(r.heytingAlgebraBoolean)));if(e instanceof f)return p.setState(t=>({drag:e.value0,help:t.help,helpVisible:t.helpVisible,isOpen:t.isOpen,isSwitchOn:t.isSwitchOn,positions:t.positions}));if(e instanceof b)return p.setState(t=>{return t.drag instanceof c.Just?s.set((n=F(v.strongFn),a=i.at(i.atMap(d.ordString))(t.drag.value0.name)(v.strongFn),e=>n(a(e))))(new c.Just({x:e.value0.x-t.drag.value0.x,y:e.value0.y-t.drag.value0.y}))(t):t;var n,a});throw new Error("Failed pattern match at Game.Valise.Model (line 56, column 1 - line 56, column 35): "+[e.constructor.name])}}(PS),(e=>{"use strict";e["Game.Valise.View"]=e["Game.Valise.View"]||{};var t=e["Game.Valise.View"],n=e["Control.Monad.Except.Trans"],a=e["Data.Functor"],o=e["Data.Identity"],r=e["Data.Int"],i=e["Data.Lens.At"],l=e["Data.Lens.Getter"],s=e["Data.Lens.Internal.Forget"],u=e["Data.Maybe"],c=e["Data.Ord"],d=e["Data.Semigroup"],v=e["Data.Show"],p=e["Data.Tuple"],m=e["Game.Common"],h=e["Game.Valise.Model"],w=e.Pha,g=e["Pha.Attributes"],f=e["Pha.Elements"],b=e["Pha.Events"],y=e["Pha.Svg"],D=e["Pha.Util"],S=e=>{var t,S=t=>n=>a=>o=>m=>S=>F=>{var P,C=D.translate(D.pc(r.toNumber(n)/850))(D.pc(r.toNumber(a)/690));return y.g([w.style("transform")((P=new p.Tuple(t.drag,l.viewOn(l.viewOn(e)(h._positions(s.strongForget)))(i.at(i.atMap(c.ordString))(t.symbol)(s.strongForget))),P.value0&&P.value1 instanceof u.Just?D.translate(D.pc(P.value1.value0.x))(D.pc(P.value1.value0.y)):C))])([y.g(S)([y.svg(d.append(d.semigroupArray)([w.class_("valise-object"),w.style("touch-action")("none"),w["class'"]("draggable")(t.drag),y.width(v.show(v.showInt)(o)),y.height(v.show(v.showInt)(m)),b["onpointerdown'"]((()=>t.drag?u.Just.create(new h.SetDrag(new u.Just({name:t.symbol,x:r.toNumber(o)/1650,y:r.toNumber(m)/1380}))):u.Nothing.value)())])(u.isJust(t.link)?[]:[b.onpointerenter(new h.ShowHelp(t.help)),b.onpointerleave(new h.ShowHelp(""))]))([w.h("use")([g.href("#"+t.symbol),w.class_("valise-symbol")])([]),w.maybe(t.link)(e=>f.a([g.href("#"+e)])([y.rect(d.append(d.semigroupArray)([y.width("100%"),y.height("100%"),w.class_("valise-object-link"),y.fill("transparent"),b.onpointerenter(new h.ShowHelp(t.help)),b.onpointerleave(new h.ShowHelp(""))])(F))]))])])])};return y.svg([y.viewBox(0)(0)(825)(690),b.on("pointermove")((t=a.map(n.functorExceptT(o.functorIdentity))(h.MoveObject.create),e=>t(m.pointerDecoder(e)))),b.onpointerup(new h.SetDrag(u.Nothing.value))])([w.h("use")([g.href("#valise"),w.class_("valise-close"),y.width("100%"),y.height("100%")])([]),y.g([w.class_("valise-open")])([w.h("use")([g.href("#openvalise")])([]),S({symbol:"switch",link:u.Nothing.value,help:"",drag:!1})(300)(460)(42)(60)([b.onclick(h.ToggleSwitch.value),w.style("transform")((()=>e.isSwitchOn?"scale(1,-1) translateY(-8%)":"scale(1,1)")())])([]),S({symbol:"bulboff",link:u.Nothing.value,help:"Trouve un moyen d'allumer l'ampoule",drag:!1})(477)(280)(48)(48)([])([w.style("pointer-events")("all")]),S({symbol:"bulbon",link:new u.Just("noirblanc"),help:"Jeu: tour noir, tout blanc",drag:!1})(477)(280)(48)(48)([w.attr("transition")("opacity 0.5s"),w.attr("opacity")((()=>e.isSwitchOn?"1":"0")()),w.style("pointer-events")((()=>e.isSwitchOn?"all":"none")())])([]),S({symbol:"frog2",link:new u.Just("frog"),help:"Jeu: la grenouille",drag:!1})(549)(320)(40)(40)([y.fill("#bcd35f")])([y.x_("10%"),y.y_("20%"),y.width("80%"),y.height("80%")]),S({symbol:"flowerpot",link:u.Nothing.value,help:"Quelque chose se cache derrière ce pot",drag:!0})(533)(300)(64)(64)([])([]),S({symbol:"hanoibot",link:new u.Just("solitaire"),help:"Jeu: solitaire",drag:!1})(500)(430)(75)(51)([])([y.x_("30%"),y.y_("20%"),y.width("40%"),y.height("40%")]),S({symbol:"hanoitop",link:u.Nothing.value,help:"Quelque chose se cache sous cette tour",drag:!0})(507)(409)(60)(57)([])([]),S({symbol:"knight",link:new u.Just("queens"),help:"Jeu: les 8 reines",drag:!1})(461)(380)(24)(48)([y.transform("rotate(40)")])([]),S({symbol:"pen",link:new u.Just("dessin"),help:"Jeu: dessin",drag:!1})(610)(400)(60)(60)([])([]),S({symbol:"stack",link:new u.Just("jetons"),help:"Jeu: jetons",drag:!1})(350)(500)(50)(50)([])([]),S({symbol:"wheel",link:new u.Just("roue"),help:"Jeu: roue des couleurs",drag:!1})(400)(205)(50)(50)([y.transform("scale(1,0.8)")])([]),S({symbol:"card",link:new u.Just("nim"),help:"Jeu: Poker Nim",drag:!1})(450)(130)(40)(50)([y.transform("rotate(30)")])([]),S({symbol:"tile",link:new u.Just("tiling"),help:"Jeu: carrelage",drag:!1})(280)(400)(120)(60)([])([]),S({symbol:"tricolor2",link:new u.Just("baseball"),help:"Jeu: baseball multicolore",drag:!1})(350)(330)(90)(60)([])([]),S({symbol:"traffic",link:new u.Just("tricolor"),help:"Jeu: feu tricolore",drag:!1})(250)(280)(64)(64)([])([]),S({symbol:"race",link:new u.Just("paths"),help:"Jeu: chemins",drag:!1})(450)(445)(64)(64)([y.transform("rotate(40)")])([]),S({symbol:"paw",link:new u.Just("labete"),help:"Jeu: la bête",drag:!1})(300)(180)(40)(40)([y.transform("rotate(30)"),w.attr("opacity")("0.5")])([]),S({symbol:"quiet",link:new u.Just("sansmot"),help:"Jeu: preuve sans mot",drag:!1})(180)(130)(50)(50)([])([]),S({symbol:"chocolate",link:new u.Just("chocolat"),help:"Jeu: chocolat",drag:!1})(200)(200)(60)(60)([y.transform("rotate(40)")])([])])])};t.view=e=>f.div([w.class_("ui-flex-center valise-main-container"),w["class'"]("open")(e.isOpen)])([f.div([])([f.div([w.class_("valise-logo")])([y.svg([y.width("100%"),y.height("100%")])([y.use("#logo")([])])]),f.div([w.class_("valise-container")])([S(e),f.div([w.class_("valise-help"),w["class'"]("visible")(e.helpVisible&&""!==e.help)])([w.text(e.help)])])])])})(PS),(e=>{"use strict";e["Game.Valise"]=e["Game.Valise"]||{};var t=e["Game.Valise"],n=e["Data.Function"],a=e["Data.Maybe"],o=e["Game.Valise.View"],r={init:a.Nothing.value,view:o.view,onKeydown:n.const(a.Nothing.value)};t.game=r})(PS),function(e){const t={},n=[].map,a=requestAnimationFrame||setTimeout,o=(e,t)=>Object.assign({},e,t),r=(e,t)=>e&&t?n=>e(t(n)):e||t,i=(e,t,n,a,r,i,l)=>{if("key"===t);else if("style"===t)for(var s in o(n,a))n=null==a||null==a[s]?"":a[s],"-"===s[0]?e[t].setProperty(s,n):e[t][s]=n;else"function"==typeof a?((e.actions||(e.actions={}))[t]=l?l(a):a)?n||e.addEventListener(t,r):e.removeEventListener(t,r):!i&&"list"!==t&&t in e?e[t]=a:null==a||!1===a||"class"===t&&!a?e.removeAttribute(t):e.setAttribute(t,a)},l=(e,t,n,a)=>{var o=3===e.type?document.createTextNode(e.name):(n=n||"svg"===e.name)?document.createElementNS("http://www.w3.org/2000/svg",e.name):document.createElement(e.name),s=e.props;a=r(a,e.mapf);for(let e in s)i(o,e,null,s[e],t,n,a);for(let r=0,i=e.children.length;r<i;r++)o.appendChild(l(e.children[r]=c(e.children[r]),t,n,a));return e.node=o},s=e=>null==e?null:e.key,u=(e,t,n,a,d,v,p)=>{if(n===a);else if(null!=n&&3===n.type&&3===a.type)n.name!==a.name&&(t.nodeValue=a.name);else if(null==n||n.name!==a.name)t=e.insertBefore(l(a=c(a),d,v,p),t),null!=n&&e.removeChild(n.node);else{var m,h,w,g,f=n.props,b=a.props,y=n.children,D=a.children;let e=0,C=0,I=y.length-1,M=D.length-1;for(var S in p=r(p,a.mapf),v=v||"svg"===a.name,o(f,b))("value"===S||"selected"===S||"checked"===S?t[S]:f[S])!==b[S]&&i(t,S,f[S],b[S],d,v,p);for(;C<=M&&e<=I&&null!=(w=s(y[e]))&&w===s(D[C]);)u(t,y[e].node,y[e],D[C]=c(D[C++],y[e++]),d,v,p);for(;C<=M&&e<=I&&null!=(w=s(y[I]))&&w===s(D[M]);)u(t,y[I].node,y[I],D[M]=c(D[M--],y[I--]),d,v,p);if(e>I)for(;C<=M;)t.insertBefore(l(D[C]=c(D[C++]),d,v,p),(h=y[e])&&h.node);else if(C>M)for(;e<=I;)t.removeChild(y[e++].node);else{S=e;for(var F={},P={};S<=I;S++)null!=(w=y[S].key)&&(F[w]=y[S]);for(;C<=M;)w=s(h=y[e]),g=s(D[C]=c(D[C],h)),P[w]||null!=g&&g===s(y[e+1])?(null==w&&t.removeChild(h.node),e++):null==g||1===n.type?(null==w&&(u(t,h&&h.node,h,D[C],d,v,p),C++),e++):(w===g?(u(t,h.node,h,D[C],d,v,p),P[g]=!0,e++):null!=(m=F[g])?(u(t,t.insertBefore(m.node,h&&h.node),m,D[C],d,v,p),P[g]=!0):u(t,h&&h.node,null,D[C],d,v,p),C++);for(;e<=I;)null==s(h=y[e++])&&t.removeChild(h.node);for(var S in F)null==P[S]&&t.removeChild(F[S].node)}}return a.node=t},c=(e,t)=>2===e.type?((!t||((e,t)=>{for(var n in e)if(e[n]!==t[n])return!0;for(var n in t)if(e[n]!==t[n])return!0})(t.lazy,e.lazy))&&((t=e.lazy.view(e.lazy)).lazy=e.lazy),t):e,d=e=>3===e.nodeType?createTextVNode(e.nodeValue,e):((e,t,n,a,o,r)=>({name:e,props:t,children:n,node:a,type:r,key:o}))(e.nodeName.toLowerCase(),t,n.call(e.childNodes,d),e,null,1),v=(e,t)=>{if(e!==t)for(var n in o(e,t)){if(e[n]!==t[n]&&!isSameAction(e[n],t[n]))return!0;t[n]=e[n]}};e.app=e=>()=>{let t={},n=!1,o=[];const r=function(e){m(e)(this.actions[e.type])()},i=e=>()=>(t!==e&&(o=((e,t,n)=>{for(var a,o,r=0,i=[];r<e.length||r<t.length;r++)a=e[r],o=t[r],i.push(o?!a||o.fn!==a.fn||v(o[0],a[1])?[o[0],o[1],o[0](n)(o[1])(),a&&a[2]()]:a:a&&a[2]());return i})(o,c(t=e),p),s&&!n&&a(b,n=!0)),t),{state:l,view:s,subscriptions:c,dispatch:p,dispatchEvent:m,init:h,node:w}=e(()=>t)(i);let g=document.getElementById(w);if(!g)return;let f=g&&d(g);const b=()=>{const{title:e,body:a}=s(t);document.title=e,n=!1,g=u(g.parentNode,g,f,f=a,r)};i(l)(),h()}}(PS["Pha.Internal"]=PS["Pha.Internal"]||{}),(e=>{"use strict";e["Pha.Internal"]=e["Pha.Internal"]||{};var t=e["Pha.Internal"],n=e["Pha.Internal"];t.app=n.app})(PS),(e=>{"use strict";e["Pha.App"]=e["Pha.App"]||{};var t=e["Pha.App"],n=e["Control.Applicative"],a=e["Data.Function"],o=e["Data.Functor.Variant"],r=e["Data.Maybe"],i=e["Data.Unit"],l=e.Effect,s=e["Pha.Internal"],u=e.Run,c=e=>e;t.app=c,t.attachTo=e=>t=>{return s.app(s=>c=>{var d,v=(d=o.onMatch()()()({getState:e=>()=>{var t=s();return e.value0(t)()},setState:e=>()=>{var t=s();return c(e.value0(t))(),e.value1()}})(t.interpreter),u.runCont(d)(a.const(n.pure(l.applicativeEffect)(i.unit)))),p=v(t.init.value1),m=e=>v(t.update(e));return{state:t.init.value0,view:t.view,node:e,init:p,subscriptions:t.subscriptions,dispatch:m,dispatchEvent:e=>t=>{var n=t(e);return function(){if(n.effect(),n.msg instanceof r.Nothing)return i.unit;if(n.msg instanceof r.Just)return m(n.msg.value0)();throw new Error("Failed pattern match at Pha.App (line 73, column 13 - line 75, column 36): "+[n.msg.constructor.name])}}}})}})(PS),(e=>{"use strict";e["Pha.Lens"]=e["Pha.Lens"]||{};var t=e["Pha.Lens"],n=e["Control.Monad.Free"],a=e["Data.Functor.Variant"],o=e["Data.Lens.Getter"],r=e["Data.Lens.Internal.Forget"],i=e["Data.Lens.Setter"],l=e["Data.Profunctor.Strong"],s=e["Data.Symbol"],u=e["Pha.Action"],c=e.Run,d=e["Unsafe.Coerce"];t.actionOver=e=>t=>c.Run(n.hoistFree((e=>a.onMatch()()()({getState:t=>{return a.inj()(new s.IsSymbol(()=>"getState"))(u.functorGetState)(s.SProxy.value)(new u.GetState((n=o.view(e(r.strongForget)),e=>t.value0(n(e)))));var n},setState:t=>a.inj()(new s.IsSymbol(()=>"setState"))(u.functorSetState)(s.SProxy.value)(new u.SetState(i.over(e(l.strongFn))(t.value0),t.value1))})(d.unsafeCoerce))(t=>e(t)))(t))})(PS),(e=>{e.makeSub=e=>t=>[e,t],e.addEventListener=e=>t=>()=>window&&window.addEventListener?(listener=window.addEventListener(e,e=>t(e)()),()=>target.removeEventListener(listener)):()=>null})(PS["Pha.Subs"]=PS["Pha.Subs"]||{}),(e=>{"use strict";e["Pha.Subs"]=e["Pha.Subs"]||{};var t=e["Pha.Subs"],n=e["Pha.Subs"],a=e["Control.Applicative"],o=e["Control.Monad.Except"],r=e["Control.Monad.Except.Trans"],i=e["Data.Either"],l=e["Data.Functor"],s=e["Data.Identity"],u=e["Data.Maybe"],c=e["Data.Unit"],d=e.Effect,v=e.Foreign,p=e["Pha.Events.Decoder"],m=e=>{return n.makeSub(t=>r=>n.addEventListener(e)((e=>t=>n=>{var r=o.runExcept(t(v.unsafeToForeign(n)));return r instanceof i.Right&&r.value0 instanceof u.Just?e(r.value0.value0):a.pure(d.applicativeEffect)(c.unit)})(t)(r)))};t.on=e=>t=>{return m(e)((n=l.map(r.functorExceptT(s.functorIdentity))(u.Just.create),e=>n(t(e))));var n},t.onKeyDown=e=>{return m("keydown")((t=l.map(r.functorExceptT(s.functorIdentity))(e),e=>t(p.key(e))));var t}})(PS),function(e){"use strict";e.Main=e.Main||{};var t=e.Main,n=e["Control.Applicative"],a=e["Control.Bind"],o=e["Data.Foldable"],r=e["Data.Function"],i=e["Data.Functor"],l=e["Data.Functor.Variant"],s=e["Data.Lens.Lens"],u=e["Data.List.Types"],c=e["Data.Map.Internal"],d=e["Data.Maybe"],v=e["Data.Ord"],p=e["Data.String.CodePoints"],m=e["Data.Tuple"],h=e["Data.Unit"],w=e["Game.Baseball"],g=e["Game.Baseball.Model"],f=e["Game.Chocolat"],b=e["Game.Chocolat.Model"],y=e["Game.Dessin"],D=e["Game.Dessin.Model"],S=e["Game.Effs"],F=e["Game.Frog"],P=e["Game.Frog.Model"],C=e["Game.Jetons"],I=e["Game.Jetons.Model"],M=e["Game.Labete"],x=e["Game.Labete.Model"],A=e["Game.Nim"],_=e["Game.Nim.Model"],G=e["Game.Noirblanc"],T=e["Game.Noirblanc.Model"],O=e["Game.Paths"],E=e["Game.Paths.Model"],N=e["Game.Queens"],R=e["Game.Queens.Model"],L=e["Game.Roue"],q=e["Game.Roue.Model"],k=e["Game.Sansmot"],U=e["Game.Sansmot.Model"],B=e["Game.Solitaire"],J=e["Game.Solitaire.Model"],W=e["Game.Tiling"],z=e["Game.Tiling.Model"],j=e["Game.Tricolor"],V=e["Game.Tricolor.Model"],H=e["Game.Valise"],Q=e["Game.Valise.Model"],K=e.Pha,Z=e["Pha.Action"],X=e["Pha.App"],Y=e["Pha.Attributes"],$=e["Pha.Effects.Delay"],ee=e["Pha.Effects.Random"],te=e["Pha.Elements"],ne=e["Pha.Events.Decoder"],ae=e["Pha.Lens"],oe=e["Pha.Subs"],re=e["Pha.Svg"],ie=e.Run,le=e["Unsafe.Coerce"],se=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),ue=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),ce=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),de=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),ve=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),pe=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),me=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),he=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),we=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),ge=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),fe=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),be=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),ye=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),De=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),Se=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),Fe=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),Pe=function(){function e(e){this.value0=e}return e.create=t=>new e(t),e}(),Ce=(()=>{function e(){}return e.value=new e,e})(),Ie={baseball:g.istate,chocolat:b.istate,dessin:D.istate,frog:P.istate,jetons:I.istate,labete:x.istate,nim:_.istate,noirblanc:T.istate,paths:E.istate,queens:R.istate,roue:q.istate,sansmot:U.istate,solitaire:J.istate,tiling:z.istate,tricolor:V.istate,valise:Q.istate,location:"",anim:!0},Me=e=>t=>n=>({core:e,map:t,msgmap:n}),xe=c.fromFoldable(v.ordString)(o.foldableArray)([new m.Tuple("baseball",Me(w.game)(e=>e.baseball)(se.create)),new m.Tuple("chocolat",Me(f.game)(e=>e.chocolat)(ue.create)),new m.Tuple("dessin",Me(y.game)(e=>e.dessin)(ce.create)),new m.Tuple("frog",Me(F.game)(e=>e.frog)(de.create)),new m.Tuple("jetons",Me(C.game)(e=>e.jetons)(ve.create)),new m.Tuple("labete",Me(M.game)(e=>e.labete)(pe.create)),new m.Tuple("nim",Me(A.game)(e=>e.nim)(me.create)),new m.Tuple("noirblanc",Me(G.game)(e=>e.noirblanc)(he.create)),new m.Tuple("paths",Me(O.game)(e=>e.paths)(we.create)),new m.Tuple("queens",Me(N.game)(e=>e.queens)(ge.create)),new m.Tuple("roue",Me(L.game)(e=>e.roue)(fe.create)),new m.Tuple("sansmot",Me(k.game)(e=>e.sansmot)(be.create)),new m.Tuple("solitaire",Me(B.game)(e=>e.solitaire)(ye.create)),new m.Tuple("tiling",Me(W.game)(e=>e.tiling)(Se.create)),new m.Tuple("tricolor",Me(j.game)(e=>e.tricolor)(Fe.create)),new m.Tuple("valise",Me(H.game)(e=>e.valise)(De.create))]),Ae=le.unsafeCoerce,_e=e=>t=>d.maybe(t)(t=>p.drop(t+1|0)(e))(p.indexOf("#")(e)),Ge=a.bind(ie.bindRun)(S.getLocation)(e=>{var t=_e(e.hash)("valise");return"valise"===t||""===t?a.discard(a.discardUnit)(ie.bindRun)(Z.setState(e=>({location:t,anim:!0,valise:e.valise,baseball:e.baseball,chocolat:e.chocolat,dessin:e.dessin,frog:e.frog,jetons:e.jetons,labete:e.labete,nim:e.nim,noirblanc:e.noirblanc,paths:e.paths,queens:e.queens,roue:e.roue,sansmot:e.sansmot,solitaire:e.solitaire,tiling:e.tiling,tricolor:e.tricolor})))(()=>a.discard(a.discardUnit)(ie.bindRun)($.delay(100))(()=>a.discard(a.discardUnit)(ie.bindRun)(Z.setState(e=>({anim:!1,valise:e.valise,location:e.location,baseball:e.baseball,chocolat:e.chocolat,dessin:e.dessin,frog:e.frog,jetons:e.jetons,labete:e.labete,nim:e.nim,noirblanc:e.noirblanc,paths:e.paths,queens:e.queens,roue:e.roue,sansmot:e.sansmot,solitaire:e.solitaire,tiling:e.tiling,tricolor:e.tricolor})))(()=>ae.actionOver(e=>s.lens(e=>e.valise)(e=>t=>({valise:t,anim:e.anim,location:e.location,baseball:e.baseball,chocolat:e.chocolat,dessin:e.dessin,frog:e.frog,jetons:e.jetons,labete:e.labete,nim:e.nim,noirblanc:e.noirblanc,paths:e.paths,queens:e.queens,roue:e.roue,sansmot:e.sansmot,solitaire:e.solitaire,tiling:e.tiling,tricolor:e.tricolor}))(e))(Q.enterA)))):a.discard(a.discardUnit)(ie.bindRun)(ae.actionOver(e=>s.lens(e=>e.valise)(e=>t=>({valise:t,anim:e.anim,location:e.location,baseball:e.baseball,chocolat:e.chocolat,dessin:e.dessin,frog:e.frog,jetons:e.jetons,labete:e.labete,nim:e.nim,noirblanc:e.noirblanc,paths:e.paths,queens:e.queens,roue:e.roue,sansmot:e.sansmot,solitaire:e.solitaire,tiling:e.tiling,tricolor:e.tricolor}))(e))(Q.leaveA))(()=>a.discard(a.discardUnit)(ie.bindRun)(Z.setState(e=>({location:t,anim:!0,valise:e.valise,baseball:e.baseball,chocolat:e.chocolat,dessin:e.dessin,frog:e.frog,jetons:e.jetons,labete:e.labete,nim:e.nim,noirblanc:e.noirblanc,paths:e.paths,queens:e.queens,roue:e.roue,sansmot:e.sansmot,solitaire:e.solitaire,tiling:e.tiling,tricolor:e.tricolor})))(()=>a.discard(a.discardUnit)(ie.bindRun)($.delay(100))(()=>Z.setState(e=>({anim:!1,location:e.location,valise:e.valise,baseball:e.baseball,chocolat:e.chocolat,dessin:e.dessin,frog:e.frog,jetons:e.jetons,labete:e.labete,nim:e.nim,noirblanc:e.noirblanc,paths:e.paths,queens:e.queens,roue:e.roue,sansmot:e.sansmot,solitaire:e.solitaire,tiling:e.tiling,tricolor:e.tricolor})))))}),Te=e=>t=>n=>{var a=c.lookup(v.ordString)(e)(xe);if(a instanceof d.Nothing)return t;if(a instanceof d.Just)return Ae(n)(a.value0);throw new Error("Failed pattern match at Main (line 121, column 29 - line 123, column 62): "+[a.constructor.name])},Oe=e=>{if(e instanceof se)return ae.actionOver(e=>s.lens(e=>e.baseball)(e=>t=>({baseball:t,anim:e.anim,chocolat:e.chocolat,dessin:e.dessin,frog:e.frog,jetons:e.jetons,labete:e.labete,location:e.location,nim:e.nim,noirblanc:e.noirblanc,paths:e.paths,queens:e.queens,roue:e.roue,sansmot:e.sansmot,solitaire:e.solitaire,tiling:e.tiling,tricolor:e.tricolor,valise:e.valise}))(e))(g.update(e.value0));if(e instanceof ue)return ae.actionOver(e=>s.lens(e=>e.chocolat)(e=>t=>({chocolat:t,anim:e.anim,baseball:e.baseball,dessin:e.dessin,frog:e.frog,jetons:e.jetons,labete:e.labete,location:e.location,nim:e.nim,noirblanc:e.noirblanc,paths:e.paths,queens:e.queens,roue:e.roue,sansmot:e.sansmot,solitaire:e.solitaire,tiling:e.tiling,tricolor:e.tricolor,valise:e.valise}))(e))(b.update(e.value0));if(e instanceof ce)return ae.actionOver(e=>s.lens(e=>e.dessin)(e=>t=>({dessin:t,anim:e.anim,baseball:e.baseball,chocolat:e.chocolat,frog:e.frog,jetons:e.jetons,labete:e.labete,location:e.location,nim:e.nim,noirblanc:e.noirblanc,paths:e.paths,queens:e.queens,roue:e.roue,sansmot:e.sansmot,solitaire:e.solitaire,tiling:e.tiling,tricolor:e.tricolor,valise:e.valise}))(e))(D.update(e.value0));if(e instanceof de)return ae.actionOver(e=>s.lens(e=>e.frog)(e=>t=>({frog:t,anim:e.anim,baseball:e.baseball,chocolat:e.chocolat,dessin:e.dessin,jetons:e.jetons,labete:e.labete,location:e.location,nim:e.nim,noirblanc:e.noirblanc,paths:e.paths,queens:e.queens,roue:e.roue,sansmot:e.sansmot,solitaire:e.solitaire,tiling:e.tiling,tricolor:e.tricolor,valise:e.valise}))(e))(P.update(e.value0));if(e instanceof ve)return ae.actionOver(e=>s.lens(e=>e.jetons)(e=>t=>({jetons:t,anim:e.anim,baseball:e.baseball,chocolat:e.chocolat,dessin:e.dessin,frog:e.frog,labete:e.labete,location:e.location,nim:e.nim,noirblanc:e.noirblanc,paths:e.paths,queens:e.queens,roue:e.roue,sansmot:e.sansmot,solitaire:e.solitaire,tiling:e.tiling,tricolor:e.tricolor,valise:e.valise}))(e))(I.update(e.value0));if(e instanceof pe)return ae.actionOver(e=>s.lens(e=>e.labete)(e=>t=>({labete:t,anim:e.anim,baseball:e.baseball,chocolat:e.chocolat,dessin:e.dessin,frog:e.frog,jetons:e.jetons,location:e.location,nim:e.nim,noirblanc:e.noirblanc,paths:e.paths,queens:e.queens,roue:e.roue,sansmot:e.sansmot,solitaire:e.solitaire,tiling:e.tiling,tricolor:e.tricolor,valise:e.valise}))(e))(x.update(e.value0));if(e instanceof me)return ae.actionOver(e=>s.lens(e=>e.nim)(e=>t=>({nim:t,anim:e.anim,baseball:e.baseball,chocolat:e.chocolat,dessin:e.dessin,frog:e.frog,jetons:e.jetons,labete:e.labete,location:e.location,noirblanc:e.noirblanc,paths:e.paths,queens:e.queens,roue:e.roue,sansmot:e.sansmot,solitaire:e.solitaire,tiling:e.tiling,tricolor:e.tricolor,valise:e.valise}))(e))(_.update(e.value0));if(e instanceof he)return ae.actionOver(e=>s.lens(e=>e.noirblanc)(e=>t=>({noirblanc:t,anim:e.anim,baseball:e.baseball,chocolat:e.chocolat,dessin:e.dessin,frog:e.frog,jetons:e.jetons,labete:e.labete,location:e.location,nim:e.nim,paths:e.paths,queens:e.queens,roue:e.roue,sansmot:e.sansmot,solitaire:e.solitaire,tiling:e.tiling,tricolor:e.tricolor,valise:e.valise}))(e))(T.update(e.value0));if(e instanceof we)return ae.actionOver(e=>s.lens(e=>e.paths)(e=>t=>({paths:t,anim:e.anim,baseball:e.baseball,chocolat:e.chocolat,dessin:e.dessin,frog:e.frog,jetons:e.jetons,labete:e.labete,location:e.location,nim:e.nim,noirblanc:e.noirblanc,queens:e.queens,roue:e.roue,sansmot:e.sansmot,solitaire:e.solitaire,tiling:e.tiling,tricolor:e.tricolor,valise:e.valise}))(e))(E.update(e.value0));if(e instanceof ge)return ae.actionOver(e=>s.lens(e=>e.queens)(e=>t=>({queens:t,anim:e.anim,baseball:e.baseball,chocolat:e.chocolat,dessin:e.dessin,frog:e.frog,jetons:e.jetons,labete:e.labete,location:e.location,nim:e.nim,noirblanc:e.noirblanc,paths:e.paths,roue:e.roue,sansmot:e.sansmot,solitaire:e.solitaire,tiling:e.tiling,tricolor:e.tricolor,valise:e.valise}))(e))(R.update(e.value0));if(e instanceof fe)return ae.actionOver(e=>s.lens(e=>e.roue)(e=>t=>({roue:t,anim:e.anim,baseball:e.baseball,chocolat:e.chocolat,dessin:e.dessin,frog:e.frog,jetons:e.jetons,labete:e.labete,location:e.location,nim:e.nim,noirblanc:e.noirblanc,paths:e.paths,queens:e.queens,sansmot:e.sansmot,solitaire:e.solitaire,tiling:e.tiling,tricolor:e.tricolor,valise:e.valise}))(e))(q.update(e.value0));if(e instanceof be)return ae.actionOver(e=>s.lens(e=>e.sansmot)(e=>t=>({sansmot:t,anim:e.anim,baseball:e.baseball,chocolat:e.chocolat,dessin:e.dessin,frog:e.frog,jetons:e.jetons,labete:e.labete,location:e.location,nim:e.nim,noirblanc:e.noirblanc,paths:e.paths,queens:e.queens,roue:e.roue,solitaire:e.solitaire,tiling:e.tiling,tricolor:e.tricolor,valise:e.valise}))(e))(U.update(e.value0));if(e instanceof ye)return ae.actionOver(e=>s.lens(e=>e.solitaire)(e=>t=>({solitaire:t,anim:e.anim,baseball:e.baseball,chocolat:e.chocolat,dessin:e.dessin,frog:e.frog,jetons:e.jetons,labete:e.labete,location:e.location,nim:e.nim,noirblanc:e.noirblanc,paths:e.paths,queens:e.queens,roue:e.roue,sansmot:e.sansmot,tiling:e.tiling,tricolor:e.tricolor,valise:e.valise}))(e))(J.update(e.value0));if(e instanceof Se)return ae.actionOver(e=>s.lens(e=>e.tiling)(e=>t=>({tiling:t,anim:e.anim,baseball:e.baseball,chocolat:e.chocolat,dessin:e.dessin,frog:e.frog,jetons:e.jetons,labete:e.labete,location:e.location,nim:e.nim,noirblanc:e.noirblanc,paths:e.paths,queens:e.queens,roue:e.roue,sansmot:e.sansmot,solitaire:e.solitaire,tricolor:e.tricolor,valise:e.valise}))(e))(z.update(e.value0));if(e instanceof Fe)return ae.actionOver(e=>s.lens(e=>e.tricolor)(e=>t=>({tricolor:t,anim:e.anim,baseball:e.baseball,chocolat:e.chocolat,dessin:e.dessin,frog:e.frog,jetons:e.jetons,labete:e.labete,location:e.location,nim:e.nim,noirblanc:e.noirblanc,paths:e.paths,queens:e.queens,roue:e.roue,sansmot:e.sansmot,solitaire:e.solitaire,tiling:e.tiling,valise:e.valise}))(e))(V.update(e.value0));if(e instanceof De)return ae.actionOver(e=>s.lens(e=>e.valise)(e=>t=>({valise:t,anim:e.anim,baseball:e.baseball,chocolat:e.chocolat,dessin:e.dessin,frog:e.frog,jetons:e.jetons,labete:e.labete,location:e.location,nim:e.nim,noirblanc:e.noirblanc,paths:e.paths,queens:e.queens,roue:e.roue,sansmot:e.sansmot,solitaire:e.solitaire,tiling:e.tiling,tricolor:e.tricolor}))(e))(Q.update(e.value0));if(e instanceof Pe)return a.bind(ie.bindRun)(Z.getState)(t=>Te(t.location)(n.pure(ie.applicativeRun)(h.unit))(t=>d.maybe(n.pure(ie.applicativeRun)(h.unit))(e=>Oe(t.msgmap(e)))(t.core.onKeydown(e.value0))));if(e instanceof Ce)return Ge;throw new Error("Failed pattern match at Main (line 141, column 1 - line 141, column 39): "+[e.constructor.name])},Ee=a.discard(a.discardUnit)(ie.bindRun)(o.for_(ie.applicativeRun)(u.foldableList)(c.values(xe))(Ae(e=>d.maybe(n.pure(ie.applicativeRun)(h.unit))(t=>Oe(e.msgmap(t)))(e.core.init))))(()=>Ge),Ne=e=>Te(e.location)(K.emptyNode)(t=>i.mapFlipped(K.functorVDom)(t.core.view(t.map(e)))(t.msgmap)),Re=e=>({title:"Valise MaM",body:te.div([K.key(e.location),K.class_("main-main-container"),K["class'"]("valise")("valise"===e.location),K["class'"]("appear")(e.anim)])([K.when("valise"!==e.location)(e=>te.a([K.class_("main-minivalise-link"),Y.href("#valise")])([re.svg([re.width("100%"),re.height("100%")])([re.use("#valise")([])])])),Ne(e)])}),Le=X.attachTo("root")(X.app({init:new m.Tuple(Ie,Ee),view:Re,update:Oe,subscriptions:r.const([oe.onKeyDown(e=>d.Just.create(Pe.create(e))),oe.on("hashchange")(ne.always(Ce.value))]),interpreter:l.match()()()({delay:$.interpretDelay,rng:ee.interpretRng,location:S.interpretLocation})}));t.extractLocation=_e,t.BaseballMsg=se,t.ChocolatMsg=ue,t.DessinMsg=ce,t.FrogMsg=de,t.JetonsMsg=ve,t.LabeteMsg=pe,t.NimMsg=me,t.NoirblancMsg=he,t.PathsMsg=we,t.QueensMsg=ge,t.RoueMsg=fe,t.SansmotMsg=be,t.SolitaireMsg=ye,t.ValiseMsg=De,t.TilingMsg=Se,t.TricolorMsg=Fe,t.OnKeyDown=Pe,t.OnHashChange=Ce,t.gameWrap=Me,t.gameRun=Ae,t.games=xe,t.callByName=Te,t.hashChange=Ge,t.update=Oe,t.init=Ee,t.view=Re,t.viewGame=Ne,t.state=Ie,t.main=Le}(PS),PS.Main.main();